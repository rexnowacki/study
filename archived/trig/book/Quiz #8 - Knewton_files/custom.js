(window.LearnosityAmd=window.LearnosityAmd||[]).push([[29],{116:function(e,t,i){"use strict";i.r(t);var n=i(0),o=i.n(n),s=i(52).a.extend({ScorerClass:null,scorer:null,stubScorer:{isValid:function isValid(){},score:function score(){},maxScore:function maxScore(){}},processResponseValue:function processResponseValue(e){this.hasResponse()||this.set({response:{value:{},type:this.RESPONSE_TYPE.OBJECT}},{silent:!0}),this.get("response").value=e},setScorerClass:function setScorerClass(e){o.a.isFunction(e)&&o.a.isFunction(e.prototype.isValid)&&o.a.isFunction(e.prototype.score)&&o.a.isFunction(e.prototype.maxScore)&&(this.ScorerClass=e)},getScorer:function getScorer(){return this.ScorerClass?(this.scorer&&this._prevModifiedForScorer===this.lastModified||(this._prevModifiedForScorer=this.lastModified,this.scorer=new this.ScorerClass(this.get("question"),this.get("response")&&this.get("response").value)),this.scorer):this.stubScorer},canValidateResponse:function canValidateResponse(){if(this.ScorerClass){var e=this.getScorer();return o.a.isFunction(e.canValidate)?e.canValidate():!o.a.isFunction(e.canValidateResponse)||e.canValidateResponse()}return!1},validateResponse:function validateResponse(){return this.getScorer().isValid()}}),r=i(53),a=i(13),c=i(525),u=i.n(c),d=i(360),l=i(2),p=a.a.getExposedExternalBundle("reactiveViewComponents"),g=r.a.extend({template:u.a,initialize:function initialize(){r.a.prototype.initialize.call(this),this.activity=this.model.activity,this.displayLogic={},this.render(),this.loadMandatoryResources()},render:function render(){this.renderViewContent(this.template({spinner:this.model.activity.get("i18n").labels.loadingInfo}))},WIDGET_TYPE:"Question",getModelData:function getModelData(){return this.model.get("question")},getCustomWidgetOptions:function getCustomWidgetOptions(){var e=this.model,t=e.get("response");return{question:e.get("question"),response:t?t.value:void 0}},getCustomWidgetUtil:function getCustomWidgetUtil(){if(o.a.isUndefined(this._customWidgetUtil)){var e=this.model;this._customWidgetUtil={renderComponent:function renderComponent(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return new l.default((function(t){p().then((function(n){var o=n.default?n.default:n;t(o.render.apply(o,[e].concat(i)))}))}))}}}return this._customWidgetUtil},beforeInitializingCustomWidget:function beforeInitializingCustomWidget(e,t){var i=e.events,n=this.model,o=t.Scorer;o&&n.setScorerClass(o),this.addRenderingLogic(),this.setupEvents(i)},setupEvents:function setupEvents(e){var t=this.model,i=this.displayLogic,n=this.getFacade();e.on("changed",t.updateResponseValue,t),n.on("validated",(function(){e.trigger("validate",{showCorrectAnswers:i.displayCorrectAnswer})}))},initialisationCompleted:function initialisationCompleted(){var e=this.displayLogic;if(r.a.prototype.initialisationCompleted.apply(this,arguments),e.isReviewState){var t=this.getFacade();t.validate({showCorrectAnswers:e.displayCorrectAnswer}),t.disable()}},showCorrectAnswer:function showCorrectAnswer(){},processAccessibility:function processAccessibility(){}});o.a.extend(g.prototype,d.a);var h=g;t.default={Model:s,View:h}},360:function(e,t,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(5),c=i.n(a),u=i(13),d=i(4),l=i(314),p=i(2),g=function prepareAsyncBundle(e){return function(){return new p.default((function(t){e().then((function(e){e.default?t(e.default):t(e)}))}))}}(u.a.getExposedExternalBundle("mathcore"));Object(l.b)("require",l.c),Object(l.b)("require-v2.1.9",l.c),Object(l.b)("jquery",o.a),Object(l.b)("jquery-v1.10.2",o.a),Object(l.b)("underscore",r.a),Object(l.b)("underscore-v1.5.2",r.a),Object(l.b)("backbone",c.a),Object(l.b)("backbone-v0.9.10",c.a),Object(l.a)("mathcore",g),Object(l.a)("vendor/mathcore",g);var h=window.LearnosityAmd;h.require=h.require||l.c,h.define=h.define||l.d,t.a={MAX_INIT_TIME:1e4,loadMandatoryResources:function loadMandatoryResources(){var e=this,t=this.getModelData(),i=t.js,n=t.css,o=this.WIDGET_TYPE,s=function prepareScriptsToLoad(e,t){var i=function getWidgetConfig(e,t){return{widgetType:e,url:t}};return r.a.isString(e)?[i("Feature"===t?"Feature":"Question",e)]:r.a.isObject(e)&&r.a.has(e,"question")?r.a.has(e,"scorer")?[i("Question",e.question),i("Scorer",e.scorer)]:[i("Question",e.question)]:void 0}(i,o);if(!s){var a="Question"===o?"response_id":"feature_id";return d.a.exception({code:10024,detail:"No js defined for custom ".concat(o," ").concat(t[a])}),this.initialisationCompleted(),p.default.reject(!1)}return r.a.isString(n)&&LearnosityApp._internal.loadCss(n,!0),p.default.all(s.map((function(t){return e._loadJsResource(t)}))).then((function(t){return e._initializeCustomWidget(e._getWidgetBundle(t,o),o)})).then((function(t){e.customWidgetInstance=t,e.initialisationCompleted()})).catch((function(t){e.initialisationCompleted.bind(e),d.a.exception({code:10024,detail:t})}))},_loadJsResource:function _loadJsResource(e){var t=e.widgetType,i=e.url,n=new o.a.Deferred,s=this.model.activity.get("apiVersion");return i+=-1===i.indexOf("?")?"?":"&",i+="questionsApiVersion=".concat(s),Object(l.c)([i],(function(e){r.a.isFunction(e)&&(e[t]=e),e&&r.a.isFunction(e[t])?n.resolve(e):n.reject("Custom ".concat(t," module must return a ").concat(t," function: ").concat(i))}),(function(){n.reject("Failed loading custom ".concat(t," from ").concat(i))})),n.promise()},_getWidgetBundle:function _getWidgetBundle(e,t){var i={};return r.a.each(e,(function(e){r.a.has(e,t)&&(i[t]=e[t]),r.a.has(e,"Scorer")&&(i.Scorer=e.Scorer)})),i},_initializeCustomWidget:function _initializeCustomWidget(e,t){var i,n=this.model.activity,s=n.get("i18n"),a=new o.a.Deferred,u=r.a.extend({},c.a.Events),d=r.a.extend({state:n.get("state"),$el:this.$el,events:u,getFacade:this.getFacade.bind(this),getI18nLabel:function getI18nLabel(e){return s.labels[e]},getCustomWidgetOptions:function getCustomWidgetOptions(e){return r.a.getNested(n.attributes,"custom_widget_options.".concat(e))},questionsApiVersion:n.get("apiVersion")},this.getCustomWidgetOptions());setTimeout((function(){a.reject("Custom ".concat(t," did not trigger ready event"))}),this.MAX_INIT_TIME),u.once("ready",(function(){return a.resolve(i)})),r.a.isFunction(this.beforeInitializingCustomWidget)&&this.beforeInitializingCustomWidget(d,e);try{var l=this.getCustomWidgetUtil&&this.getCustomWidgetUtil();i=new e[t](d,l),this.getFacade().on("reset",(function(){return u.trigger("reset")}))}catch(e){console.error(e),a.reject("Caught exception in custom ".concat(t,": ").concat(e))}return r.a.isFunction(this.afterInitializingCustomWidget)&&this.afterInitializingCustomWidget(d,e),a.promise()}}},525:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_custom_response">'+(null==(__t=spinner)?"":__t)+"</div>";return __p}}}]);