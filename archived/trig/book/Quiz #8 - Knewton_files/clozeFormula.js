(window.LearnosityAmd=window.LearnosityAmd||[]).push([[27,74],{131:function(t,e,i){"use strict";i.d(e,"a",(function(){return u})),i.d(e,"c",(function(){return hasBlockElement}));var n=i(1),r=i.n(n),a=i(0),s=i.n(a),o=i(7),l=i.n(o),c=i(2),u=["h1","h2","h3","h4","h5","h6","p","pre","div","blockquote","section","article","table"],h=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,p=new function(){var t=/Mac|iPad|iPhone|iPod/.test(navigator.platform),e=s.a.uniqueId("lrn_capslock_listener_"),i=this,n=[];function setStatus(t){i.status!==t&&(s.a.each(n,(function(e){e(t)})),i.status=t)}this.status=!1,this.observe=function(a,o){return o&&(a=s.a.bind(a,o)),n.push(a),1===n.length&&function startListening(){var n=!1;r()(window).on("focus."+e,(function(){r()(window).one("keypress."+e,i.correctStatus)})),t?(r()(window).on("keydown."+e,(function(t){20===(t||window.event).keyCode&&setStatus(!i.status)})),r()(window).on("keyup."+e,(function(t){20===(t||window.event).keyCode&&setStatus(!1)}))):(r()(window).on("keydown."+e,(function(t){var e=t||window.event;n||20!==e.keyCode||(setStatus(!i.status),n=!0)})),r()(window).on("keyup."+e,(function(t){var e=t||window.event;n&&20===e.keyCode&&(n=!1)})))}(),a},this.unobserve=function(t){(n=s.a.without(n,t)).length||function stopListening(){r()(window).off("."+e)}()},this.correctStatus=function(e){var i=e||window.event,n=i.charCode||i.keyCode,r=i.shiftKey;n<123&&n>96?setStatus(r):!(n<91&&n>64)||t&&r||setStatus(!r)}},d=new function(){var t=s.a.uniqueId("lrn_fullscreen_listener_"),e=this,i=[],n={generic:{change:"fullscreenchange",element:"fullscreenElement"},webkit:{change:"webkitfullscreenchange",element:"webkitFullscreenElement"},ms:{change:"MSFullscreenChange",element:"msFullscreenElement"},moz:{change:"mozfullscreenchange",element:"mozFullScreenElement"}},a="ie"===l.a.browser&&11===l.a.version,o=s.a.find(n,(function(t){if("on".concat(t.change)in document.documentElement)return t}));!o&&a&&(o=n.ms);var c=!1;function setElement(){var t=document[o.element];e.element!==t&&(s.a.each(i,(function(e){e(t)})),e.element=t)}function updateElementAfterNextRender(){c||(c=!0,requestAnimationFrame((function(){requestAnimationFrame((function(){c=!1,setElement()}))})))}this.element=null,this.observe=function(e,n){return n&&(e=s.a.bind(e,n)),o&&(i.push(e),1===i.length&&function startListening(){r()(document).on(o.change+"."+t,updateElementAfterNextRender),c||setElement()}()),e},this.unobserve=function(e){(i=s.a.without(i,e)).length||function stopListening(){r()(document).off("."+t)}()}};function isEventSupported(t){var e=document.createElement("p"),i=!1;if(e.addEventListener)e.addEventListener(t,(function(){i=!0}),!1);else{if(!e.attachEvent)return!1;e.attachEvent("on"+t,(function(){i=!0}))}return e.setAttribute("id","target"),i}function hasBlockElement(t){return s.a.some(u,(function(e){return new RegExp("<".concat(e,"[^>]*>(.*?)<\\/").concat(e,">")).test(t)}))}e.b={capsLock:p,fullScreen:d,getViewportOffset:function getViewportOffset(){var t=r()(window),e={top:t.scrollTop(),left:t.scrollLeft()};return e.right=e.left+t.width(),e.bottom=e.top+t.height(),e},getVisibleViewportDimensions:function getVisibleViewportDimensions(){var t,e=window.innerWidth,i=window.innerHeight;return s.a.contains(["firefox","opera"],l.a.browser)&&(e=(t=r()('<div style="position:fixed;right:0;bottom:0;"></div>').appendTo(r()("body"))).get(0).getBoundingClientRect().left,i=t.get(0).getBoundingClientRect().top,t.remove()),{width:e,height:i}},sidesOnScreen:function sidesOnScreen(t){var e=r()(t),i=e.offset(),n=this.getViewportOffset();return i.right=i.left+e.outerWidth(),i.bottom=i.top+e.outerHeight(),{top:n.top<i.top&&i.top<n.bottom,right:n.right>i.right&&i.right>n.left,bottom:n.bottom>i.bottom&&i.bottom>n.top,left:n.left<i.left&&i.left<n.right}},observeMutation:function observeMutation(t,e,i){e=e||{};var n,a=r()(t),o=s.a.uniqueId("lrn.mutation."),l={childList:e.childList||!1,characterData:e.characterData||!1,attributeOldValue:e.attributeOldValue||!1,charactedDataOldValue:e.charactedDataOldValue||!1,subtree:e.subtree||!1,attributes:e.attributes||!1};if(e.attributeFilter instanceof Array&&(l.attributeFilter=e.attributeFilter),h){if(!(l.childList||l.attributes||l.characterData))return console.log('NOTE: At the very least, childList, attributes, or characterData must be set to true. Otherwise, "An invalid or illegal string was specified" error is thrown.'),!1;n=new h((function(t){t.forEach(i)})),a.each((function(){try{n.observe(t,l)}catch(e){console.log(e,t,l)}}))}else a.data("lrn-mutation-ns",o),l.attributes&&(isEventSupported("DOMAttrModified")?a.on("DOMAttrModified."+o,i):"onpropertychange"in document.body&&t.attachEvent("propertychange",i)),l.childList&&(isEventSupported("DOMSubtreeModified")?a.on("DOMSubtreeModified."+o+" DOMCharacterDataModified."+o+" DOMAttributeNameChanged."+o,i):"onpropertychange"in document.body&&a.find("*").each((function(){this.attachEvent&&this.attachEvent("onpropertychange",i)})));return n},unobserveMutation:function unobserveMutation(t,e,i){if(t)t.disconnect();else{var n=r()(e),a=n.data("lrn-mutation-ns");n.removeData("lrn-mutation-ns").off("."+a),i&&!isEventSupported("DOMSubtreeModified")&&"onpropertychange"in document.body&&(e.detachEvent("onpropertychange",i),n.find("*").each((function(){this.detachEvent&&this.detachEvent("onpropertychange",i)})))}},recomputeOpacityOn:function recomputeOpacityOn(t){if(window.getComputedStyle)return window.getComputedStyle(t).opacity},updateButtonMap:function updateButtonMap(t){var e=function getButtonMap(t){return t.map((function(){var t=r()(this),e=t.offset(),i=e.left+parseInt(t.css("margin-left"),10),n=e.top+parseInt(t.css("margin-top"),10);return{top:n,right:i+t.width(),bottom:n+t.height(),left:i,el:this,links:{}}})).get()}(t);function isBetween(t,e,i){return s.a.min([e,i])<=t&&s.a.max([e,i])>=t}function closest(t,e){var i=(e.left+e.right)/2,n=(e.top+e.bottom)/2;return s.a.first(s.a.sortBy(t,(function(t){var e=(t.left+t.right)/2,r=(t.top+t.bottom)/2,a=Math.abs(e-i),s=Math.abs(r-n);return Math.sqrt(a*a+s*s)})))}function areAligned(t,e,i,n){return isBetween(i,t,e)||isBetween(n,t,e)||isBetween(t,i,n)&&isBetween(e,i,n)}return s.a.each(e,(function(t){var i,n,r,a,s=[],o=[];for(a=0;a<e.length;a++)(r=e[a])!==t&&(areAligned(t.top,t.bottom,r.top,r.bottom)&&r.left>=t.right&&s.push(r),areAligned(t.left,t.right,r.left,r.right)&&r.top>=t.bottom&&o.push(r));i=closest(s,t),n=closest(o,t),i&&(t.links.RIGHT=i,i.links.LEFT=t),n&&(t.links.DOWN=n,n.links.UP=t)})),e},toggleBackgroundClickable:function toggleBackgroundClickable(t){var e=r()("html"),i=e.map((function(){return r()(this).css("cursor")})).get();t&&!s.a.isEqual(i,["pointer"])&&(this.cachedHtmlCursorStyle=i,e.css("cursor","pointer")),!t&&this.cachedHtmlCursorStyle&&s.a.each(this.cachedHtmlCursorStyle,(function(t,i){e.eq(i).css("cursor","auto"===t?"":t)}))},isElementVisible:function isElementVisible(t){return!!t.offsetParent&&"hidden"!==getComputedStyle(t).getPropertyValue("visibility")},focusable:function focusable(t,e){var i,n,a,s=t.nodeName.toLowerCase();return"area"===s?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(a=r()('img[usemap="#'+n+'"]')[0])&&this.isElementVisible(a))):(/^(input|select|textarea|button|object)$/.test(s)?!t.disabled:"a"===s&&t.href||e)&&this.isElementVisible(t)},getNextTab:function getNextTab(t,e){var i,n,a,o,l,c=!1,u=!1,h=this,p=!0;return r()(document).find("*").each((function(d,f){return n=r()(f),a=n.attr("tabindex"),o=isNaN(a),i=(o||a>=0)&&h.focusable(f,!o),l=!1,s.a.isArray(e)&&s.a.each(e,(function(t){n.hasClass(t)&&(l=!0)})),!!l||(!u&&i&&(u=n),c&&i?(p=!1,u=n,!1):void(i&&f===t&&(c=!0)))})),!!u&&{nextTabElement:u,isFirstElement:p}},detectRenderEnd:function detectRenderEnd(t,e){var i=this,n={childList:!0,subtree:!0,attributes:!0};return new c.default((function(r){var a,s;function resolveSoon(){clearTimeout(a),a=setTimeout((function(){i.unobserveMutation(s,t,resolveSoon),r()}),e)}s=i.observeMutation(t,n,resolveSoon),resolveSoon()}))}}},133:function(t,e,i){"use strict";i.d(e,"a",(function(){return i18nTemplate}));var n=i(0),r=i.n(n);function i18nTemplate(t,e){return r.a.isEmpty(t)?"":(r()(e).forEach((function(e,i){var n="{{".concat(i,"}}");t=t.replace(n,e)})),t)}},134:function(t,e,i){"use strict";i.d(e,"g",(function(){return isEnterOrSpace})),i.d(e,"i",(function(){return r})),i.d(e,"h",(function(){return a})),i.d(e,"d",(function(){return s})),i.d(e,"e",(function(){return o})),i.d(e,"f",(function(){return l})),i.d(e,"b",(function(){return c})),i.d(e,"c",(function(){return u}));var n={PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,ESCAPE:27,ENTER:13,TAB:9,SHIFT:16,SPACE:32,DELETE:46,ADD_EQUAL:187,FF_ADD_EQUAL:61,NUM_PAD_ADD:107,MINUS:189,FF_MINUS:173,NUM_PAD_MINUS:109,NUM_PAD_MULTIPLY:106,DIVIDE:191,NUM_PAD_DIVIDE:111,DECIMAL:190,NUM_PAD_DECIMAL:110,NUMBER_0:48,NUMBER_1:49,NUMBER_2:50,NUMBER_3:51,NUMBER_4:52,NUMBER_5:53,NUMBER_6:54,NUMBER_7:55,NUMBER_8:56,NUMBER_9:57,NUM_PAD_0:96,NUM_PAD_1:97,NUM_PAD_2:98,NUM_PAD_3:99,NUM_PAD_4:100,NUM_PAD_5:101,NUM_PAD_6:102,NUM_PAD_7:103,NUM_PAD_8:104,NUM_PAD_9:105};function isEnterOrSpace(t){return t===n.ENTER||t===n.SPACE}var r=function isTabKey(t){return"Tab"===t.key||t.keyCode===n.TAB},a=function isEscapeKey(t){return"Escape"===t.key||t.keyCode===n.ESCAPE},s=function isArrowLeftKey(t){return"ArrowLeft"===t.key||t.keyCode===n.LEFT},o=function isArrowRightKey(t){return"ArrowRight"===t.key||t.keyCode===n.RIGHT},l=function isArrowUpKey(t){return"ArrowUp"===t.key||t.keyCode===n.UP},c=function isArrowDownKey(t){return"ArrowDown"===t.key||t.keyCode===n.DOWN},u=function isArrowKey(t){return s(t)||o(t)||l(t)||c(t)};e.a=n},136:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(10),s=(i(42),i(35));function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=["exactMatch","partialMatch","partialMatchV2"],l=function isDefaultValidResponseValue(t){return 0===r.a.filter(t,(function(t){return t||0===t})).length},c=function(t){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}(ClozeScorer,t);var e=_createSuper(ClozeScorer);function ClozeScorer(){return _classCallCheck(this,ClozeScorer),e.apply(this,arguments)}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(ClozeScorer,[{key:"reset",value:function reset(t){var e=JSON.stringify(t),i=this.flags||this.cachedFlags;if(this.serializedData!==e){t.question.validation&&t.question.validation.scoring_type||(t=a.a.normalizeParameters(t));var n=getOptions(t.question,i);try{this.scoringData=function getScoringData(t,e){var i=t.question.validation,n=[];if(!function canValidateResponse(t){if(!1===r.a.getNested(t,"validation.automarkable"))return!1;var e=t.validation||t||{};return!r.a.isEmpty(e)&&(r.a.isArray(e.valid_responses)||r.a.isObject(e.valid_response)&&!l(e.valid_response.value))}(t.question))return{automarkable:!1};t.question.equiv_literal_legacy&&(t=a.a.processCompatibility(t));if(t.response=t.response||{},i&&i.scoring_type){if(!r.a.contains(o,i.scoring_type))throw new a.a.InvalidScoringTypeException(t.question.type,i.scoring_type);return i.valid_response&&n.push(i.valid_response),i.alt_responses&&(n=n.concat(i.alt_responses)),function processResponsesCurrentScoringFormat(t,e,i){var n={score:1,penaltyScore:0,rounding:"floor"};return a.a.scoreArray(t,e,n,i)}(t,n,e)}return r.a.isArray(t.question.valid_responses)?function processLegacyResponses1233(t,e){var i,n,s=t.question,o=t.response&&t.response.value||[],l=s.valid_responses,c=[];e=getOptions(s,{stripWhiteSpaceForMath:!0}),r.a.each(o,(function(t,s){var o,u,h=l[s],p=!1;r.a.each(h,(function(i){i.value&&r.a.isNumber(i.score)&&(a.a.stringCompare(t,i.value,e)?(u=i.score,p=!0):u=u||0,(r.a.isUndefined(o)||i.score>o)&&(o=i.score))})),i=a.a.addIfDefined(i,u),n=a.a.addIfDefined(n,o),c.push(p)})),o.length||r.a.each(l,(function(t,e){var i;r.a.each(t,(function(t){r.a.isNumber(t.score)&&(r.a.isUndefined(i)||t.score>i)&&(i=t.score)})),n=a.a.addIfDefined(n,i)}));return{score:i,responsesValid:c,maxScore:n,isValid:c.length?r.a.all(c):void 0}}(t,e):function processLegacyResponsesPre2140(t,e){var i,n=t.question,s=t.response||{};n.validation=n.validation||{};var o,l,c=n.validation.valid_responses,u=s.value||[],h=Math.abs(r.a.isNumber(n.validation.penalty_score)?n.validation.penalty_score:0),p=function getResponseScoreArray(t){var e,i=parseFloat(t.validation.valid_score),n=t.validation.valid_responses,a=[];if(i=isNaN(i)?1:i,r.a.isArray(t.validation.valid_score))a=t.validation.valid_score;else for(var s=0;s<n.length;s++){e=[];for(var o=0;o<n[s].length;o++)e.push(i);a.push(e)}return a}(n),d=[],f=0;r.a.each(u,(function(t,n){var s=c[n],l=0,u=!1;if(!r.a.isUndefined(t)&&null!==t&&""!==t&&r.a.isArray(s))for(var f=0;f<s.length;f++){if(a.a.stringCompare(t,s[f],e)){l=p[n][f],i=s,u=!0;break}l=-1*h}d.push(u),o=(r.a.isUndefined(o)?0:o)+l})),r.a.each(p,(function(t){f+=r.a.max(t)})),u.length&&!1===n.validation.partial_scoring&&o!==f&&(o=0);u.length&&d.length&&(l=!1===n.validation.partial_scoring?r.a.all(d):r.a.any(d));return{score:o,responsesValid:d,suggestedResponse:i,maxScore:f,isValid:l}}(t,e)}(t,n),a.a.normalizeScores(this.scoringData,t)}catch(t){this.scoringData={error:t}}this.serializedData=e}return this.cachedFlags=i,this}},{key:"flags",get:function get(){}}]),ClozeScorer}(s.a);function getOptions(t,e){var i={caseSensitive:!!t.case_sensitive,removeWhitespace:!!t.is_math&&e.stripWhiteSpaceForMath,matchAllPossibleResponses:!(!t.validation||!t.validation.match_all_possible_responses)};return delete e.stripWhiteSpaceForMath,r.a.extend(e,i)}e.a=c},137:function(t,e,i){"use strict";i.d(e,"c",(function(){return getViewportDimensions})),i.d(e,"b",(function(){return getElementDocumentBounding}));var n=i(0),r=i.n(n),a=document.documentElement;function getViewportScroll(){return{left:window.pageXOffset||a.scrollLeft,top:window.pageYOffset||a.scrollTop}}function getViewportDimensions(){var t=getViewportScroll();return{top:t.top,left:t.left,width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight}}function getDocumentDimensions(){var t=document.body,e=document.documentElement;return{width:Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),height:Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)}}function getElementDocumentBounding(t){var e=t.getBoundingClientRect(),i=getViewportScroll();return{top:e.top+i.top,left:e.left+i.left,width:e.width,height:e.height}}e.a={relativeToElement:function relativeToElement(t,e,i){var n=r.a.extend({gap:0,viewportGap:5,centerAlign:!0},i),a=n.gap,s=getElementDocumentBounding(e),o=n.centerAlign?s.width/2:0,l=getElementDocumentBounding(t),c=n.centerAlign?l.width/2:0,u=n.viewportGap,h=getViewportDimensions(),p=getDocumentDimensions(),d=l.top+l.height+a,f=p.height-d,m=l.top-h.top<h.height+h.top-d&&f>s.height||d<s.height,g=l.left+c-o,b=d,y="bottom";return s.width>=h.width?g=0:g+s.width>h.width?g=h.width-s.width-u:g<0&&(g=u),b+s.height>h.top+h.height&&(b=l.top-s.height-a,y="top"),(b<0||m)&&(b=d,y="bottom"),{left:g,top:b,position:y}},getViewportScroll:getViewportScroll,getViewportDimensions:getViewportDimensions,getViewportCenter:function getViewportCenter(){var t=getViewportDimensions();return{x:t.left+t.width/2,y:t.top+t.height/2}},getDocumentDimensions:getDocumentDimensions,getElementDocumentBounding:getElementDocumentBounding,getPositionRelativeToParent:function getPositionRelativeToParent(t,e){var i=getElementDocumentBounding(t),n=getElementDocumentBounding(e);return{top:i.top-n.top,left:i.left-n.left}}}},139:function(t,e,i){"use strict";i(5),i(1);var n=i(0),r=i.n(n),a=i(179),s=[{key:"mathrm",latex:"\\mathrm"},{key:"mathit",latex:"\\mathit"},{key:"mathbf",latex:"\\mathbf"},{key:"mathsf",latex:"\\mathsf"},{key:"mathtt",latex:"\\mathtt"},{key:"underline",latex:"\\underline"},{key:"bar",latex:"\\overline"},{key:"overline",latex:"\\overline"},{key:"_",latex:"_"},{key:"subscript",latex:"_"},{key:"^",latex:"^"},{key:"supscript",latex:"^"},{key:"superscript",latex:"^"},{key:"fraction",latex:"\\frac"},{key:"cfrac",latex:"\\frac"},{key:"dfrac",latex:"\\frac"},{key:"frac",latex:"\\frac"},{key:"over",latex:"\\frac"},{key:"√",latex:"\\sqrt"},{key:"sqrt",latex:"\\sqrt"},{key:"vec",latex:"\\vec"},{key:"nthroot",latex:"\\sqrt"},{key:"lbrace",latex:"\\left\\{\\right\\}"},{key:"lang",latex:"\\left\\langle \\right\\rangle "},{key:"langle",latex:"\\left\\langle \\right\\rangle "},{key:"rbrace",latex:"\\left\\{\\right\\}"},{key:"rang",latex:"\\left\\langle \\right\\rangle "},{key:"rangle",latex:"\\left\\langle \\right\\rangle "},{key:"lparen",latex:"\\left(\\right)"},{key:"lbracket",latex:"\\left[\\right]"},{key:"lbrack",latex:"\\left[\\right]"},{key:"rparen",latex:"\\left(\\right)"},{key:"rbracket",latex:"\\left[\\right]"},{key:"rbrack",latex:"\\left[\\right]"},{key:"rpipe",latex:"\\left|\\right|"},{key:"lpipe",latex:"\\left|\\right|"},{key:"textmd",latex:"\\text"},{key:"textup",latex:"\\text"},{key:"textrm",latex:"\\text"},{key:"textnormal",latex:"\\text"},{key:"text",latex:"\\text"},{key:"textsl",latex:"\\textit"},{key:"textit",latex:"\\textit"},{key:"emph",latex:"\\textit"},{key:"italics",latex:"\\textit"},{key:"italic",latex:"\\textit"},{key:"em",latex:"\\textit"},{key:"textbf",latex:"\\textbf"},{key:"bold",latex:"\\textbf"},{key:"strong",latex:"\\textbf"},{key:"textsf",latex:"\\textsf"},{key:"sf",latex:"\\textsf"},{key:"texttt",latex:"\\texttt"},{key:"tt",latex:"\\texttt"},{key:"textsc",latex:"\\textsc"},{key:"uppercase",latex:"\\uppercase"},{key:"lowercase",latex:"\\lowercase"},{key:"binomial",latex:"\\binom"},{key:"binom",latex:"\\binom"},{key:"matrix",latex:"\\matrix"},{key:"pmatrix",latex:"\\pmatrix"},{key:"bmatrix",latex:"\\bmatrix"},{key:"Bmatrix",latex:"\\Bmatrix"},{key:"vmatrix",latex:"\\vmatrix"},{key:"Vmatrix",latex:"\\Vmatrix"},{key:"choose",latex:"\\binom"},{key:"vector",latex:"\\vector"},{key:"editable",latex:"\\editable"},{key:"f",latex:"f"},{key:"prime",latex:"'"},{key:"&",latex:"\\&"},{key:"%",latex:"\\%"},{key:"phi",latex:"\\phi "},{key:"varphi",latex:"\\varphi "},{key:"phiv",latex:"\\varphi "},{key:"epsilon",latex:"\\epsilon "},{key:"varepsilon",latex:"\\varepsilon "},{key:"epsiv",latex:"\\varepsilon "},{key:"varpi",latex:"\\varpi "},{key:"piv",latex:"\\varpi "},{key:"varsigma",latex:"\\varsigma "},{key:"sigmav",latex:"\\varsigma "},{key:"sigmaf",latex:"\\varsigma "},{key:"thetasym",latex:"\\vartheta "},{key:"vartheta",latex:"\\vartheta "},{key:"thetav",latex:"\\vartheta "},{key:"upsi",latex:"\\upsilon "},{key:"upsilon",latex:"\\upsilon "},{key:"digamma",latex:"\\digamma "},{key:"Gammad",latex:"\\digamma "},{key:"gammad",latex:"\\digamma "},{key:"varkappa",latex:"\\varkappa "},{key:"kappav",latex:"\\varkappa "},{key:"varrho",latex:"\\varrho "},{key:"rhov",latex:"\\varrho "},{key:"π",latex:"\\pi "},{key:"pi",latex:"\\pi "},{key:"lambda",latex:"\\lambda "},{key:"Upsih",latex:"\\Upsilon "},{key:"upsih",latex:"\\Upsilon "},{key:"Upsi",latex:"\\Upsilon "},{key:"Upsilon",latex:"\\Upsilon "},{key:"+",latex:"+"},{key:"-",latex:"-"},{key:"–",latex:"-"},{key:"plusminus",latex:"\\pm "},{key:"plusmn",latex:"\\pm "},{key:"pm",latex:"\\pm "},{key:"±",latex:"\\pm "},{key:"minusplus",latex:"\\mp "},{key:"mnplus",latex:"\\mp "},{key:"mp",latex:"\\mp "},{key:"response",latex:"\\response "},{key:"cdot",latex:"\\cdot "},{key:"sdot",latex:"\\cdot "},{key:"=",latex:"="},{key:"<",latex:"<"},{key:">",latex:">"},{key:"times",latex:"\\times "},{key:"divides",latex:"\\div "},{key:"divide",latex:"\\div "},{key:"div",latex:"\\div "},{key:"neq",latex:"\\ne "},{key:"ne",latex:"\\ne "},{key:"≠",latex:"\\ne "},{key:"lowast",latex:"\\ast "},{key:"loast",latex:"\\ast "},{key:"star",latex:"\\ast "},{key:"ast",latex:"\\ast "},{key:"therefore",latex:"\\therefore "},{key:"therefor",latex:"\\therefore "},{key:"because",latex:"\\because "},{key:"cuz",latex:"\\because "},{key:"propto",latex:"\\propto "},{key:"prop",latex:"\\propto "},{key:"approx",latex:"\\approx "},{key:"asymp",latex:"\\approx "},{key:"≈",latex:"\\approx "},{key:"lt",latex:"<"},{key:"gt",latex:">"},{key:"leq",latex:"\\le "},{key:"le",latex:"\\le "},{key:"≤",latex:"\\le "},{key:"geq",latex:"\\ge "},{key:"ge",latex:"\\ge "},{key:"≥",latex:"\\ge "},{key:"isin",latex:"\\in "},{key:"contains",latex:"\\ni "},{key:"ni",latex:"\\ni "},{key:"doesnotcontain",latex:"\\not\\ni "},{key:"notcontains",latex:"\\not\\ni "},{key:"niton",latex:"\\not\\ni "},{key:"notni",latex:"\\not\\ni "},{key:"subset",latex:"\\subset "},{key:"sub",latex:"\\subset "},{key:"superset",latex:"\\supset "},{key:"supset",latex:"\\supset "},{key:"sup",latex:"\\supset "},{key:"notsubset",latex:"\\not\\subset "},{key:"nsubset",latex:"\\not\\subset "},{key:"notsub",latex:"\\not\\subset "},{key:"nsub",latex:"\\not\\subset "},{key:"notsuperset",latex:"\\not\\supset "},{key:"nsuperset",latex:"\\not\\supset "},{key:"notsupset",latex:"\\not\\supset "},{key:"nsupset",latex:"\\not\\supset "},{key:"notsup",latex:"\\not\\supset "},{key:"nsup",latex:"\\not\\supset "},{key:"subseteq",latex:"\\subseteq "},{key:"subsete",latex:"\\subseteq "},{key:"subeq",latex:"\\subseteq "},{key:"sube",latex:"\\subseteq "},{key:"superseteq",latex:"\\supseteq "},{key:"supersete",latex:"\\supseteq "},{key:"supseteq",latex:"\\supseteq "},{key:"supsete",latex:"\\supseteq "},{key:"supeq",latex:"\\supseteq "},{key:"supe",latex:"\\supseteq "},{key:"notsubseteq",latex:"\\not\\subseteq "},{key:"notsubsete",latex:"\\not\\subseteq "},{key:"nsubseteq",latex:"\\not\\subseteq "},{key:"nsubsete",latex:"\\not\\subseteq "},{key:"notsubeq",latex:"\\not\\subseteq "},{key:"notsube",latex:"\\not\\subseteq "},{key:"nsubeq",latex:"\\not\\subseteq "},{key:"nsube",latex:"\\not\\subseteq "},{key:"notsuperseteq",latex:"\\not\\supseteq "},{key:"notsupersete",latex:"\\not\\supseteq "},{key:"nsuperseteq",latex:"\\not\\supseteq "},{key:"nsupersete",latex:"\\not\\supseteq "},{key:"notsupseteq",latex:"\\not\\supseteq "},{key:"notsupsete",latex:"\\not\\supseteq "},{key:"nsupseteq",latex:"\\not\\supseteq "},{key:"nsupsete",latex:"\\not\\supseteq "},{key:"notsupeq",latex:"\\not\\supseteq "},{key:"notsupe",latex:"\\not\\supseteq "},{key:"nsupeq",latex:"\\not\\supseteq "},{key:"nsupe",latex:"\\not\\supseteq "},{key:"summation",latex:"\\sum "},{key:"sum",latex:"\\sum "},{key:"∑",latex:"\\sum "},{key:"product",latex:"\\prod "},{key:"prod",latex:"\\prod "},{key:"∏",latex:"\\prod "},{key:"coproduct",latex:"\\coprod "},{key:"coprod",latex:"\\coprod "},{key:"integral",latex:"\\int "},{key:"int",latex:"\\int "},{key:"∫",latex:"\\int "},{key:"Naturals",latex:"\\mathbb{N}"},{key:"naturals",latex:"\\mathbb{N}"},{key:"Probability",latex:"\\mathbb{P}"},{key:"probability",latex:"\\mathbb{P}"},{key:"Projective",latex:"\\mathbb{P}"},{key:"projective",latex:"\\mathbb{P}"},{key:"Primes",latex:"\\mathbb{P}"},{key:"primes",latex:"\\mathbb{P}"},{key:"P",latex:"\\mathbb{P}"},{key:"Integers",latex:"\\mathbb{Z}"},{key:"integers",latex:"\\mathbb{Z}"},{key:"Rationals",latex:"\\mathbb{Q}"},{key:"rationals",latex:"\\mathbb{Q}"},{key:"Q",latex:"\\mathbb{Q}"},{key:"Reals",latex:"\\mathbb{R}"},{key:"reals",latex:"\\mathbb{R}"},{key:"ComplexPlane",latex:"\\mathbb{C}"},{key:"Complexplane",latex:"\\mathbb{C}"},{key:"complexplane",latex:"\\mathbb{C}"},{key:"Complexes",latex:"\\mathbb{C}"},{key:"complexes",latex:"\\mathbb{C}"},{key:"Complex",latex:"\\mathbb{C}"},{key:"complex",latex:"\\mathbb{C}"},{key:"C",latex:"\\mathbb{C}"},{key:"Quaternions",latex:"\\mathbb{H}"},{key:"quaternions",latex:"\\mathbb{H}"},{key:"Hamiltonian",latex:"\\mathbb{H}"},{key:"emsp",latex:"\\quad "},{key:"quad",latex:"\\quad "},{key:"qquad",latex:"\\qquad "},{key:"diamond",latex:"\\diamond "},{key:"bigtriangleup",latex:"\\bigtriangleup "},{key:"ominus",latex:"\\ominus "},{key:"uplus",latex:"\\uplus "},{key:"bigtriangledown",latex:"\\bigtriangledown "},{key:"sqcap",latex:"\\sqcap "},{key:"triangleleft",latex:"\\triangleleft "},{key:"sqcup",latex:"\\sqcup "},{key:"triangleright",latex:"\\triangleright "},{key:"odot",latex:"\\odot "},{key:"bigcirc",latex:"\\bigcirc "},{key:"dagger",latex:"\\dagger "},{key:"ddagger",latex:"\\ddagger "},{key:"wr",latex:"\\wr "},{key:"amalg",latex:"\\amalg "},{key:"models",latex:"\\models "},{key:"prec",latex:"\\prec "},{key:"succ",latex:"\\succ "},{key:"preceq",latex:"\\preceq "},{key:"succeq",latex:"\\succeq "},{key:"simeq",latex:"\\simeq "},{key:"mid",latex:"\\mid "},{key:"ll",latex:"\\ll "},{key:"gg",latex:"\\gg "},{key:"parallel",latex:"\\parallel "},{key:"bowtie",latex:"\\bowtie "},{key:"sqsubset",latex:"\\sqsubset "},{key:"sqsupset",latex:"\\sqsupset "},{key:"smile",latex:"\\smile "},{key:"sqsubseteq",latex:"\\sqsubseteq "},{key:"sqsupseteq",latex:"\\sqsupseteq "},{key:"doteq",latex:"\\doteq "},{key:"frown",latex:"\\frown "},{key:"vdash",latex:"\\vdash "},{key:"dashv",latex:"\\dashv "},{key:"longleftarrow",latex:"\\longleftarrow "},{key:"longrightarrow",latex:"\\longrightarrow "},{key:"Longleftarrow",latex:"\\Longleftarrow "},{key:"Longrightarrow",latex:"\\Longrightarrow "},{key:"longleftrightarrow",latex:"\\longleftrightarrow "},{key:"updownarrow",latex:"\\updownarrow "},{key:"Longleftrightarrow",latex:"\\Longleftrightarrow "},{key:"Updownarrow",latex:"\\Updownarrow "},{key:"mapsto",latex:"\\mapsto "},{key:"nearrow",latex:"\\nearrow "},{key:"hookleftarrow",latex:"\\hookleftarrow "},{key:"hookrightarrow",latex:"\\hookrightarrow "},{key:"searrow",latex:"\\searrow "},{key:"leftharpoonup",latex:"\\leftharpoonup "},{key:"rightharpoonup",latex:"\\rightharpoonup "},{key:"swarrow",latex:"\\swarrow "},{key:"leftharpoondown",latex:"\\leftharpoondown "},{key:"rightharpoondown",latex:"\\rightharpoondown "},{key:"nwarrow",latex:"\\nwarrow "},{key:"ldots",latex:"\\ldots "},{key:"cdots",latex:"\\cdots "},{key:"vdots",latex:"\\vdots "},{key:"ddots",latex:"\\ddots "},{key:"surd",latex:"\\surd "},{key:"triangle",latex:"\\triangle "},{key:"ell",latex:"\\ell "},{key:"top",latex:"\\top "},{key:"flat",latex:"\\flat "},{key:"natural",latex:"\\natural "},{key:"sharp",latex:"\\sharp "},{key:"wp",latex:"\\wp "},{key:"bot",latex:"\\bot "},{key:"clubsuit",latex:"\\clubsuit "},{key:"diamondsuit",latex:"\\diamondsuit "},{key:"heartsuit",latex:"\\heartsuit "},{key:"spadesuit",latex:"\\spadesuit "},{key:"oint",latex:"\\oint "},{key:"bigcap",latex:"\\bigcap "},{key:"bigcup",latex:"\\bigcup "},{key:"bigsqcup",latex:"\\bigsqcup "},{key:"bigvee",latex:"\\bigvee "},{key:"bigwedge",latex:"\\bigwedge "},{key:"bigodot",latex:"\\bigodot "},{key:"bigotimes",latex:"\\bigotimes "},{key:"bigoplus",latex:"\\bigoplus "},{key:"biguplus",latex:"\\biguplus "},{key:"lfloor",latex:"\\lfloor "},{key:"rfloor",latex:"\\rfloor "},{key:"lceil",latex:"\\lceil "},{key:"rceil",latex:"\\rceil "},{key:"slash",latex:"\\slash "},{key:"opencurlybrace",latex:"\\opencurlybrace "},{key:"closecurlybrace",latex:"\\closecurlybrace "},{key:"caret",latex:"\\caret "},{key:"underscore",latex:"\\underscore "},{key:"backslash",latex:"\\backslash "},{key:"vert",latex:"|"},{key:"perpendicular",latex:"\\perp "},{key:"perp",latex:"\\perp "},{key:"del",latex:"\\nabla "},{key:"nabla",latex:"\\nabla "},{key:"hbar",latex:"\\hbar "},{key:"angstrom",latex:"\\text\\AA "},{key:"Angstrom",latex:"\\text\\AA "},{key:"AA",latex:"\\text\\AA "},{key:"circle",latex:"\\circ "},{key:"circ",latex:"\\circ "},{key:"ring",latex:"\\circ "},{key:"bullet",latex:"\\bullet "},{key:"bull",latex:"\\bullet "},{key:"smallsetminus",latex:"\\setminus "},{key:"setminus",latex:"\\setminus "},{key:"neg",latex:"\\neg "},{key:"¬",latex:"\\neg "},{key:"not",latex:"\\neg "},{key:"hellipsis",latex:"\\dots "},{key:"ellipsis",latex:"\\dots "},{key:"hellip",latex:"\\dots "},{key:"ellip",latex:"\\dots "},{key:"dots",latex:"\\dots "},{key:"…",latex:"\\dots "},{key:"downarrow",latex:"\\downarrow "},{key:"dnarrow",latex:"\\downarrow "},{key:"dnarr",latex:"\\downarrow "},{key:"darr",latex:"\\downarrow "},{key:"converges",latex:"\\downarrow "},{key:"Downarrow",latex:"\\Downarrow "},{key:"dnArrow",latex:"\\Downarrow "},{key:"dnArr",latex:"\\Downarrow "},{key:"dArr",latex:"\\Downarrow "},{key:"uparrow",latex:"\\uparrow "},{key:"uarr",latex:"\\uparrow "},{key:"diverges",latex:"\\uparrow "},{key:"Uparrow",latex:"\\Uparrow "},{key:"uArr",latex:"\\Uparrow "},{key:"to",latex:"\\to "},{key:"rightarrow",latex:"\\rightarrow "},{key:"rarr",latex:"\\rightarrow "},{key:"implies",latex:"\\Rightarrow "},{key:"Rightarrow",latex:"\\Rightarrow "},{key:"rArr",latex:"\\Rightarrow "},{key:"gets",latex:"\\gets "},{key:"leftarrow",latex:"\\leftarrow "},{key:"larr",latex:"\\leftarrow "},{key:"impliedby",latex:"\\Leftarrow "},{key:"Leftarrow",latex:"\\Leftarrow "},{key:"lArr",latex:"\\Leftarrow "},{key:"leftrightarrow",latex:"\\leftrightarrow "},{key:"lrarr",latex:"\\leftrightarrow "},{key:"harr",latex:"\\leftrightarrow "},{key:"iff",latex:"\\Leftrightarrow "},{key:"Leftrightarrow",latex:"\\Leftrightarrow "},{key:"lrArr",latex:"\\Leftrightarrow "},{key:"hArr",latex:"\\Leftrightarrow "},{key:"real",latex:"\\Re "},{key:"Real",latex:"\\Re "},{key:"Re",latex:"\\Re "},{key:"Imaginary",latex:"\\Im "},{key:"imaginary",latex:"\\Im "},{key:"imagin",latex:"\\Im "},{key:"image",latex:"\\Im "},{key:"imag",latex:"\\Im "},{key:"Im",latex:"\\Im "},{key:"partial",latex:"\\partial "},{key:"part",latex:"\\partial "},{key:"infinity",latex:"\\infty "},{key:"infty",latex:"\\infty "},{key:"infin",latex:"\\infty "},{key:"inf",latex:"\\infty "},{key:"alephsym",latex:"\\aleph "},{key:"aleph",latex:"\\aleph "},{key:"alefsym",latex:"\\aleph "},{key:"alef",latex:"\\aleph "},{key:"exists",latex:"\\exists "},{key:"exist",latex:"\\exists "},{key:"xists",latex:"\\exists "},{key:"xist",latex:"\\exists "},{key:"wedge",latex:"\\wedge "},{key:"land",latex:"\\wedge "},{key:"and",latex:"\\wedge "},{key:"vee",latex:"\\vee "},{key:"lor",latex:"\\vee "},{key:"or",latex:"\\vee "},{key:"varnothing",latex:"\\varnothing "},{key:"nothing",latex:"\\varnothing "},{key:"Oslash",latex:"\\varnothing "},{key:"oslash",latex:"\\varnothing "},{key:"emptyset",latex:"\\varnothing "},{key:"empty",latex:"\\varnothing "},{key:"union",latex:"\\cup "},{key:"intersection",latex:"\\cap "},{key:"intersect",latex:"\\cap "},{key:"cap",latex:"\\cap "},{key:"degree",latex:"^\\circ "},{key:"deg",latex:"^\\circ "},{key:"angle",latex:"\\angle "},{key:"ang",latex:"\\angle "}],o=r.a.unique(r.a.pluck(s,"latex")),l=[];function strTrim(t){return String.prototype.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}r.a.each(o,(function(t){var e,i=strTrim(t);r.a.contains(["\\varsigma","\\vartheta"],i)&&(i=i.replace("\\var","\\")),e={id:i,aliases:r.a.map(r.a.pluck(r.a.where(s,{latex:t}),"key"),strTrim)},l.push(e)}));var c,u=new a.a(l),h=[{id:"",label:"empty",title:"",numberpad_and_keypad:!0},{id:"x",label:"x",type:"write",val:"x",shortcut:["x"],title:"x",name:"x",label_latex:!0},{id:"y",label:"y",type:"write",val:"y",shortcut:["y"],title:"y",name:"y",label_latex:!0},{id:"z",label:"z",type:"write",val:"z",shortcut:["z"],title:"z",name:"z",label_latex:!0},{id:"a",label:"a",type:"write",val:"a",shortcut:["a"],title:"a",name:"a",label_latex:!0},{id:"b",label:"b",type:"write",val:"b",shortcut:["b"],title:"b",name:"b",label_latex:!0},{id:"c",label:"c",type:"write",val:"c",shortcut:["c"],title:"c",name:"c",label_latex:!0},{id:"d",label:"d",type:"write",val:"d",shortcut:["d"],title:"d",name:"d",label_latex:!0},{id:"f",label:"f",type:"write",val:"f",shortcut:["f"],title:"f",name:"f",label_latex:!0},{id:"abc",label:"abc",type:"write",val:"\\text{abc}",shortcut:["toggle","abc"],title:"abc",name:"abc"},{id:",",label:",",type:"write",val:",",shortcut:[],title:""},{id:"'",label:"\\prime",type:"write",val:"'",shortcut:[],title:"Prime/Arcminute",name:"prime"},{id:'"',label:"\\doublePrime",type:"write",val:'"',shortcut:[],title:"Double Prime/Arcsecond",name:"doubleprime"},{id:"\\$",label:"$",type:"write",val:"\\$",shortcut:[],title:"Dollars",name:"dollars"},{id:"¢",label:"¢",type:"write",val:"¢",shortcut:[],title:"Cents",name:"cents"},{id:"+",label:"+",type:"write",val:"+",shortcut:["+"],title:"Plus",name:"plus"},{id:"-",label:"-",type:"write",val:"-",shortcut:["-"],title:"Minus",name:"minus"},{id:"\\times",label:"×",type:"write",val:"\\times",shortcut:["*"],title:"Multiply",name:"times"},{id:"\\div",label:"÷",type:"write",val:"\\div",shortcut:["toggle","/"],title:"Divide",name:"div"},{id:"\\pm",label:"±",type:"write",val:"\\pm",shortcut:["toggle","pm"],title:"Plus or minus",name:"pm"},{id:"=",label:"=",type:"write",val:"=",shortcut:["="],title:"Equals",name:"equals"},{id:">",label:">",type:"write",val:">",shortcut:[">"],title:"Greater than",name:"greater"},{id:"<",label:"<",type:"write",val:"<",shortcut:["<"],title:"Less than",name:"less"},{id:"\\ge",label:"≥",type:"write",val:"\\ge",shortcut:["toggle","gte"],title:"Greater than or equal to",name:"ge"},{id:"\\le",label:"≤",type:"write",val:"\\le",shortcut:["toggle","lte"],title:"Less than or equal to",name:"le"},{id:"\\ne",label:"≠",type:"write",val:"\\neq",shortcut:["toggle","ne"],title:"Not equal to",name:"ne"},{id:"\\approx",label:"≈",type:"write",val:"\\approx",shortcut:["toggle","ae"],title:"Approximately equal to",name:"approx"},{id:"\\perp",label:"\\perp",type:"write",val:"\\perp",shortcut:["toggle","pr"],title:"Perpendicular to",name:"perp"},{id:"\\nsim",label:"≁",type:"write",val:"\\nsim",shortcut:["toggle","nsim"],title:"Not similar",name:"nsim"},{id:"\\ncong",label:"≇",type:"write",val:"\\ncong",shortcut:["toggle","ncong"],title:"Not congruent",name:"ncong"},{id:"\\propto",label:"\\propto",type:"write",val:"\\propto",shortcut:["toggle","pl"],title:"Proportional to",name:"propto"},{id:"\\mid",label:"|",type:"write",val:"|",shortcut:[],title:"Vertical line",name:"mid"},{id:"\\ngtr",label:"\\ngtr",type:"write",val:"\\ngtr",shortcut:[],title:"Not greater than",name:"ngtr"},{id:"\\nless",label:"\\nless",type:"cmd",val:"\\nless",shortcut:[],title:"Not less than",name:"nless"},{id:"\\left(\\right)",label:"\\left(\\right)",type:"cmd",val:"(",shortcut:["toggle","rd"],title:"Group in parentheses",name:"parentheses"},{id:"\\left[\\right]",label:"\\left[\\right]",type:"cmd",val:"[",shortcut:["toggle","sr"],title:"Group in brackets",name:"brackets"},{id:"\\left\\{\\right\\}",label:"\\left\\{\\right\\}",type:"cmd",val:"{",shortcut:["toggle","cr"],title:"Group in curly braces",name:"curlybraces"},{id:"\\left[\\right)",label:"\\left[\\right)",type:"write",val:"\\left[\\right)",shortcut:[],title:"Group in odd braces",name:"rightbraces"},{id:"\\left(\\right]",label:"\\left(\\right]",type:"write",val:"\\left(\\right]",shortcut:[],title:"Group in odd braces",name:"leftbraces"},{id:"[",label:"[",type:"write",val:"[",shortcut:["["],title:"Left square bracket",name:"leftbracket"},{id:"]",label:"]",type:"write",val:"]",shortcut:["]"],title:"Right square bracket",name:"rightbracket"},{id:"^",label:"x^{}",type:"cmd",val:"^",shortcut:["^"],title:"Exponent",label_latex:!0,name:"exponent"},{id:"^2",label:"x^2",type:"write",val:"^2",shortcut:["toggle","pt"],title:"Square",label_latex:!0,name:"square"},{id:"_",label:"x_{}",type:"cmd",val:"_",shortcut:["_"],title:"Subscript",label_latex:!0,name:"subscript"},{id:"\\frac",label:"\\frac{x}{}",type:"cmd",val:"/",shortcut:["/"],title:"Fraction using previous expression as numerator",name:"frac"},{id:"x\\frac{}{}",label:"x\\frac{}{}",type:"write",val:"\\frac{}{}",shortcut:["toggle","mf"],title:"Fraction",name:"fraction",extra_commands:[{type:"keystroke",val:"Left"},{type:"keystroke",val:"Up"}]},{id:"\\frac{}{}",label:"\\frac{}{}",type:"write",val:"\\frac{}{}",shortcut:[],title:"Fraction",name:"fraction",extra_commands:[{type:"keystroke",val:"Left"},{type:"keystroke",val:"Up"}]},{id:":",label:":",type:"write",val:":",shortcut:[":"],title:"Ratio",name:"ratio"},{id:"%",label:"%",type:"write",val:"%",shortcut:["%"],title:"Percentage",name:"percentage"},{id:"\\abs",label:"\\abs{}",type:"cmd",val:"\\abs",shortcut:["toggle","abs"],title:"Absolute value",name:"abs"},{id:"\\sqrt",label:"\\sqrt{}",type:"cmd",val:"\\sqrt",shortcut:["toggle","sq"],title:"Square root",name:"sqrt"},{id:"\\sqrt[3]{}",label:"\\sqrt[3]{}",type:"cmd",val:"\\lrncuberoot",shortcut:["toggle","cb"],title:"Cube root",name:"cube"},{id:"\\sqrt[n]{}",label:"\\sqrt[]{}",type:"cmd",val:"\\nthroot",shortcut:["toggle","nsq"],title:"Nth root",name:"nthroot"},{id:"\\int_{}^{}",label:"\\int_{}^{}",type:"write",val:"\\int_{}^{}",shortcut:["toggle","int"],title:"Integral",name:"int",extra_commands:[{type:"keystroke",val:"Left"},{type:"keystroke",val:"Down"}]},{id:"\\iint_{}",label:"\\iint_{}",type:"write",val:"\\iint_{}",shortcut:[],title:"Double Integral",name:"doubleint",label_latex:!0},{id:"\\iiint_{}",label:"\\iiint_{}",type:"write",val:"\\iiint_{}",shortcut:[],title:"Triple Integral",name:"tripleint",label_latex:!0},{id:"\\sum",label:"\\sum",type:"write",val:"\\sum",shortcut:[],title:"Summation",name:"sum",label_latex:!0},{id:"\\partial",label:"\\partial",type:"write",val:"\\partial",shortcut:[],title:"Partial Derivative",name:"partial",label_latex:!0},{id:"\\lim_{x\\to {}}",label:"\\lim_{x\\to {}}",type:"write",val:"\\lim_{x\\to {}}",shortcut:[],title:"Limit x to",name:"limit",label_latex:!0},{id:"\\underset{\\sim}{\\mathbf{}}",label:"\\underset{\\sim}{\\mathbf{}}",type:"write",val:"\\underset{\\sim}{\\mathbf{}}",shortcut:["toggle","vec"],title:"Vector",name:"vector",extra_commands:[{type:"keystroke",val:"Left"},{type:"keystroke",val:"Left"}],aliases:["\\mathbf{\\underset{\\sim}{}}"]},{id:"\\mathbb{R}",label:"\\mathbb{R}",type:"write",val:"\\mathbb{R}",shortcut:["toggle","rea"],title:"Real number set",name:"mathbb"},{id:"\\mathbbq",label:"\\mathbb{Q}",type:"write",val:"\\mathbb{Q}",shortcut:[],title:"Q",name:"mathbbq"},{id:"\\mathbbn",label:"\\mathbb{N}",type:"write",val:"\\mathbb{N}",shortcut:[],title:"N",name:"mathbbn"},{id:"\\mathbbz",label:"\\mathbb{Z}",type:"write",val:"\\mathbb{Z}",shortcut:[],title:"Z",name:"mathbbz"},{id:"\\mathbbi",label:"\\mathbb{I}",type:"write",val:"\\mathbb{I}",shortcut:[],title:"I",name:"mathbbi"},{id:"\\mathbbc",label:"\\mathbb{C}",type:"write",val:"\\mathbb{C}",shortcut:[],title:"C",name:"mathbbc"},{id:"imaginary",label:"i",type:"write",val:"\\text{i}",shortcut:[],title:"Imaginary Number",name:"imaginary"},{id:"euler",label:"e",type:"write",val:"\\text{e}",shortcut:[],title:"Euler Number",name:"euler"},{id:"\\alpha",label:"\\alpha",type:"write",val:"\\alpha",shortcut:["toggle","al"],title:"Alpha",name:"alpha"},{id:"\\beta",label:"\\beta",type:"write",val:"\\beta",shortcut:["toggle","be"],title:"Beta",name:"beta"},{id:"\\gamma",label:"\\gamma",type:"write",val:"\\gamma",shortcut:["toggle","ga"],title:"Gamma",name:"gamma"},{id:"\\delta",label:"\\delta",type:"write",val:"\\delta",shortcut:["toggle","de"],title:"Delta",name:"delta"},{id:"\\epsilon",label:"\\epsilon",type:"write",val:"\\epsilon",shortcut:["toggle","ep"],title:"Epsilon",name:"epsilon"},{id:"\\varepsilon",label:"\\varepsilon",type:"write",val:"\\varepsilon",shortcut:["toggle","vep"],title:"Epsilon",name:"epsilon"},{id:"\\zeta",label:"\\zeta",type:"write",val:"\\zeta",shortcut:["toggle","ze"],title:"Zeta",name:"zeta"},{id:"\\eta",label:"\\eta",type:"write",val:"\\eta",shortcut:["toggle","et"],title:"Eta",name:"eta"},{id:"\\theta",label:"\\theta",type:"write",val:"\\theta",shortcut:["toggle","th"],title:"Theta",name:"theta"},{id:"\\iota",label:"\\iota",type:"write",val:"\\iota",shortcut:["toggle","io"],title:"Iota",name:"iota"},{id:"\\kappa",label:"\\kappa",type:"write",val:"\\kappa",shortcut:["toggle","ka"],title:"Kappa",name:"kappa"},{id:"\\lambda",label:"\\lambda",type:"write",val:"\\lambda",shortcut:["toggle","lbd"],title:"Lambda",name:"lambda"},{id:"\\mu",label:"\\mu",type:"write",val:"\\mu",shortcut:["toggle","mu"],title:"Mu",name:"mu"},{id:"\\nu",label:"\\nu",type:"write",val:"\\nu",shortcut:["toggle","nu"],title:"Nu",name:"nu"},{id:"\\xi",label:"\\xi",type:"write",val:"\\xi",shortcut:["toggle","xi"],title:"Xi",name:"xi"},{id:"o",label:"o",type:"write",val:"o",shortcut:["toggle","omc"],title:"Omicron",name:"omicron",label_latex:!0},{id:"\\pi",label:"\\pi",type:"write",val:"\\pi",shortcut:["toggle","pi"],title:"Pi",name:"pi"},{id:"\\rho",label:"\\rho",type:"write",val:"\\rho",shortcut:["toggle","rh"],title:"Rho",name:"rho"},{id:"\\sigma",label:"\\sigma",type:"write",val:"\\sigma",shortcut:["toggle","sig"],title:"Sigma",name:"sigma"},{id:"\\tau",label:"\\tau",type:"write",val:"\\tau",shortcut:["toggle","ta"],title:"Tau",name:"tau"},{id:"\\upsilon",label:"\\upsilon",type:"write",val:"\\upsilon",shortcut:["toggle","ups"],title:"Upsilon",name:"upsilon"},{id:"\\phi",label:"\\phi",type:"write",val:"\\phi",shortcut:["toggle","ph"],title:"Phi",name:"phi"},{id:"\\chi",label:"\\chi",type:"write",val:"\\chi",shortcut:["toggle","ch"],title:"Chi",name:"chi"},{id:"\\psi",label:"\\psi",type:"write",val:"\\psi",shortcut:["toggle","psi"],title:"Psi",name:"psi"},{id:"\\omega",label:"\\omega",type:"write",val:"\\omega",shortcut:["toggle","omg"],title:"Omega",name:"omega"},{id:"A",label:"A",type:"write",val:"A",shortcut:["toggle","ual"],title:"Alpha (uppercase)",name:"ALPHA",label_latex:!0},{id:"B",label:"B",type:"write",val:"B",shortcut:["toggle","ube"],title:"Beta (uppercase)",name:"BETA",label_latex:!0},{id:"\\Gamma",label:"\\Gamma",type:"write",val:"\\Gamma",shortcut:["toggle","uga"],title:"Gamma (uppercase)",name:"GAMMA"},{id:"\\Delta",label:"\\Delta",type:"write",val:"\\Delta",shortcut:["toggle","ude"],title:"Delta (uppercase)",name:"DELTA"},{id:"E",label:"E",type:"write",val:"E",shortcut:["toggle","uep"],title:"Epsilon (uppercase)",name:"EPSILON",label_latex:!0},{id:"Z",label:"Z",type:"write",val:"Z",shortcut:["toggle","uze"],title:"Zeta (uppercase)",name:"ZETA",label_latex:!0},{id:"H",label:"H",type:"write",val:"H",shortcut:["toggle","uet"],title:"Eta (uppercase)",name:"ETA",label_latex:!0},{id:"\\Theta",label:"\\Theta",type:"write",val:"\\Theta",shortcut:["toggle","uth"],title:"Theta (uppercase)",name:"THETA"},{id:"I",label:"I",type:"write",val:"I",shortcut:["toggle","uio"],title:"Iota (uppercase)",name:"IOTA",label_latex:!0},{id:"K",label:"K",type:"write",val:"K",shortcut:["toggle","uka"],title:"Kappa (uppercase)",name:"KAPPA",label_latex:!0},{id:"\\Lambda",label:"\\Lambda",type:"write",val:"\\Lambda",shortcut:["toggle","ulbd"],title:"Lambda (uppercase)",name:"LAMBDA"},{id:"M",label:"M",type:"write",val:"M",shortcut:["toggle","umu"],title:"Mu (uppercase)",name:"MU",label_latex:!0},{id:"N",label:"N",type:"write",val:"N",shortcut:["toggle","unu"],title:"Nu (uppercase)",name:"NU",label_latex:!0},{id:"\\Xi",label:"\\Xi",type:"write",val:"\\Xi",shortcut:["toggle","uxi"],title:"Xi (uppercase)",name:"XI"},{id:"O",label:"O",type:"write",val:"O",shortcut:["toggle","uomc"],title:"Omicron (uppercase)",name:"OMICRON",label_latex:!0},{id:"\\Pi",label:"\\Pi",type:"write",val:"\\Pi",shortcut:["toggle","upi"],title:"Pi (uppercase)",name:"PI"},{id:"R",label:"R",type:"write",val:"R",shortcut:["toggle","urh"],title:"Rho (uppercase)",name:"RHO",label_latex:!0},{id:"\\Sigma",label:"\\Sigma",type:"write",val:"\\Sigma",shortcut:["toggle","w"],title:"Sigma (uppercase)",name:"SIGMA"},{id:"T",label:"T",type:"write",val:"T",shortcut:["toggle","uta"],title:"Tau (uppercase)",name:"TAU",label_latex:!0},{id:"\\Upsilon",label:"\\Upsilon",type:"write",val:"\\Upsilon",shortcut:["toggle","uups"],title:"Upsilon (uppercase)",name:"UPI"},{id:"\\Phi",label:"\\Phi",type:"write",val:"\\Phi",shortcut:["toggle","uph"],title:"Phi (uppercase)",name:"PHI"},{id:"X",label:"X",type:"write",val:"X",shortcut:["toggle","uch"],title:"Chi (uppercase)",name:"PHI",label_latex:!0},{id:"\\Psi",label:"\\Psi",type:"write",val:"\\Psi",shortcut:["toggle","upsi"],title:"Psi (uppercase)",name:"PSI"},{id:"\\Omega",label:"\\Omega",type:"write",val:"\\Omega",shortcut:["toggle","uomg"],title:"Omega (uppercase)",name:"OMEGA"},{id:"\\sin",label:"\\sin",type:"write",val:"\\sin",shortcut:["toggle","sin"],title:"Sine",name:"sin"},{id:"\\cos",label:"\\cos",type:"write",val:"\\cos",shortcut:["toggle","cos"],title:"Cosine",name:"cos"},{id:"\\tan",label:"\\tan",type:"write",val:"\\tan",shortcut:["toggle","tan"],title:"Tangent",name:"tan"},{id:"\\arcsin",label:"\\arcsin",type:"write",val:"\\arcsin",shortcut:["toggle","isin"],title:"Inverse sine",name:"arcsin"},{id:"\\arccos",label:"\\arccos",type:"write",val:"\\arccos",shortcut:["toggle","icos"],title:"Inverse cosine",name:"arccos"},{id:"\\arctan",label:"\\arctan",type:"write",val:"\\arctan",shortcut:["toggle","itan"],title:"Inverse tangent",name:"arctan"},{id:"\\sec",label:"\\sec",type:"write",val:"\\sec",shortcut:[],title:""},{id:"\\csc",label:"\\csc",type:"write",val:"\\csc",shortcut:[],title:""},{id:"\\cot",label:"\\cot",type:"write",val:"\\cot",shortcut:[],title:""},{id:"\\sin^{-1}",label:"\\sin^{-1}",type:"write",val:"\\sin^{-1}",shortcut:[],title:""},{id:"\\sec^{-1}",label:"\\sec^{-1}",type:"write",val:"\\sec^{-1}",shortcut:[],title:""},{id:"\\cos^{-1}",label:"\\cos^{-1}",type:"write",val:"\\cos^{-1}",shortcut:[],title:""},{id:"\\csc^{-1}",label:"\\csc^{-1}",type:"write",val:"\\csc^{-1}",shortcut:[],title:""},{id:"\\tan^{-1}",label:"\\tan^{-1}",type:"write",val:"\\tan^{-1}",shortcut:[],title:""},{id:"\\cot^{-1}",label:"\\cot^{-1}",type:"write",val:"\\cot^{-1}",shortcut:[],title:""},{id:"\\cap",label:"\\intersection",type:"write",val:"\\intersection",shortcut:["toggle","ir"],title:"Intersection",name:"cap"},{id:"\\cup",label:"\\union",type:"write",val:"\\union",shortcut:["toggle","un"],title:"Union",name:"union"},{id:"\\in",label:"\\in",type:"write",val:"\\in",shortcut:["toggle","mo"],title:"Member of",name:"in"},{id:"\\notin",label:"\\notin",type:"write",val:"\\notin",shortcut:["toggle","nmo"],title:"Not member of",name:"notin"},{id:"\\ni",label:"\\ni",type:"write",val:"\\ni",shortcut:["toggle","cs"],title:"Contains",name:"ni"},{id:"\\subseteq",label:"\\subseteq",type:"write",val:"\\subseteq",shortcut:["toggle","sb"],title:"Subset",name:"subseteq"},{id:"\\supseteq",label:"\\supseteq",type:"write",val:"\\supseteq",shortcut:["toggle","sp"],title:"Superset",name:"supseteq"},{id:"\\subset",label:"\\subset",type:"write",val:"\\subset",shortcut:["toggle","ssb"],title:"Subset (strict)",name:"subset"},{id:"\\supset",label:"\\supset",type:"write",val:"\\supset",shortcut:["toggle","ssp"],title:"Superset (strict)",name:"supset"},{id:"\\not\\subset",label:"\\not\\subset",type:"write",val:"\\not\\subset",shortcut:["toggle","snb"],title:"Not subset (strict)",name:"notsubset"},{id:"\\not\\supset",label:"\\not\\supset",type:"write",val:"\\not\\supset",shortcut:["toggle","snp"],title:"Not superset (strict)",name:"notsupset"},{id:"\\not\\subseteq",label:"\\not\\subseteq",type:"write",val:"\\not\\subseteq",shortcut:["toggle","nsb"],title:"Not subset",name:"notsubseteq"},{id:"\\not\\supseteq",label:"\\not\\supseteq",type:"write",val:"\\not\\supseteq",shortcut:["toggle","nsp"],title:"Not superset",name:"notsupseteq"},{id:"\\not\\ni",label:"\\not\\ni",type:"write",val:"\\not\\ni",shortcut:["toggle","ncs"],title:"Does not contain",name:"notni"},{id:"\\backslash",label:"\\backslash",type:"write",val:"\\backslash",shortcut:["toggle","bsh"],title:"Backslash",name:"backslash"},{id:"\\slash",label:"\\slash",type:"write",val:"\\slash",shortcut:["ctrl","/"],title:"Forward slash",name:"slash"},{id:"!",label:"!",type:"write",val:"!",shortcut:["!"],title:"Factorial",name:"factorial"},{id:"\\emptyset",label:"\\emptyset",type:"write",val:"\\emptyset",shortcut:[],title:""},{id:"\\angle",label:"\\angle",type:"write",val:"\\angle",shortcut:["toggle","ang"],title:"Angle",name:"angle"},{id:"\\measuredangle",label:"\\measuredangle",type:"write",val:"\\measuredangle",shortcut:["toggle","mang"],title:"Measure of angle",name:"measuredangle"},{id:"\\parallel",label:"\\parallel",type:"write",val:"\\parallel",shortcut:["toggle","pa"],title:"Parallel to",name:"parallel"},{id:"\\nparallel",label:"\\nparallel",type:"write",val:"\\nparallel",shortcut:["toggle","npa"],title:"Not parallel to",name:"nparallel"},{id:"\\sim",label:"\\sim",type:"write",val:"\\sim",shortcut:["toggle","sm"],title:"Similar to",name:"sim"},{id:"\\cong",label:"\\cong",type:"write",val:"\\cong",shortcut:["toggle","cg"],title:"Congruent to",name:"cong"},{id:"\\degree",label:"\\degree",type:"write",val:"\\degree",shortcut:["toggle","dg"],title:"Degree symbol",name:"degree"},{id:"\\triangle",label:"\\triangle",type:"write",val:"\\triangle",shortcut:["toggle","tri"],title:"Triangle",name:"triangle"},{id:"\\circledot",label:"\\circledot",type:"write",val:"\\circledot",shortcut:["toggle","cir"],title:"Circle",name:"circledot"},{id:"\\circ",label:"\\circ",type:"write",val:"\\circ",shortcut:["toggle","circ"],title:"Composition",name:"circ"},{id:"\\parallelogram",label:"\\parallelogram",type:"cmd",val:"\\parallelogram",shortcut:["toggle","par"],title:"Parallelogram",name:"parallelogram"},{id:"\\overarc",label:"\\overarc{}",type:"cmd",val:"\\overarc",shortcut:["toggle","oa"],title:"Arc",name:"overarc"},{id:"\\leftarrow",label:"\\leftarrow",type:"write",val:"\\leftarrow",shortcut:["toggle","la"],title:"Leftwards arrow",name:"leftarrow"},{id:"\\rightarrow",label:"\\rightarrow",type:"write",val:"\\rightarrow",shortcut:["toggle","ra"],title:"Rightwards arrow",name:"rightarrow"},{id:"\\leftrightarrow",label:"\\leftrightarrow",type:"write",val:"\\leftrightarrow",shortcut:["toggle","lr"],title:"Left/right arrow",name:"leftrightarrow"},{id:"\\longleftrightarrow",label:"\\longleftrightarrow",type:"write",val:"\\longleftrightarrow",shortcut:["toggle","llr"],title:"Long left/right arrow",name:"longleftrightarrow"},{id:"\\rightdoublearrow",label:"\\Rightarrow",type:"write",val:"\\Rightarrow",shortcut:["toggle","rda"],title:"Implies equivalence",name:"rightdoublearrow"},{id:"\\leftrightdoublearrow",label:"\\Leftrightarrow",type:"write",val:"\\Leftrightarrow",shortcut:["toggle","lrda"],title:"Material equivalence",name:"leftrightdoublearrow"},{id:"\\overrightarrow",label:"\\overrightarrow{}",type:"cmd",val:"\\overrightarrow",shortcut:["toggle","ry"],title:"Ray",name:"overrightarrow"},{id:"\\overleftarrow",label:"\\overleftarrow{}",type:"cmd",val:"\\overleftarrow",shortcut:["toggle","ry"],title:"Left ray",name:"overleftarrow"},{id:"\\overleftrightarrow",label:"\\overleftrightarrow{}",type:"cmd",val:"\\overleftrightarrow",shortcut:["toggle","li"],title:"Line",name:"overleftrightarrow"},{id:"\\overline",label:"\\overline{}",type:"cmd",val:"\\overline",shortcut:["toggle","li"],title:"Line segment",name:"overline"},{id:"\\dot",label:"\\dot{}",type:"cmd",val:"\\dot",shortcut:[],title:"Recurring Decimal",name:"dot"},{id:"\\longdiv",label:"\\longdiv{}",type:"cmd",val:"\\longdiv",shortcut:["toggle","ld"],title:"Long division",name:"longdiv"},{id:"\\overset{}^{H}",label:"\\overset{}^{H}",type:"write",val:"\\overset{}{} ",shortcut:["toggle","ox"],title:"Oxidation",name:"overset",label_latex:!0,extra_commands:[{type:"keystroke",val:"Up"}]},{id:"\\therefore",label:"\\therefore",type:"write",val:"\\therefore",shortcut:["toggle","tf"],title:"Therefore",name:"therefore"},{id:"\\infty",label:"\\infinity",type:"write",val:"\\infinity",shortcut:["toggle","ift"],title:"Infinity",name:"infty"},{id:"\\square",label:"\\square",type:"write",val:"\\square",shortcut:["toggle","sqr"],title:"Square",name:"square"},{id:"\\matrix",label:"☷",type:"cmd",val:"\\matrix",shortcut:["toggle","mx"],title:"Matrix",name:"matrix"},{id:"\\pmatrix",label:"(☷)",type:"cmd",val:"\\pmatrix",shortcut:["toggle","px"],title:"Matrix bounded by parentheses",name:"pmatrix"},{id:"\\bmatrix",label:"\\begin{bmatrix}&\\\\&\\end{bmatrix}",type:"cmd",val:"\\bmatrix",shortcut:["toggle","bx"],title:"2 x 2 Matrix bounded by brackets",name:"bmatrix",label_latex:!0},{id:"\\threebmatrix",label:"\\begin{bmatrix}&&\\\\&&\\\\&&\\end{bmatrix}",type:"write",val:"\\begin{bmatrix}&&\\\\&&\\\\&&\\end{bmatrix}",shortcut:[],title:"3 x 3 Matrix bounded by brackets",name:"threebmatrix",label_latex:!0,extra_commands:[{type:"keystroke",val:"Left Left Left Up Up"}]},{id:"\\singlebmatrix",label:"\\begin{bmatrix}\\end{bmatrix}",type:"write",val:"\\begin{bmatrix}\\end{bmatrix}",shortcut:[],title:"Single Matrix bounded by brackets",name:"singlebmatrix",label_latex:!0,extra_commands:[{type:"keystroke",val:"Left"}]},{id:"\\Bmatrix",label:"{☷}",type:"cmd",val:"\\Bmatrix",shortcut:["toggle","bbx"],title:"Matrix bounded by braces",name:"Bmatrix"},{id:"\\vmatrix",label:"|☷|",type:"cmd",val:"\\vmatrix",shortcut:["toggle","vx"],title:"Matrix bounded by vertical lines",name:"vmatrix"},{id:"\\Vmatrix",label:"‖☷‖",type:"cmd",val:"\\Vmatrix",shortcut:["toggle","vvx"],title:"Matrix bounded by double vertical lines",name:"Vmatrix"},{id:"\\ldots",label:"\\ldots",type:"write",val:"\\ldots",shortcut:["toggle","ld"],title:"Horizontal dots (baseline)",name:"ldots"},{id:"\\cdots",label:"\\cdots",type:"write",val:"\\cdots",shortcut:["toggle","cd"],title:"Horizontal dots (centered)",name:"cdots"},{id:"\\ddots",label:"\\ddots",type:"write",val:"\\ddots",shortcut:["toggle","dd"],title:"Diagonal dots",name:"ddots"},{id:"\\vdots",label:"\\vdots",type:"write",val:"\\vdots",shortcut:["toggle","vd"],title:"Vertical dots",name:"vdots"},{id:"\\cdot",label:"\\cdot",type:"write",val:"\\cdot",shortcut:[],title:"Dot multiplier",name:"cdot"},{id:"\\cdotp",label:"\\cdotp",type:"write",val:"\\cdotp",shortcut:[],title:"Center dot (punctuation)",name:"cdotp"},{id:"\\response",label:"□",type:"write",val:"\\response",shortcut:["toggle","rs"],title:"Editable {{response}} area",name:"response"},{id:"║",label:"\\addmatrixcol",type:"softkey",val:"insertColumn",shortcut:["toggle","space"],title:"Insert column",name:"addmatrixcol",label_latex:!0},{id:"═",label:"\\addmatrixrow",type:"softkey",val:"insertRow",shortcut:["toggle","enter"],title:"Insert row",name:"addmatrixrow"},{id:"g",label:"g",type:"write",val:"\\text{g}",shortcut:["g"],title:"Gram",name:"gram"},{id:"cg",label:"cg",type:"write",val:"\\text{cg}",shortcut:["cg"],title:"Centigram",name:"cg"},{id:"kg",label:"kg",type:"write",val:"\\text{kg}",shortcut:["kg"],title:"Kilogram",name:"kg"},{id:"mg",label:"mg",type:"write",val:"\\text{mg}",shortcut:["mg"],title:"Milligram",name:"mg"},{id:"ng",label:"ng",type:"write",val:"\\text{ng}",shortcut:["ng"],title:"Nanogram",name:"ng"},{id:"m",label:"m",type:"write",val:"\\text{m}",shortcut:["m"],title:"Meter",name:"meter"},{id:"cm",label:"cm",type:"write",val:"\\text{cm}",shortcut:["cm"],title:"Centimeter",name:"cm"},{id:"km",label:"km",type:"write",val:"\\text{km}",shortcut:["km"],title:"Kilometer",name:"km"},{id:"mm",label:"mm",type:"write",val:"\\text{mm}",shortcut:["mm"],title:"Millimeter",name:"mm"},{id:"nm",label:"nm",type:"write",val:"\\text{nm}",shortcut:["nm"],title:"Nanometer",name:"nm"},{id:"s",label:"s",type:"write",val:"\\text{s}",shortcut:["s"],title:"Second",name:"second"},{id:"cs",label:"cs",type:"write",val:"\\text{cs}",shortcut:["cs"],title:"Centisecond",name:"cs"},{id:"ks",label:"ks",type:"write",val:"\\text{ks}",shortcut:["ks"],title:"Kilosecond",name:"ks"},{id:"ms",label:"ms",type:"write",val:"\\text{ms}",shortcut:["ms"],title:"Millisecond",name:"ms"},{id:"ns",label:"ns",type:"write",val:"\\text{ns}",shortcut:["ns"],title:"Nanosecond",name:"ns"},{id:"L",label:"L",type:"write",val:"\\text{L}",shortcut:["L"],title:"Liter",name:"liter"},{id:"mL",label:"mL",type:"write",val:"\\text{mL}",shortcut:["mL"],title:"Millitliter",name:"ml"},{id:"µg",label:"µg",type:"write",val:"\\text{µg}",shortcut:[],title:"Microgram",name:"ug"},{id:"in",label:"in",type:"write",val:"\\text{in}",shortcut:["in"],title:"Inch",name:"inch"},{id:"ft",label:"ft",type:"write",val:"\\text{ft}",shortcut:["ft"],title:"Foot",name:"ft"},{id:"mi",label:"mi",type:"write",val:"\\text{mi}",shortcut:["mi"],title:"Mile",name:"mi"},{id:"fl",label:"fl oz",type:"write",val:"\\text{fl oz}",shortcut:["fl"],title:"Fluid Ounce",name:"fl"},{id:"cup",label:"cup",type:"write",val:"\\text{cup}",shortcut:["cup"],title:"Cup",name:"cup"},{id:"pt",label:"pt",type:"write",val:"\\text{pt}",shortcut:["pt"],title:"Pint",name:"pt"},{id:"qt",label:"qt",type:"write",val:"\\text{qt}",shortcut:["qt"],title:"Quart",name:"qt"},{id:"gal",label:"gal",type:"write",val:"\\text{gal}",shortcut:["gal"],title:"Gallon",name:"gal"},{id:"oz",label:"oz",type:"write",val:"\\text{oz}",shortcut:["oz"],title:"Ounce",name:"oz"},{id:"lb",label:"lb",type:"write",val:"\\text{lb}",shortcut:["lb"],title:"Pound",name:"lb"},{id:"mug",label:"µg",type:"write",val:"\\mug",shortcut:["mug"],title:"Microgram",name:"mug"},{id:"mus",label:"µs",type:"write",val:"\\mus",shortcut:["mus"],title:"Microsecond",name:"mus"},{id:"mum",label:"µm",type:"write",val:"\\mum",shortcut:["mum"],title:"Micrometer",name:"mum"},{id:"muL",label:"µL",type:"write",val:"\\muL",shortcut:["muL"],title:"Microlitre",name:"mul"},{id:"\\because",label:"\\because",type:"cmd",val:"\\because",shortcut:[],title:"Because",name:"because",label_latex:!0},{id:"\\impliedby",label:"\\impliedby",type:"cmd",val:"\\impliedby",shortcut:[],title:"Is implied by",name:"isimpliedby",label_latex:!0},{id:"\\gg",label:"\\gg",type:"cmd",val:"\\gg",shortcut:[],title:"Much greater than",name:"muchgreaterthan",label_latex:!0},{id:"\\ll",label:"\\ll",type:"cmd",val:"\\ll",shortcut:[],title:"Much lesser than",name:"muchlesserthan",label_latex:!0},{id:"\\del",label:"\\del",type:"cmd",val:"\\del",shortcut:[],title:"Nabla",name:"nabla",label_latex:!0},{id:"\\mathbf{i}",label:"\\mathbf{i}",type:"write",shortcut:[],val:"\\mathbf{i}",title:"Standard basis I",name:"standardbasisI",label_latex:!0},{id:"\\mathbf{j}",label:"\\mathbf{j}",type:"write",shortcut:[],val:"\\mathbf{j}",title:"Standard basis J",name:"standardbasisJ",label_latex:!0},{id:"\\mathbf{k}",label:"\\mathbf{k}",type:"write",shortcut:[],val:"\\mathbf{k}",title:"Standard basis K",name:"standardbasisK",label_latex:!0},{id:"box_^",label:"\\lrnexponent{}{}",type:"cmd",val:"\\lrnexponent",shortcut:["^"],title:"Exponent",name:"exponent",label_latex:!0},{id:"box_^2",label:"\\lrnexponent{}{2}",type:"cmd",val:"\\lrnsquaredexponent",shortcut:["toggle","pt"],title:"Square",name:"square",label_latex:!0},{id:"box__",label:"\\lrnsubscript{}{}",type:"cmd",val:"\\lrnsubscript",shortcut:["_"],title:"Subscript",name:"subscript",label_latex:!0},{id:"box_\\frac",label:"\\frac{\\square}{}",type:"cmd",val:"/",shortcut:["/"],title:"Fraction",name:"fraction"},{id:"box_x\\frac{}{}",label:"\\square\\frac{}{}",type:"write",val:"\\frac{}{}",shortcut:["toggle","mf"],title:"Fraction",name:"fraction",extra_commands:[{type:"keystroke",val:"Left"},{type:"keystroke",val:"Up"}]},{id:"mol",label:"mol",type:"write",val:"\\text{mol}",shortcut:["mol"],title:"Mole",name:"mol"},{id:"\\atomic",label:"_{}^{}\\text{H}",type:"write",val:"_{}^{}",shortcut:[],title:"Atomic symbol",name:"atomic",label_latex:!0,extra_commands:[{type:"keystroke",val:"Up"}]},{id:"\\polyatomic",label:"\\text{H}_{}{}^{}",type:"write",val:"_{}{}^{}",shortcut:[],title:"Polyatomic ion",name:"polyatomic",label_latex:!0,extra_commands:[{type:"keystroke",val:"Up"}]},{id:"chem^",label:"\\text{H}^{}",type:"cmd",val:"^",shortcut:[],title:"Superscript",name:"superscript",label_latex:!0},{id:"chem_",label:"\\text{H}_{}",type:"cmd",val:"_",shortcut:[],title:"Subscript",name:"subscript",label_latex:!0},{id:"\\text{g}\\ \\text{mol}^{-1}",label:"\\text{g}\\ \\text{mol}^{-1}",type:"write",val:"\\text{g}\\ \\text{mol}^{-1}",shortcut:["gpm"],title:"Molar mass",name:"molar"},{id:"\\rightleftharpoons",label:"\\rightleftharpoons",type:"write",val:"\\rightleftharpoons",shortcut:["toggle","rlh"],title:"Right / left harpoons",name:"rightleftharpoons"},{id:"\\leftrightharpoons",label:"\\leftrightharpoons",type:"write",val:"\\leftrightharpoons",shortcut:["toggle","lrh"],title:"Left / right harpoons",name:"leftrightharpoons"},{id:"\\ce{\\bond{-}}",label:"\\ce{\\bond{-}}",type:"write",val:"\\ce{\\bond{-}}",shortcut:["toggle","sib"],title:"Single bond",name:"singlebond"},{id:"\\ce{\\bond{=}}",label:"\\ce{\\bond{=}}",type:"write",val:"\\ce{\\bond{=}}",shortcut:["toggle","dob"],title:"Double bond",name:"doublebond"},{id:"\\ce{\\bond{#}}",label:"\\ce{\\bond{#}}",type:"write",val:"\\ce{\\bond{#}}",shortcut:["toggle","trb"],title:"Triple bond",name:"triplebond"},{id:"\\ce{\\bond{...}}",label:"\\ce{\\bond{...}}",type:"write",val:"\\ce{\\bond{...}}",shortcut:["toggle","tdb"],title:"Three dot bond",name:"threedotbond"},{id:"\\ce{\\bond{....}}",label:"\\ce{\\bond{....}}",type:"write",val:"\\ce{\\bond{....}}",shortcut:["toggle","fdb"],title:"Four dot bond",name:"fourdotbond"},{id:"\\ce{\\bond{->}}",label:"\\ce{\\bond{->}}",type:"write",val:"\\ce{\\bond{->}}",shortcut:["toggle","rgb"],title:"Right arrow bond",name:"rightarrowbond"},{id:"\\ce{\\bond{<-}}",label:"\\ce{\\bond{<-}}",type:"write",val:"\\ce{\\bond{<-}}",shortcut:["toggle","lfb"],title:"Left arrow bond",name:"leftarrowbond"},{id:"\\xrightarrow",label:"\\xrightarrow[y]{x}",type:"write",val:"\\xrightarrow[]{}",shortcut:["toggle","xra"],title:"Arrow with superscript and subscript",name:"xrightarrow"},{id:"\\lfloor",label:"\\lfloor",type:"write",val:"\\lfloor",title:"Left floor",name:"lfloor"},{id:"\\rfloor",label:"\\rfloor",type:"write",val:"\\rfloor",title:"Right floor",name:"rfloor"},{id:"\\lceil",label:"\\lceil",type:"write",val:"\\lceil",title:"Left ceiling",name:"lceil"},{id:"\\rceil",label:"\\rceil",type:"write",val:"\\rceil",title:"Right ceiling",name:"rceil"},{id:"\\uparrow",label:"\\uparrow",type:"write",val:"\\uparrow",title:"Up arrow",name:"uparrow"},{id:"\\downarrow",label:"\\downarrow",type:"write",val:"\\downarrow",title:"Down arrow",name:"downarrow"},{id:"\\equiv",label:"\\equiv",type:"write",val:"\\equiv",title:"Equivalence",name:"equiv"},{id:"\\and",label:"\\and",type:"write",val:"\\and",title:"And",name:"and"},{id:"\\not",label:"\\not",type:"write",val:"\\not",title:"Not",name:"not"},{id:"\\or",label:"\\or",type:"write",val:"\\or",title:"Or",name:"or"},{id:"\\exist",label:"\\exist",type:"write",val:"\\exist",title:"Exist",name:"exist"},{id:"\\exists",label:"\\exists",type:"write",val:"\\exists",title:"Exists",name:"exists"},{id:"\\forall",label:"\\forall",type:"write",val:"\\forall",title:"Forall",name:"forall"},{id:"\\oplus",label:"\\oplus",type:"write",val:"\\oplus",title:"Circled plus",name:"oplus"},{id:"a_lowercase",label:"a",type:"write",val:"a",shortcut:["a"],title:"a",label_latex:!0},{id:"b_lowercase",label:"b",type:"write",val:"b",shortcut:["b"],title:"b",label_latex:!0},{id:"c_lowercase",label:"c",type:"write",val:"c",shortcut:["c"],title:"c",label_latex:!0},{id:"d_lowercase",label:"d",type:"write",val:"d",shortcut:["d"],title:"d",label_latex:!0},{id:"e_lowercase",label:"e",type:"write",val:"e",shortcut:["e"],title:"e",label_latex:!0},{id:"f_lowercase",label:"f",type:"write",val:"f",shortcut:["f"],title:"f",label_latex:!0},{id:"g_lowercase",label:"g",type:"write",val:"g",shortcut:["g"],title:"g",label_latex:!0},{id:"h_lowercase",label:"h",type:"write",val:"h",shortcut:["h"],title:"h",label_latex:!0},{id:"i_lowercase",label:"i",type:"write",val:"i",shortcut:["i"],title:"i",label_latex:!0},{id:"j_lowercase",label:"j",type:"write",val:"j",shortcut:["j"],title:"j",label_latex:!0},{id:"k_lowercase",label:"k",type:"write",val:"k",shortcut:["k"],title:"k",label_latex:!0},{id:"l_lowercase",label:"l",type:"write",val:"l",shortcut:["l"],title:"l",label_latex:!0},{id:"m_lowercase",label:"m",type:"write",val:"m",shortcut:["m"],title:"m",label_latex:!0},{id:"n_lowercase",label:"n",type:"write",val:"n",shortcut:["n"],title:"n",label_latex:!0},{id:"o_lowercase",label:"o",type:"write",val:"o",shortcut:["o"],title:"o",label_latex:!0},{id:"p_lowercase",label:"p",type:"write",val:"p",shortcut:["p"],title:"p",label_latex:!0},{id:"q_lowercase",label:"q",type:"write",val:"q",shortcut:["q"],title:"q",label_latex:!0},{id:"r_lowercase",label:"r",type:"write",val:"r",shortcut:["r"],title:"r",label_latex:!0},{id:"s_lowercase",label:"s",type:"write",val:"s",shortcut:["s"],title:"s",label_latex:!0},{id:"t_lowercase",label:"t",type:"write",val:"t",shortcut:["t"],title:"t",label_latex:!0},{id:"u_lowercase",label:"u",type:"write",val:"u",shortcut:["u"],title:"u",label_latex:!0},{id:"v_lowercase",label:"v",type:"write",val:"v",shortcut:["v"],title:"v",label_latex:!0},{id:"w_lowercase",label:"w",type:"write",val:"w",shortcut:["w"],title:"w",label_latex:!0},{id:"x_lowercase",label:"x",type:"write",val:"x",shortcut:["x"],title:"x",label_latex:!0},{id:"y_lowercase",label:"y",type:"write",val:"y",shortcut:["y"],title:"y",label_latex:!0},{id:"z_lowercase",label:"z",type:"write",val:"z",shortcut:["z"],title:"z",label_latex:!0},{id:"A_uppercase",label:"A",type:"write",val:"A",shortcut:["A"],title:"A",label_latex:!0},{id:"B_uppercase",label:"B",type:"write",val:"B",shortcut:["B"],title:"B",label_latex:!0},{id:"C_uppercase",label:"C",type:"write",val:"C",shortcut:["C"],title:"C",label_latex:!0},{id:"D_uppercase",label:"D",type:"write",val:"D",shortcut:["D"],title:"D",label_latex:!0},{id:"E_uppercase",label:"E",type:"write",val:"E",shortcut:["E"],title:"E",label_latex:!0},{id:"F_uppercase",label:"F",type:"write",val:"F",shortcut:["F"],title:"F",label_latex:!0},{id:"G_uppercase",label:"G",type:"write",val:"G",shortcut:["G"],title:"G",label_latex:!0},{id:"H_uppercase",label:"H",type:"write",val:"H",shortcut:["H"],title:"H",label_latex:!0},{id:"I_uppercase",label:"I",type:"write",val:"I",shortcut:["I"],title:"I",label_latex:!0},{id:"J_uppercase",label:"J",type:"write",val:"J",shortcut:["J"],title:"J",label_latex:!0},{id:"K_uppercase",label:"K",type:"write",val:"K",shortcut:["K"],title:"K",label_latex:!0},{id:"L_uppercase",label:"L",type:"write",val:"L",shortcut:["L"],title:"L",label_latex:!0},{id:"M_uppercase",label:"M",type:"write",val:"M",shortcut:["M"],title:"M",label_latex:!0},{id:"N_uppercase",label:"N",type:"write",val:"N",shortcut:["N"],title:"N",label_latex:!0},{id:"O_uppercase",label:"O",type:"write",val:"O",shortcut:["O"],title:"O",label_latex:!0},{id:"P_uppercase",label:"P",type:"write",val:"P",shortcut:["P"],title:"P",label_latex:!0},{id:"Q_uppercase",label:"Q",type:"write",val:"Q",shortcut:["Q"],title:"Q",label_latex:!0},{id:"R_uppercase",label:"R",type:"write",val:"R",shortcut:["R"],title:"R",label_latex:!0},{id:"S_uppercase",label:"S",type:"write",val:"S",shortcut:["S"],title:"S",label_latex:!0},{id:"T_uppercase",label:"T",type:"write",val:"T",shortcut:["T"],title:"T",label_latex:!0},{id:"U_uppercase",label:"U",type:"write",val:"U",shortcut:["U"],title:"U",label_latex:!0},{id:"V_uppercase",label:"V",type:"write",val:"V",shortcut:["V"],title:"V",label_latex:!0},{id:"W_uppercase",label:"W",type:"write",val:"W",shortcut:["W"],title:"W",label_latex:!0},{id:"X_uppercase",label:"X",type:"write",val:"X",shortcut:["X"],title:"X",label_latex:!0},{id:"Y_uppercase",label:"Y",type:"write",val:"Y",shortcut:["Y"],title:"Y",label_latex:!0},{id:"Z_uppercase",label:"Z",type:"write",val:"Z",shortcut:["Z"],title:"Z",label_latex:!0},{id:"7",label:"7",type:"write",val:"7",shortcut:["7"],title:"Seven",name:"seven",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"8",label:"8",type:"write",val:"8",shortcut:["8"],title:"Eight",name:"eight",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"9",label:"9",type:"write",val:"9",shortcut:["9"],title:"Nine",name:"nine",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"÷",label:"÷",type:"write",val:"÷",shortcut:["÷"],title:"Divided by",name:"divide",style:"lrn-btn-grid-operator",numberpad_symbol:!0},{id:"4",label:"4",type:"write",val:"4",shortcut:["4"],title:"Four",name:"four",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"5",label:"5",type:"write",val:"5",shortcut:["5"],title:"Five",name:"five",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"6",label:"6",type:"write",val:"6",shortcut:["6"],title:"Six",name:"six",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"multiply",label:"×",type:"write",val:"×",shortcut:["×"],title:"Multiplied by",name:"multiply",style:"lrn-btn-grid-operator",numberpad_symbol:!0},{id:"1",label:"1",type:"write",val:"1",shortcut:["1"],title:"One",name:"one",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"2",label:"2",type:"write",val:"2",shortcut:["2"],title:"Two",name:"two",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"3",label:"3",type:"write",val:"3",shortcut:["3"],title:"Three",name:"three",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"minus",label:"-",type:"write",val:"-",shortcut:["-"],title:"Minus",name:"minus",style:"lrn-btn-grid-operator",numberpad_symbol:!0},{id:"0",label:"0",type:"write",val:"0",shortcut:["0"],title:"Zero",name:"zero",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"decimal",label:".",type:"write",val:".",shortcut:["."],title:"Decimal",name:"decimal",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"comma",label:",",type:"write",val:",",shortcut:[","],title:"Comma",name:"comma",style:"lrn-btn-grid-num",numberpad_symbol:!0},{id:"plus",label:"+",type:"write",val:"+",shortcut:["+"],title:"Plus",name:"plus",style:"lrn-btn-grid-operator",numberpad_symbol:!0},{id:"left",label:"<",type:"keystroke",val:"Left",shortcut:[],title:"Move cursor left",name:"left",style:"lrn-btn-grid-dir",numberpad_symbol:!0,key_style:"lrn_arrow_left"},{id:"right",label:">",type:"keystroke",val:"Right",shortcut:[],title:"Move cursor right",name:"right",style:"lrn-btn-grid-dir",numberpad_symbol:!0,key_style:"lrn_arrow_right"},{id:"backspace",label:"Backspace",type:"keystroke",val:"Backspace",shortcut:[],title:"Backspace",name:"backspace",style:"lrn-btn-grid-dir",numberpad_symbol:!0,key_style:"lrn_backspace"},{id:"=",label:"=",type:"write",val:"=",shortcut:["="],title:"Equals",name:"equals",style:"lrn-btn-grid-operator",numberpad_symbol:!0},{id:"\\left\\{\\begin{array}{l}\\end{array}\\right.",label:"\\left\\{\\begin{array}{l}x+\\\\y+\\end{array}\\right.",type:"write",val:"\\left\\{\\begin{array}{l} \\\\ \\end{array}\\right.",shortcut:["toggle","ine"],title:"System of equations/inequalities",name:"inequalities",style:"lrn-btn-array"},{id:"\\begin{array}{rlll}\\end{array}",label:"\\begin{array}{rlll}&=&\\\\&=&\\end{array}",type:"write",val:"\\begin{array}{rlll}&+&&=\\\\&+&&=\\end{array}",shortcut:["toggle","mle"],title:"Multi line equation",name:"multiline",style:"lrn-btn-array"},{id:"{{response}}",label:"\\MathQuillResponseContainerIcon",type:"write",val:"\\MathQuillResponseContainer",title:"Response Container",name:"responseContainerIcon",style:"lrn-btn-grid-operator"}],p=new a.a;r.a.each(h,(function(t){var e=u.get(t.id);e?(e.set(t),p.add(e)):p.add(t)}));var d=[{symbol:"+",group:"Arithmetic"},{symbol:"-",group:"Arithmetic"},{symbol:"\\times",group:"Arithmetic"},{symbol:"\\div",group:"Arithmetic"},{symbol:"\\pm",group:"Arithmetic"},{symbol:"=",group:"Comparison"},{symbol:">",group:"Comparison"},{symbol:"<",group:"Comparison"},{symbol:"\\ge",group:"Comparison"},{symbol:"\\le",group:"Comparison"},{symbol:"\\ne",group:"Comparison"},{symbol:"\\approx",group:"Comparison"},{symbol:"\\perp",group:"Comparison"},{symbol:"\\propto",group:"Comparison"},{symbol:"\\left(\\right)",group:"Parentheses"},{symbol:"\\left[\\right]",group:"Parentheses"},{symbol:"\\left\\{\\right\\}",group:"Parentheses"},{symbol:"^",group:"Subscript and superscript"},{symbol:"^2",group:"Subscript and superscript"},{symbol:"_",group:"Subscript and superscript"},{symbol:"\\frac",group:"Fraction"},{symbol:":",group:"Fraction"},{symbol:"\\sqrt",group:"Root"},{symbol:"\\sqrt[n]{}",group:"Root"},{symbol:"\\pi",group:"Greek letters"},{symbol:"\\Pi",group:"Greek letters"},{symbol:"\\sigma",group:"Greek letters"},{symbol:"\\Sigma",group:"Greek letters"},{symbol:"\\delta",group:"Greek letters"},{symbol:"\\Delta",group:"Greek letters"},{symbol:"\\theta",group:"Greek letters"},{symbol:"\\Theta",group:"Greek letters"},{symbol:"\\matrix",group:"Matrices"},{symbol:"\\bmatrix",group:"Matrices"},{symbol:"\\ldots",group:"Matrices"},{symbol:"\\ddots",group:"Matrices"},{symbol:"\\vdots",group:"Matrices"},{symbol:"║",group:"Matrices"},{symbol:"═",group:"Matrices"}],f={handwriting:{title:"Handwriting",name:"Handwriting",label:"&#9997;",render_latex:!1},qwerty:{title:"Keyboard",name:"Keyboard",label:"&#9000;",render_latex:!1},basic:{title:"Basic",label:"\\text{Basic}",value:["x","y","^2","\\sqrt","\\frac","x\\frac{}{}","^","_","<",">","\\pm","\\$","%","\\degree",":","\\left(\\right)","\\abs","\\pi","\\infty"]},basic_junior:{title:"Basic Junior",label:"=",value:["<",">","","","\\frac","x\\frac{}{}"]},basic_author:{title:"Basic",label:"\\text{Basic}",value:["x","y","^2","\\sqrt","\\frac","x\\frac{}{}","^","_","<",">","\\pm","\\$","%","\\degree",":","\\left(\\right)","\\abs","\\pi","\\infty"]},algebra:{title:"Algebra",label:"x",value:["x","y","^2","\\sqrt","\\frac","x\\frac{}{}","^","\\sqrt[n]{}","<",">","\\pm","\\abs","\\pi","\\infty","\\left(\\right)","\\left[\\right]"]},comparison:{title:"Comparison",label:"<",value:["\\ne","\\approx","","","<",">","","","\\le","\\ge","","","\\ngtr","\\nless"]},geometry:{title:"Geometry",label:"\\angle",value:["\\perp","\\parallel","\\nparallel","\\underset{\\sim}{\\mathbf{}}","\\angle","\\measuredangle","\\sim","\\cong","\\triangle","\\circledot","\\parallelogram","\\overarc","\\degree","'",'"',"\\pi","\\overline","\\overrightarrow","\\overleftrightarrow","\\square"]},matrices:{title:"Matrices",label:"\\begin{bmatrix}&\\\\&\\end{bmatrix}",value:["\\ldots","\\singlebmatrix","║","═","\\ddots","\\bmatrix","","","\\vdots","\\threebmatrix","","","^","","","","_"]},trigonometry:{title:"Trigonometry",label:"\\sin",value:["\\sin","\\sec","\\sin^{-1}","\\sec^{-1}","\\cos","\\csc","\\cos^{-1}","\\csc^{-1}","\\tan","\\cot","\\tan^{-1}","\\cot^{-1}"]},sets:{title:"Sets",label:"\\intersection",value:["\\subset","\\supset","\\subseteq","\\supseteq","\\in","\\notin","\\ni","\\not\\subset","\\cup","\\cap","\\emptyset","",",",":","!","\\backslash","\\slash","\\left(\\right)","\\left\\{\\right\\}","\\left[\\right)","\\left(\\right]"]},units_si:{title:"Units (SI)",label:"\\text{kg}",value:["g","kg","mg","µg","m","km","cm","mm","L","mL","","","s","ms"]},units_us:{title:"Units (US Customary)",label:"\\text{lb}",value:["oz","lb","","","in","ft","mi","","fl","pt","gal"]},greek:{title:"Greek letters",label:"\\alpha",value:["\\alpha","\\gamma","\\delta","\\pi","\\theta","\\sigma","\\Delta","\\Pi","\\Theta","\\Sigma","\\lambda","\\phi","\\tau","\\varepsilon","\\beta","\\mu","\\rho"]},chemistry:{title:"Chemistry",label:"\\text{Chem}",value:["chem^","chem_","\\atomic","\\polyatomic","\\rightarrow","\\leftarrow","\\rightleftharpoons","\\longleftrightarrow","\\xrightarrow","mol","'","\\overset{}^{H}","\\text{g}\\ \\text{mol}^{-1}"]},chemistry_author:{title:"Chemistry",label:"\\text{Chem}",value:["chem^","chem_","\\atomic","\\polyatomic","\\rightarrow","\\leftarrow","\\rightleftharpoons","\\longleftrightarrow","\\xrightarrow","mol","'","\\overset{}^{H}","\\text{g}\\ \\text{mol}^{-1}"]},grouping:{title:"Grouping Symbols",label:"\\left(\\right)",value:["\\left(\\right)","\\left[\\right]","\\left\\{\\right\\}"]},calculus:{title:"Calculus",label:"\\Delta",value:["d","f","\\int","\\Delta","\\prime","\\frac","\\left(\\right)","\\lim","\\int_{}^{}","\\iint_{}","\\iiint_{}","\\sum","\\partial","\\lim_{x\\to {}}","\\del","\\mathbf{i}","\\mathbf{j}","\\mathbf{k}"]},misc:{title:"Miscellaneous",label:"\\text{Misc}",value:["a","b","\\propto","abc","\\mid","\\cdot","\\longdiv","\\mathbb{R}"]},discrete:{title:"Discrete",label:"\\text{Discrete}",value:["\\lfloor","\\rfloor","\\lceil","\\rceil","\\uparrow","\\equiv","\\and","\\or","\\not","\\exist","\\forall","\\oplus"]},arrays:{title:"Arrays",label:"\\left\\{\\begin{array}{l}x\\end{array}\\right.",value:["\\left\\{\\begin{array}{l}\\end{array}\\right.","\\begin{array}{rlll}\\end{array}","║","═"]},general:{title:"General",label:"x",value:["x","y","^2","^","_","\\pm","\\frac","x\\frac{}{}","\\sqrt","\\sqrt[3]{}","\\sqrt[n]{}","%","\\abs","\\therefore","\\infty",":"]}},m=["x","y","^2",">","<","\\sqrt","\\left(\\right)","\\sin","\\frac","\\theta","\\pi","a","b","^","\\le","\\ge","\\sqrt[n]{}","\\left\\{\\right\\}","\\cos","\\tan",":"],g=r.a.map(m,(function(t){return{symbol:t}}));function getCollection(t){var e=new a.a;return r.a.each(t,(function(t){var i=p.get(t.symbol);i&&(i.set(r.a.omit(t,"symbol")),e.add(i))})),e}function getNewerFormatMasterCollection(){return c=c||function convertToNewerFormat(t){return r.a.each([{id:"║",type:"keystroke",val:"Shift-Spacebar",shortcut:["shift + space"]},{id:"═",type:"keystroke",val:"Shift-Enter",shortcut:["shift + enter"]}],(function(e){var i=t.get(e.id);i&&(t.remove(i),i=i.clone().set(e),t.add(i))})),t}(p.clone())}r.a.each(d,(function(t){r.a.contains(m,t.symbol)||r.a.contains(["+","-","\\times","\\div","="],t.symbol)||g.push(t)})),e.a={master:p,defaultInputUiSymbols:f,ctrlShortcuts:[{label:"Forward slash",type:"write",shortcut:"/",val:"\\slash"},{label:"Open keypad",type:"open-keypad",shortcut:"\\",val:""}],updateI18nSymbols:function updateI18nSymbols(t,e,i){!function updateCuratedSymbols(t){var e=t.labels.mathKeyboardSymbols||{};r.a.each(h,(function(t){var i=t.name;r.a.extend(t,{title:i?e[i]:t.title})}))}(t),function updateDefaultInputUiSymbols(t,e,i){var n=t.labels.mathKeyboardTitle||{};r.a.each(e,(function(t){var e=f[t]||{},a=r.a.findWhere(i,{id:t}),s=a&&a.label||n[t]||e.title||t.title;r.a.isEmpty(s)||(f[t]=r.a.extend(e,{title:s}))}))}(t,e,i),function updateMasterCollection(t){r.a.each(getNewerFormatMasterCollection().models,(function(e){var i=r.a.findWhere(t,{id:e.id});r.a.extend(e.attributes,{title:i.title})}))}(h)},getForToolbar:function getForToolbar(t){return getCollection(t||d)},getForKeyboard:function getForKeyboard(t){return getCollection(t||g)},getForInputUi:function getForInputUi(t,e){var i={},n=0,a=this;function formatSymbolsGroup(t,i){var n={};return(i=i||f[t]).render_latex=!r.a.isBoolean(i.render_latex)||i.render_latex,i.value&&(i=r.a.clone(i),n=a.calculateGroupDimensions(i.value,e)),"Keyboard"!==i.name&&"Handwriting"!==i.name||(n.columnCount=4,n.hasSymbols=!0,n.processedSymbols=[],n.custom=!0),i.value=n.processedSymbols,i.hasSymbols=n.hasSymbols,i.rowCount=n.rowCount,i.columnCount=n.hasSymbols?n.columnCount:0,i.custom=n.custom,i}return r.a.each(t,(function(t){if(r.a.isString(t)&&f[t]&&a.isAvailable(f[t],e)&&(i[t]=formatSymbolsGroup(t)),r.a.isObject(t)&&t.label&&r.a.isArray(t.value)&&(i["custom"+ ++n]=formatSymbolsGroup(void 0,t)),r.a.isString(t)&&"master"===t){var s={id:["=","\\response"],style:["lrn-btn-grid-num","lrn-btn-grid-operator","lrn-btn-grid-dir"]},o=r.a.reduce(h,(function(t,e){var i=e.id,n=e.style;return i&&-1===s.id.indexOf(i)&&-1===s.style.indexOf(n)&&t.push(i),t}),[]);i.master=formatSymbolsGroup(null,{title:"All Symbols",label:"All Symbols",value:o})}})),i},getForInputNumberPad:function getForInputNumberPad(t){return this.calculateGroupDimensions(t)},calculateGroupDimensions:function calculateGroupDimensions(t,e){var i,n=[],a=1,s=1,o=0,l=!1,u=this;return r.a.each(t,(function(t,i){var h;r.a.isString(t)?h=c.get(t):r.a.isObject(t)&&t.symbol&&(h=c.get(t.symbol))&&h.set(r.a.omit(t,"symbol")),t.length>0&&(l=!0,o=i+1,s>a&&(a=s)),s%4==0?s=1:s++,h&&u.isAvailable(h.attributes,e)&&n.push(h)})),i=Math.ceil(o/4),{processedSymbols:n,columnCount:a,rowCount:i,hasSymbols:l}},isAvailable:function isAvailable(t,e){var i=e?"chemistry":"math";return!r.a.isArray(t.contexts)||r.a.contains(t.contexts,i)},getShortcutsMap:function getShortcutsMap(){return this.getNewerFormatMasterCollection(),c.getShortcutsMap()},getNewerFormatMasterCollection:getNewerFormatMasterCollection}},141:function(t,e,i){"use strict";var n={};function clear(t){var e=n[t];e&&(clearTimeout(e),delete n[t])}e.a={start:function start(t,e){var i=arguments,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;clear(t);var a=function repeatFn(){e(),start.apply(null,i)};n[t]=setTimeout(a,r)},clear:clear}},143:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(31),s=function filterUnfocusableElements(t){return r.a.filter(t,(function(t){return!r.a.isNull(t)&&!t.disabled&&t.offsetWidth>0&&t.offsetHeight>0}))},o={left:function left(t){if(t){t=s(t);var e=this.getFocusedElement(t).index,i=a.a.getPreviousIndex(e,t);i>=0&&t[i].focus()}},top:function top(t){t=s(t);var e=this.getFocusedElement(t).element;if(e){var i=e.getBoundingClientRect(),n=r.a.findLastIndex(t,(function(t){var e=t.getBoundingClientRect();if(e.top<i.top&&e.right===i.right&&e.left===i.left)return!0}));n>=0&&t[n].focus()}},right:function right(t){t=s(t);var e=this.getFocusedElement(t).index;if(t&&!1!==e){var i=a.a.getNextIndex(e,t);i>=0&&t[i].focus()}},bottom:function bottom(t){t=s(t);var e=this.getFocusedElement(t).element;if(e){var i=e.getBoundingClientRect(),n=r.a.findIndex(t,(function(t){var e=t.getBoundingClientRect();if(e.top>i.top&&e.right===i.right&&e.left===i.left)return!0}));n>=0&&t[n].focus()}},getFocusedElement:function getFocusedElement(t){var e=document.activeElement,i=t.indexOf(e);return i<0?{}:{element:e,index:i}}};e.a=o},148:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(5),s=i.n(a);function MathEvents(){}var o={AWAIT_UPDATE:"await-update",CHANGE_DISABLED_STATE:"change-disabled-state",CONTENT_OUTDATED:"content-outdated",EDITOR_BLURRED:"editor-blurred",EDITOR_FOCUSED:"editor-focused",EDITOR_PRESSED:"editor-pressed",EDITOR_SPOKENMATH_UPDATED:"editor-spokenmath-updated",EDITOR_REMOVED:"editor-removed",ESCAPE_UI:"escape-ui",ESCAPE_UI_WITHOUT_KEYBOARD:"escape-ui-without-keyboard",EXTERNAL_KEY:"external-key",GET_ACTIVE_ID:"get-active-id",ITEM_BLURRED:"item-blurred",ITEM_FOCUSED:"item-focused",MATH_COMMAND:"math-command",RESET_STATE:"reset-state",SET_ERROR:"set-error",SHIFT_KEY:"shift-key",TAB_EDITOR:"tab-away-from-editor",UPDATED:"updated",WRITE_LATEX:"write-latex"};MathEvents.prototype=r.a.extend({EVENT:o},s.a.Events),r.a.extend(MathEvents,o),e.a=MathEvents},156:function(t,e,i){"use strict";i.d(e,"a",(function(){return trapFocus}));var n=i(0),r=i.n(n),a=i(1),s=i.n(a),o=i(7),l=i.n(o),c=["a[href]",'input:not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','[tabindex]:not([tabindex="-1"])',"[contenteditable]","area[href]","iframe","object","embed"].join();function trapFocus(t,e){var i=document.activeElement,n=s()(t).find(c).filter(":visible"),a=r.a.first(n),o=r.a.last(n);if(n.length){var u=function handler(t){9===t.keyCode&&(t.shiftKey?document.activeElement===a&&(t.preventDefault(),o.focus()):document.activeElement===o&&(t.preventDefault(),a.focus()))};return(e&&r.a.isFunction(e.focus)?e:a).focus(),t.addEventListener("keydown",u),t.setAttribute("role","dialog"),l.a.isSafari||t.setAttribute("aria-modal","true"),function restore(e){t.removeEventListener("keydown",u),t.removeAttribute("role"),t.removeAttribute("aria-modal"),(e&&r.a.isFunction(e.focus)?e:i).focus()}}}},157:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(175);function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function ShuffleService(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,ShuffleService),this.model=t,this.options=i,t.ready?this.initialize(t,i):t.once(t.EVENT.READY,(function(){e.initialize(t,i)}))}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(ShuffleService,[{key:"initialize",value:function initialize(t,e){var i=this;if(delete this.optionOrder,delete this._canShuffleOnDemand,this._getQuestion().shuffle_options){var n=e.key,a=e.shuffleOptions,s=e.mapValueRequired;if(r.a.isUndefined(n))return void(this._canShuffleOnDemand=!0);t.get("isDynamicContent")&&t.on("dynamicContent:changed",(function(){i._setShuffledOrder(n,a)})),this._setShuffledOrder(n,a),s&&this._attachShuffledOptionsMapHandler()}}},{key:"reInitialize",value:function reInitialize(){this.initialize(this.model,this.options)}},{key:"get",value:function get(t){return t=t||this.options.key,this.optionOrder?this._reOrderOptions(t,this.optionOrder):r.a.clone(r.a.getNested(this._getQuestion(),t))}},{key:"getDynamicSeed",value:function getDynamicSeed(){var t=this.model,e=t.get("response_id");return t.get("isDynamicContent")?"".concat(e,"_dynamic_").concat(t.get("dynamicContentRowId")):e}},{key:"getOrderedData",value:function getOrderedData(t,e){return this._canShuffleOnDemand&&!r.a.isEmpty(t)?this._shuffleArrayOnDemand(t,e):t}},{key:"mapShuffledOptionsValue",value:function mapShuffledOptionsValue(t,e){return r.a.isArray(t)&&r.a.isArray(e)&&e.length===t.length?r.a.map(e,(function(i,n){var r=t.indexOf(n);return e[r]})):e}},{key:"mapValueBasedOnOptionOrder",value:function mapValueBasedOnOptionOrder(t){var e=this.optionOrder;if(r.a.isArray(e)&&r.a.isArray(t)){var i=t&&t.length,n=e&&e.length;if(i<n)for(var a=0;a<n-i;a++)t.push(void 0);else t.slice(0,n);return r.a.map(e,(function(e){return t[e]}))}return t}},{key:"_getQuestion",value:function _getQuestion(){return this.model.get("question")}},{key:"_attachShuffledOptionsMapHandler",value:function _attachShuffledOptionsMapHandler(){var t=this,e=this.question,i=this.options,n=this.model,a=i.key,s=i.mapShuffledOptionsValue||this.mapShuffledOptionsValue,o=r.a.getNested(e,a),l="review"===r.a.getNested(n,"activityOptions.state");n.updateResponseValue=r.a.wrap(n.updateResponseValue,(function(e,i,r){l||(i=s(t.optionOrder,i,o)),e.call(n,i,r)})),n.getResponseValue=r.a.wrap(n.getResponseValue,(function(e){return t.mapValueBasedOnOptionOrder(e.call(n))})),n.mapValidationMetadataToResponseState=r.a.wrap(n.mapValidationMetadataToResponseState,(function(e,i){return i.metadata=t.mapValueBasedOnOptionOrder(i.metadata),e.call(n,i)}));var c=n.getScorer();c&&(c.suggestedResponse=r.a.wrap(c.suggestedResponse,(function(e){var i=e.call(c);return i&&i.value?r.a.extend({},i,{value:t.mapValueBasedOnOptionOrder(i.value)}):i})),c.validateIndividualResponses=r.a.wrap(c.validateIndividualResponses,(function(e){return t.mapValueBasedOnOptionOrder(e.call(c))})))}},{key:"_setShuffledOrder",value:function _setShuffledOrder(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.model;i.hasResponse()&&i.get("response").order?this.optionOrder=this.get("response").order:this.optionOrder=this._getShuffleOrder(this._getOptionsToShuffle(t),e)}},{key:"_shuffleArrayOnDemand",value:function _shuffleArrayOnDemand(t,e){var i=this._getShuffleOrder(t,{index:e}),n=r.a.clone(t);return r.a.map(i,(function(t){return n[t]}))}},{key:"_getShuffleOrder",value:function _getShuffleOrder(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.a.range(t.length),n=r.a.isNumber(e.index)?e.index:"";return Object(a.a)({exclusions:e.exclude,questionMetadata:this.model.getMetadata(),originalOrder:i,seed:this.getDynamicSeed()+n})}},{key:"_getOptionsToShuffle",value:function _getOptionsToShuffle(t){return r.a.getNested(this._getQuestion(),t)}},{key:"_reOrderOptions",value:function _reOrderOptions(t,e){var i=this;return r.a.map(e,(function(e){return i._getOptionsToShuffle(t)[e]}))}}]),ShuffleService}();e.a=s},159:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n=i(0),r=i.n(n),a=i(127),s=i.n(a),o=i(143),l=i(137),c=i(141),u=i(134),h=i(133);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p=u.a.UP,d=u.a.DOWN,f=u.a.ESCAPE,m=u.a.TAB,g=u.a.SHIFT;function getLabelContent(t,e){var i=t;return r.a.isFunction(t)&&(i=t(e)),r.a.isString(i)?i:""}function Button(t){var e=t.title,i=t.icon,n=t.label,a=t.value,o=t.index,l=t.selectedIndex,c=t.selectOption,u=t.onKeyDown,h=t.cacheButton,p=l===o?"lrn_selected":"",d=getLabelContent(n,a);return s.a.createElement("button",{title:e,"aria-label":e,className:"lrn_btn lrn_dropdown_option ".concat(p),type:"button",unselectable:"on",tabIndex:"0",onClick:function onClick(){return c(o)},onKeyDown:u,ref:function ref(t){return h&&h(t)}},function getIcon(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.a.isString(t.className)?t.className:"",i=r.a.isString(t.content)?t.content:"";return e||i?s.a.createElement("span",{className:"lrn_icon ".concat(e),dangerouslySetInnerHTML:{__html:i}}):null}(i),s.a.createElement("span",{className:"lrn_content",dangerouslySetInnerHTML:{__html:d}}))}function ScrollingIndicator(t){var e=t.scrollStart,i=t.scrollEnd;return(s.a.createElement("div",{className:"lrn_scrolling_indicator",onMouseEnter:e,onMouseLeave:i},s.a.createElement("span",{className:"lrn_caret"})))}function Viewport(t){var e=t.children,i=t.setEl,n=t.setContentEl,r=t.viewportStyle,a=(void 0===r?{}:r).height;return s.a.createElement("div",{className:"lrn_viewport",style:{height:a},ref:i},s.a.createElement("div",{className:"lrn_viewport_content",ref:n},e))}var b=function(t){_inherits(DropdownMenu,t);var e=_createSuper(DropdownMenu);function DropdownMenu(t){var i;return _classCallCheck(this,DropdownMenu),_defineProperty(_assertThisInitialized(i=e.call(this,t)),"MIN_VIEWPORT_SIZE",150),_defineProperty(_assertThisInitialized(i),"VIEWPORT_GAP",50),_defineProperty(_assertThisInitialized(i),"buttons",[]),_defineProperty(_assertThisInitialized(i),"state",{viewport:null,scrollTop:0}),_defineProperty(_assertThisInitialized(i),"focusIndex",0),_defineProperty(_assertThisInitialized(i),"cacheButton",(function(t){t&&i.buttons.push(t)})),_defineProperty(_assertThisInitialized(i),"requestToClose",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=i.props,n=e.onRequestClose,r=e.isTabbable,a=e.timeOfLastToggle,s=Date.now()-a;s<200||(c.a.clear("custom_dropdown"),i._removeAllEvents(),n&&n(t),r&&(i.focusIndex=0))})),_defineProperty(_assertThisInitialized(i),"selectOption",(function(t){var e=i.props,n=e.onChange,r=e.isTabbable;n&&n(t),r&&(i.focusIndex=0)})),_defineProperty(_assertThisInitialized(i),"_onKeyDown",(function(t){var e=_assertThisInitialized(i).buttons,n=i.props,a=n.menuOptions,s=n.isTabbable,l=t.keyCode;if(function isSupportedKey(t){return r.a.contains([p,d,f,m,g],t)}(l))if(s){if(t.shiftKey&&l===g)return;l!==m||t.shiftKey?l===m&&t.shiftKey&&i.focusIndex--:i.focusIndex++,l===m&&i.focusIndex===a.length&&i.requestToClose(!0)}else t.preventDefault(),l===f?i.requestToClose(!0):l===p?o.a.top(e):l===d&&o.a.bottom(e)})),_defineProperty(_assertThisInitialized(i),"_scrollStart",(function(){var t=_assertThisInitialized(i),e=t.viewportEl,n=t.viewportContentEl;c.a.start("custom_dropdown",(function(){var t=e.scrollTop+5;t<n.clientHeight-e.clientHeight&&i.setState({scrollTop:t})}))})),_defineProperty(_assertThisInitialized(i),"_scrollEnd",(function(){c.a.clear("custom_dropdown")})),i.useViewport=!!r.a.isUndefined(t.useViewport)||t.useViewport,i}return _createClass(DropdownMenu,[{key:"render",value:function render(){var t=this,e=this.props,i=e.menuOptions,n=e.selectedIndex,a=e.className,o=e.renderOption,l=this.state.viewport,c=r.a.isString(a)?a:"",u=function(){if(l)return{height:"".concat(l.height,"px")}}(),h=function getOptions(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.menuOptions,i=void 0===e?[]:e,n=t.selectedIndex,r=t.selectOption,a=t.onKeyDown,o=t.cacheButton,l=t.renderOption;return i.map((function(t,e){var i=t.title,c=t.icon,u=t.label,h=t.value;if(l)return t.onClick=function(){return r(e)},t.isActive=e===n,t.onKeyDown=function(t){return a(t)},l(t);var p={key:e,title:i,icon:c,label:u,value:h,index:e,selectedIndex:n,selectOption:r,onKeyDown:a,cacheButton:o};return(s.a.createElement(Button,p))}))}({menuOptions:i,selectedIndex:n,selectOption:this.selectOption,onKeyDown:this._onKeyDown,cacheButton:this.cacheButton,renderOption:o});return s.a.createElement("div",{ref:function ref(e){return t.el=e},className:"lrn_dropdown_menu ".concat(c),role:"menu"},!this.useViewport&&h,this.useViewport&&s.a.createElement(Viewport,{setEl:function setEl(e){return t.viewportEl=e},setContentEl:function setContentEl(e){return t.viewportContentEl=e},viewportStyle:u},h),this.useViewport&&u&&s.a.createElement(ScrollingIndicator,{scrollStart:this._scrollStart,scrollEnd:this._scrollEnd}))}},{key:"UNSAFE_componentWillReceiveProps",value:function UNSAFE_componentWillReceiveProps(){this.buttons=[]}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._removeAllEvents()}},{key:"componentDidUpdate",value:function componentDidUpdate(t){var e=this.props,i=e.isOpen,n=e.focusToSelectedOption;if(i&&!this._documentEventsAdded){var r=this._getSelectedOptionElement();if(n&&r&&r.focus(),this._bindListeners(),this.useViewport){var a=this._getViewport(),s={viewport:a,scrollTop:this._getScrollTopByElement(r,a)};this.state!==s&&this.setState(s)}}else i||(this._removeAllEvents(),t.isOpen!==i&&this.setState({viewport:null,scrollTop:0}));if(i){var o=this.state.scrollTop;o>0&&(this.viewportEl.scrollTop=o)}}},{key:"_getSelectedOptionElement",value:function _getSelectedOptionElement(){var t=this.buttons,e=this.props;if(!r.a.isEmpty(t)){var i=e.selectedIndex;return t[i>=0?i:0]}}},{key:"_bindListeners",value:function _bindListeners(){document.addEventListener("click",this.requestToClose),this._documentEventsAdded=!0}},{key:"_removeAllEvents",value:function _removeAllEvents(){document.removeEventListener("click",this.requestToClose),this._documentEventsAdded=!1}},{key:"_getViewport",value:function _getViewport(){var t,e=this.el,i=this.viewportContentEl,n=e.getBoundingClientRect().top,r=i.getBoundingClientRect().height,a=this.VIEWPORT_GAP,s=this.MIN_VIEWPORT_SIZE,o=l.a.getViewportDimensions().height-n;if(o<r&&(t=o<s?s:o),t)return{top:n,height:t-=a}}},{key:"_getScrollTopByElement",value:function _getScrollTopByElement(t,e){if(!t||!e)return 0;var i=t.getBoundingClientRect(),n=i.top+i.height-e.top-e.height;return n>0?n:0}}]),DropdownMenu}(s.a.Component),y=function(t){_inherits(Dropdown,t);var e=_createSuper(Dropdown);function Dropdown(t){var i;_classCallCheck(this,Dropdown),_defineProperty(_assertThisInitialized(i=e.call(this,t)),"toggle",(function(){var t=i.state.isOpen,e=!t,n=t&&!e;i.setState({isOpen:e,focusToSelectedOption:!0,timeOfLastToggle:Date.now()}),n&&i.buttonEl.focus()})),_defineProperty(_assertThisInitialized(i),"open",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{focusToSelectedOption:!0};i.setState({isOpen:!0,focusToSelectedOption:t.focusToSelectedOption})})),_defineProperty(_assertThisInitialized(i),"close",(function(){i.setState({isOpen:!1})})),_defineProperty(_assertThisInitialized(i),"setSelectedIndex",(function(t){i.state.selectedIndex!==t?i.setState({selectedIndex:t,isOpen:!1}):i.close()})),_defineProperty(_assertThisInitialized(i),"_onDropdownRequestToClose",(function(t){i.close(),t&&i.buttonEl.focus()})),_defineProperty(_assertThisInitialized(i),"_onDropdownOptionChange",(function(t){var e=i.props,n=e.menuOptions,r=e.onChange;i.setSelectedIndex(t),i.buttonEl.focus(),r&&r({index:t,value:n[t].value})})),_defineProperty(_assertThisInitialized(i),"_onKeyDown",(function(t){var e=t.keyCode;(i.props.toggleButton||{}).disableArrowKey||(e===p||e===d?(t.preventDefault(),i.open()):e===m&&t.shiftKey&&i._onDropdownRequestToClose())})),_defineProperty(_assertThisInitialized(i),"_onBlur",(function(){var t=i.props.onBlur;r.a.isFunction(t)&&!i.isOpen()&&i.buttonEl!==document.activeElement&&t()}));var n=t.selectedIndex,a=t.scaleToFit,s=t.isDisabled,o=t.useViewport;return i.useViewport=!!r.a.isUndefined(o)||o,i.state={scaleToFit:a,selectedIndex:r.a.isNumber(n)?n:-1,isOpen:!1,isDisabled:s,labelStyle:null,timeOfLastToggle:0},i}return _createClass(Dropdown,[{key:"componentDidMount",value:function componentDidMount(){this.state.scaleToFit&&this._updateSelectedLabel()}},{key:"componentDidUpdate",value:function componentDidUpdate(t,e){var i=this.props,n=i.updateComplete,a=i.renderMain,s=this.state,o=s.selectedIndex,l=s.scaleToFit;e.selectedIndex!==o?(r.a.isFunction(n)&&n(),r.a.isFunction(a)&&a(o),l&&this._updateSelectedLabel()):o!==this.props.selectedIndex&&r.a.isNumber(this.props.selectedIndex)&&this.setState({selectedIndex:this.props.selectedIndex})}},{key:"render",value:function render(){var t=this,e=this.state,i=e.selectedIndex,n=e.isOpen,a=e.isDisabled,o=e.focusToSelectedOption,l=e.timeOfLastToggle,c=this.props,u=c.ariaDescription,p=c.ariaSelected,d=c.menuOptions,f=c.popupClassName,m=c.containerClass,g=c.renderMain,y=c.renderOption,v=c.title,w=c.isTabbable,x=this._getSelectedOption().title||v,E=Object(h.a)(p,{title:x}),k=r.a.isFunction(g)?g(this.state.selectedIndex):this._getMainButtonContent(),T=["lrn_btn","lrn_dropdown_toggle",a?"lrn_disabled":""].join(" "),O=["lrn_dropdown",m||"",n?"lrn_open":""].join(" ");return s.a.createElement("div",{className:O},s.a.createElement("button",{"aria-label":E,title:v,"aria-roledescription":u,className:T,type:"button",onClick:a?void 0:this.toggle,onKeyDown:a?void 0:this._onKeyDown,onBlur:a?void 0:this._onBlur,ref:function ref(e){return t.buttonEl=e}},k,s.a.createElement("span",{className:"lrn_caret lrn_caret_right"})),s.a.createElement(b,{menuOptions:d,className:f,selectedIndex:i,isOpen:n,timeOfLastToggle:l,isTabbable:w,focusToSelectedOption:o,useViewport:this.useViewport,onChange:this._onDropdownOptionChange,onRequestClose:this._onDropdownRequestToClose,renderOption:y}))}},{key:"isOpen",value:function isOpen(){return this.state.isOpen}},{key:"_getMainButtonContent",value:function _getMainButtonContent(){var t=this,e=this.state.labelStyle,i=this._getSelectedOption(),n=i.label,r=i.value;return s.a.createElement("span",{ref:function ref(e){return t.buttonLabelEl=e},className:"lrn_content",style:e,dangerouslySetInnerHTML:{__html:getLabelContent(n,r)}})}},{key:"_getSelectedOption",value:function _getSelectedOption(){var t=this.state.selectedIndex,e=this.props.menuOptions;return e&&e.length>t&&t>=0?e[t]:{title:"",label:""}}},{key:"_updateSelectedLabel",value:function _updateSelectedLabel(){var t=this.buttonEl,e=this.buttonLabelEl;if(t&&e){var i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.height-i.height,a=null;if(r>0){var s=1-r/n.height;a={transform:"scale(".concat(s,")"),transformOrigin:"left top"}}a!==this.state.labelStyle&&this.setState({labelStyle:a})}}}]),Dropdown}(s.a.Component)},163:function(t,e,i){"use strict";var n=i(1),r=i.n(n),a=i(5),s=i.n(a),o=i(0),l=i.n(o),c=i(63),u=i.n(c),h=i(139),p=i(148),d=i(4),f=i(7),m=i.n(f),g=i(51),b=i(131),y=i(24),v=i(166),w=i.n(v),x=i(183),E={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",191:"/",220:"\\",8:"Backspace",32:"Spacebar",13:"Enter",9:"Tab",37:"Left",38:"Up",39:"Right",40:"Down",16:"Shift"},k=[0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],T=h.a.ctrlShortcuts,O=h.a.getShortcutsMap();e.a=s.a.View.extend({MAX_MATH_DEPTH:40,events:{"keypress span.lrn_math_editable":"keyPress","keyup span.lrn_math_editable":"keyUp","keydown span.lrn_math_editable":"keyDown","click span.lrn_math_editable":"editorPressed","touchstart span.lrn_math_editable":"editorPressed","cut .lrn_focusable":"updateModel","paste .lrn_focusable":"updateModel","focus .lrn_focusable":"onFocus","blur .lrn_focusable":"onBlur"},mathEvents:void 0,shortcutKeyTime:500,shiftIsPressed:!1,template:w.a,initialize:function initialize(){this.keys="",u.a.config({autoCommands:"lim"}),this.mathEvents=new p.a,this.addRenderingLogic(),this.displayLogic.isReadOnly&&(this.events={}),this.render(),this.bindHandwritingEvents(),this.listenTo(this.mathEvents,this.mathEvents.EVENT.MATH_COMMAND,this.enterMath,this),this.listenTo(this.mathEvents,this.mathEvents.EVENT.ESCAPE_UI,this.refocusEditor,this),this.listenTo(this.mathEvents,this.mathEvents.EVENT.ESCAPE_UI_WITHOUT_KEYBOARD,this.refocusEditorWithoutKeyboard,this),this.displayLogic.templateAriaLabel||(this.$logger=this.$('[data-lrn-component="logger"]'),this.dynamicAriaLabel=l.a.debounce(this.dynamicAriaLabel.bind(this),300),this.listenTo(this.mathEvents,this.mathEvents.EVENT.UPDATED,this.dynamicAriaLabel,this)),this.listenTo(this.mathEvents,this.mathEvents.EVENT.EXTERNAL_KEY,(function(t,e){var i=r.a.Event(t.type,l.a.pick(t,"type","keyCode","metaKey","shiftKey","altKey","which"));this.$("span.lrn_math_editable").trigger(i)}),this),this.listenTo(this.mathEvents,this.mathEvents.EVENT.WRITE_LATEX,this.clearAndWrite),this.listenTo(this.mathEvents,this.mathEvents.EVENT.CHANGE_DISABLED_STATE,(function(t){this.options.disableInput!==t&&(this.options.disableInput=t,this.addRenderingLogic(),this.render())}),this)},addRenderingLogic:function addRenderingLogic(){this.displayLogic={},this.displayLogic.isReadOnly=this.options.readOnly,this.displayLogic.disableInput=this.options.disableInput,this.displayLogic.hasOwnBorder=this.options.clozeBordering&&(this.options.readOnly||!this.hasEditableAreas()),this.displayLogic.templateAriaLabel=this.options.templateAriaLabel},bindHandwritingEvents:function bindHandwritingEvents(){var t,e=this.mathEvents,i=this.$("span.lrn_math_editable"),n=i.attr("title")||"";function resetState(){i.removeClass("lrn-state-outdated lrn-state-awaiting-update lrn-state-error").attr("title",n)}this.listenTo(e,e.EVENT.CONTENT_OUTDATED,(function(){resetState(),i.addClass("lrn-state-outdated")})),this.listenTo(e,e.EVENT.AWAIT_UPDATE,(function(){resetState(),i.addClass("lrn-state-awaiting-update")})),this.listenTo(e,e.EVENT.SET_ERROR,(function(e){resetState(),i.addClass("lrn-state-error").attr("title",e),clearTimeout(t),t=setTimeout(resetState,5e3)})),this.listenTo(e,e.EVENT.GET_ACTIVE_ID,(function(t){var e=r()(document.activeElement).filter(".lrn_focusable");t((e.length?e:this.$(".lrn_focusable")).prop("id"))})),this.listenTo(e,e.EVENT.RESET_STATE,resetState)},bindTextareaListeners:function bindTextareaListeners(t){var e=this.mathEvents,i=this,n=t[0],r=n.value;this.textareas=this.textareas||[],this.textareas.push(t),t.on("input.lrn.formulaeditor",(function(t){var a=i.getMathCommand(r,n.value);a&&(a.unshift(e.EVENT.MATH_COMMAND),e.trigger.apply(e,a)),r=n.value})),t.on("keyup.lrn.formulaeditor",(function(t){var e=i.mathquill.latex();0===n.value.length&&e.length&&(n.value="a",n.selectionStart=0,n.selectionEnd="a".length,r=n.value)})),t.on("paste.lrn.formulaeditor",(function(){i.removeTextareas()}))},clearAndWrite:function clearAndWrite(t){t=this.convertDynamicVarsForMathquill(t),this.mathquill.clear().write(t),this.updateModel()},editorPressed:function editorPressed(t){this.mathEvents.trigger(this.mathEvents.EVENT.EDITOR_PRESSED)},enterMath:function enterMath(t,e,i){var n=u()(this.getMqEl()),r=i&&i.get("extra_commands");window.clearTimeout(this.shortcutKeyTimeout),this.keys="",l.a.isFunction(n[t])&&(n[t](e),l.a.each(r||[],(function(t){l.a.isFunction(n[t.type])&&n[t.type](t.val)})),this.updateModel())},getMathCommand:function getMathCommand(t,e){return e.length===t.length+1&&0===e.indexOf(t)?["typedText",e[e.length-1]]:e.length===t.length-1?["keystroke","Backspace"]:void 0},getMqEl:function getMqEl(){return this.$("span.lrn_math_editable")[0]},getValue:function getValue(){var t=this.displayLogic.isReadOnly,e=this.currentEditables||this.options.editables||[],i=this.options.template,n=this.currentValue||this.options.value||i||"";return this.hasEditableAreas()&&(e=l.a.clone(e),n=i.replace(/{{response}}/g,(function(){var i=e.shift()||"";return t&&i.length?" "+i:"\\MathQuillMathField{"+i+"}"}))),n=this.convertDynamicVarsForMathquill(n)},handlePipeSymbol:function handlePipeSymbol(){this.mathEvents.trigger(this.mathEvents.EVENT.MATH_COMMAND,"cmd","\\abs")},addMathQuillVarField:function addMathQuillVarField(t){var e="\\MathQuillVarField{\\text{"+t+"}}";this.mathquill.write(e),this.updateModel()},hasEditableAreas:function hasEditableAreas(){var t=this.options.template;return l.a.isString(t)&&t.length>0&&t.indexOf("{{response}}")>-1},keyDown:function keyDown(t){var e,i=E[t.keyCode],n=this.mathEvents;if(t.shiftKey&&t.altKey)return!1;if(i&&i.length>1){if(t.shiftKey&&"Shift"!==i?i="Shift-"+i:"Spacebar"===i&&(i="space"),"Tab"===i&&(e=b.b.getNextTab(document.activeElement,["MathJax","lrn_dropdown_toggle"]))&&(e.originalEvent=t,n.trigger(n.EVENT.TAB_EDITOR,e)),"Shift"===i){if(this.shiftIsPressed)return;n.trigger(n.EVENT.SHIFT_KEY),this.shiftIsPressed=!0}n.trigger(n.EVENT.MATH_COMMAND,"no-input",i)}this.updateModel()},keyPress:function keyPress(t){var e=t.which||t.keyCode,i=t.key||String.fromCharCode(e),n=this.mathEvents,r=t.metaKey||t.ctrlKey;this.removeTextareas();var a="\\"===i&&!this.options.enableRawLatex;return!l.a.contains(k,e)&&("*"===i&&(i="×"),"$"===i?(n.trigger(n.EVENT.MATH_COMMAND,"write","\\$"),!1):"|"===i?(this.handlePipeSymbol(),!1):a?(this.preventRawLatexBeingEntered(),!1):(i=i.replace("\t",""),r||1!==i.length?void 0:(b.b.capsLock.correctStatus(t),n.trigger(n.EVENT.MATH_COMMAND,"typedText",i),!1)))},keyUp:function keyUp(t){var e=this.mathEvents,i=E[t.keyCode];if(t.altKey&&t.shiftKey&&i&&(this.keys=this.keys+i,window.clearTimeout(this.shortcutKeyTimeout),window.clearTimeout(this.resetKeyTimeout),!function noOtherShortcutBeginsWith(t){return!l.a.find(l.a.keys(O),(function(e){return e!==t&&0===e.indexOf(t)}))}(this.keys)?this.setShortcutKeyTimeout():this.sendShortcut()),t.ctrlKey&&i){var n=l.a.findWhere(T,{shortcut:i});n&&e.trigger(e.EVENT.MATH_COMMAND,n.type,n.val)}t.shiftKey||"Shift"!==i||(e.trigger(e.EVENT.SHIFT_KEY),this.shiftIsPressed=!1)},getAriaLabel:function getAriaLabel(){return this.options.response_container&&this.options.response_container.aria_label?this.options.response_container.aria_label:this.options.aria_label?this.options.aria_label:this.options.i18n.labels.responseArea},mathquillify:function mathquillify(){var t,e=this.currentValue,i=this.displayLogic.isReadOnly,n=this.displayLogic.disableInput,a=e.indexOf("\\MathQuillMathField")<0,s=e.indexOf("\\MathQuillMathField{}")>-1,o=g.a.isTouchDevice(),c=this.options.showInputUi,h=l.a.uniq(this.options.text_blocks||[]),p=this.options.persistent_id||"",f=0,m=this,b=this.getAriaLabel();this.mathquill&&(this.mathEvents.trigger(this.mathEvents.EVENT.EDITOR_BLURRED),this.mathquill.revert()),i||n?(this.mathquill=u.a.InertMath(this.getMqEl(),{disableItalics:this.options.disableItalics,maxDepth:this.MAX_MATH_DEPTH}),this.displayLogic.templateAriaLabel||(this.$('[data-lrn-component="logger"]').removeAttr("aria-live").removeAttr("aria-hidden"),this.dynamicAriaLabel())):(this.mathquill=u.a[a?"MathField":"StaticMathWithEditables"](this.getMqEl(),{handlers:{},substituteTextarea:function substituteTextarea(){var t=o&&c?"span":"textarea",e=r()("<"+t+">").attr({tabindex:"0",class:"lrn_focusable",id:"focusable"+f+++p});if("textarea"===t&&(e.attr({"aria-label":b,autocomplete:"off",autocapitalize:"none"}),m.bindTextareaListeners(e)),e.length>0)return e[0]},unItalicizedTextCmds:h,disableItalics:this.options.disableItalics,maxDepth:this.MAX_MATH_DEPTH}),this.$(".lrn_focusable").eq(0).attr("tabindex","0"));try{this.mathquill.latex(e)}catch(e){t=!0}i||n||!(e.length>0)||""!==this.mathquill.latex()||!a&&s||(t=!0),t&&d.a.exception({code:10023,detail:e}),a||(this.$(".mq-inner-editable").addClass("lrn_bordered_mathinput"),this.$(".mq-selectable").attr("aria-hidden",!0)),this.$("span[mathquill-command-id]").each((function(t,e){var i=r()(e);!i.hasClass("mq-non-leaf")&&!i.hasClass("mq-editable-field")&&i.attr("aria-hidden",!0)})),this.$(".mq-sqrt-prefix, var, .mq-paren").attr("aria-hidden",!0),this.setResponseSizing()},onAttach:function onAttach(){var t=this;Object(y.a)(this.$el,(function(){t.mathquill.reflow()}))},onBlur:function onBlur(t){this.onFocusChange(t),this.mathEvents.trigger(this.mathEvents.EVENT.ITEM_BLURRED)},onFocus:function onFocus(t){this.preventEditorFocus||(this.onFocusChange(t),this.mathEvents.trigger(this.mathEvents.EVENT.EDITOR_FOCUSED)),this.preventEditorFocus=!1},onFocusChange:function onFocusChange(t){var e="focusin"===t.type;r()(t.currentTarget).closest(".lrn_bordered_mathinput").toggleClass("lrn_focused",e),m.a.isAppleWebKit&&m.a.isMobile&&b.b.toggleBackgroundClickable(e)},preventRawLatexBeingEntered:function preventRawLatexBeingEntered(){this.mathEvents.trigger(this.mathEvents.EVENT.MATH_COMMAND,"cmd","\\backslash")},refocusEditor:function refocusEditor(){this.$(".mq-textarea .lrn_focusable").filter('[tabindex="0"]').eq(0).trigger("focus")},refocusEditorWithoutKeyboard:function refocusEditorWithoutKeyboard(){this.preventEditorFocus=!0,this.$(".mq-textarea .lrn_focusable").filter('[tabindex="0"]').eq(0).trigger("focus")},remove:function remove(){var t=this.$(".lrn_focusable").map((function(){return r()(this).prop("id")})).get();return this.removeTextareas(),s.a.View.prototype.remove.call(this),this.mathEvents.trigger(this.mathEvents.EVENT.EDITOR_REMOVED,t),this},removeTextareas:function removeTextareas(){this.textareas&&(l()(this.textareas).each((function(t){t.off(".lrn.formulaeditor")})),delete this.textareas)},render:function render(){return this.currentValue=this.getValue(),this.$el.html(this.template({displayLogic:this.displayLogic})),this.mathquillify(),r.a.contains(document,this.el)&&this.onAttach(),this},sendShortcut:function sendShortcut(){var t=O[this.keys],e=this.mathEvents;return!(!t||!e.trigger(e.EVENT.MATH_COMMAND,t.get("type"),t.get("val"),t))},setResponseSizing:function setResponseSizing(){var t=this.options.response_container,e=this.options.response_containers,i=this.hasEditableAreas(),n=this;function resizeBlock(t,e){var i=!1;e&&e.width&&(t.css("min-width",e.width),i=!0),e&&e.height&&(t.css("min-height",e.height),i=!0),i&&(t.css("display","inline-block"),n.mathquill.reflow())}!i||!t||e&&e.length||(e=[t]),i&&l.a.isArray(e)?this.$(".mq-inner-editable .mq-root-block").each((function(i){var n=e[i]||t;resizeBlock(r()(this),n)})):t&&(resizeBlock(this.$el,t),t.height&&r()(this.getMqEl()).css("min-height",t.height))},setShortcutKeyTimeout:function setShortcutKeyTimeout(){var t=this;this.shortcutKeyTimeout=window.setTimeout((function(){t.sendShortcut()||(t.resetKeyTimeout=window.setTimeout((function(){t.keys=""}),3*t.shortcutKeyTime))}),this.shortcutKeyTime)},updateModel:function updateModel(){var t="ie"===m.a.browser&&m.a.version<=8?50:0,e=this;l.a.delay((function(){var t=u()(e.getMqEl()),i=e.convertDynamicVarsFromMathquill(t.latex()),n=t.editables&&t.editables()||[];e.currentValue!==i&&(e.currentValue=i,e.currentEditables=n.map((function(t){return e.convertDynamicVarsFromMathquill(t.latex)})),e.mathEvents.trigger(e.mathEvents.EVENT.UPDATED,i,e.currentEditables))}),t)},dynamicAriaLabel:function dynamicAriaLabel(){var t=this;if(!this.options.disableSpokenmathUserInputs){var e=this.getValue();x.a.process(e).then((function(e){t.$logger.text(e),t.mathEvents.trigger(t.mathEvents.EVENT.EDITOR_SPOKENMATH_UPDATED,e)}))}},convertDynamicVarsForMathquill:function convertDynamicVarsForMathquill(t){return t.replace(/{{var:([a-z0-9 _]+)}}/gi,"\\MathQuillVarField{\\text{$1}}")},convertDynamicVarsFromMathquill:function convertDynamicVarsFromMathquill(t){return t.replace(/\{\{var:\\text\{([^\}]*)\}{3}/gi,"{{var:$1}}")}})},164:function(t,e,i){"use strict";var n=i(1),r=i.n(n),a=i(63),s=i.n(a),o=i(0),l=i.n(o),c=i(5),u=i.n(c),h=i(139),p=i(167),d=i.n(p),f=i(168),m=i.n(f),g=i(169),b=i.n(g),y=i(170),v=i.n(y),w=i(51),x=i(24),E=i(6),k=u.a.View.extend({CLASSNAMES:{TOOLBAR:".lrn_toolbar",CANVAS_WRAPPER:".lrn_canvas_drawing",LINE_COLOUR_PALETTE:".lrn_line_colour_palette",LINE_COLOUR_PALETTE_TRIGGER:".lrn_line_colour_palette_trigger",LINE_COLOUR_SELECTOR:".lrn_btn_color_selector",CANVAS:".lrn_canvas"},DATA_SELECTOR:{LINE_COLOUR_DATA_SELECTION:"data-colour-selection"},DEFAULT_CANVAS_WIDTH:300,DEFAULT_CANVAS_HEIGHT:150,EVENT:{SHOWN:"shown",UPDATED:"updated",LOAD_ERROR:"load-error",LOADED:"loaded",STROKE_BEGIN:"stroke-begin",RESET:"reset"},MARK_TYPES:{GESTURE:"gesture",CLEAR:"clear"},MAX_LINE_COLOUR_NUMBER:6,TOOLBAR_OPTIMISED_WIDTH:300,bgImg:null,bgLoaded:!1,bgImgScale:1,canPaint:!1,events:{"mousedown canvas.lrn_canvas.lrn_paintable":"startPainting","mousemove canvas.lrn_canvas.lrn_paintable":"paintToHere","mouseleave canvas.lrn_canvas.lrn_paintable":"stopPainting","mouseup canvas.lrn_canvas.lrn_paintable":"stopPainting","mousedown .lrn_old_ie canvas.lrn_canvas":"ie8PreventBlurEvent","mousedown .lrn_old_ie .lrn_btn":"ie8PreventBlurEvent","mousedown .lrn_btn_color_selector":"setSelectedLineColour","mousedown .lrn_line_colour_palette_trigger":"toggleLineColourPalette","keydown .lrn_canvas":"buttonKeyDownOnCanvas","keydown .lrn_keyboard_paintable":"buttonKeyDown","keyup .lrn_keyboard_paintable":"buttonKeyUp","blur .lrn_keyboard_paintable":"destroyDrawingIndicator","focus .lrn_keyboard_paintable":"addMarker"},KEYCODES:{TAB:9,LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ENTER:13},initTime:null,isPainting:!1,lastDrawnPoint:{x:null,y:null},redrawQueue:[],markRedrawQueue:[],template:b.a,touchEvents:{"touchend .lrn_clear:not(.lrn_disabled)":"clearAll","touchend .lrn_replay:not(.lrn_disabled)":"replay","touchend .lrn_undo:not(.lrn_disabled)":"undo","touchend .lrn_redo:not(.lrn_disabled)":"redo","touchend .lrn_btn_color_selector":"setSelectedLineColour","touchend .lrn_line_colour_palette_trigger":"toggleLineColourPalette","touchstart canvas.lrn_canvas.lrn_paintable":"startPainting","touchmove canvas.lrn_canvas.lrn_paintable":"paintToHere","touchleave canvas.lrn_canvas.lrn_paintable":"stopPainting","touchend canvas.lrn_canvas.lrn_paintable":"stopPainting"},keysPressed:{},pixelMoveDistance:3,initialize:function initialize(){var t=this.options.$externalContainer,e={"click .lrn_clear:not(.lrn_disabled)":"clearAll","click .lrn_replay:not(.lrn_disabled)":"replay","click .lrn_undo:not(.lrn_disabled)":"undo","click .lrn_redo:not(.lrn_disabled)":"redo"};this.hasFlashCanvas()&&v.a.setPath(E.a.assetsHost+"/swf/"),w.a.isTouchDevice()?(this.events=l.a.extend({},this.events,this.touchEvents),w.a.isMobile||l.a.extend(this.events,e)):this.events=l.a.extend(e,this.events),this.$container=t&&t.length?t:this.$el,this.$toolbar=this.$(this.CLASSNAMES.TOOLBAR),this.i18n=this.options.i18n,this.initTime=(new Date).getTime(),this.setDrawingOptions(),this.canPaint=this.options.canPaint,this.showRedraw=this.options.showRedraw,this.animateRedraw=!this.canPaint,this.canvasWidth=this.options.imgWidth?this.options.imgWidth:this.DEFAULT_CANVAS_WIDTH,this.canvasHeight=this.options.imgHeight?this.options.imgHeight:this.DEFAULT_CANVAS_HEIGHT,this.imageAlt=this.options.imgAlt||"",this.render(),this.setState({buffer:this.options.marks||[]}),this.imgSrc=this.options.imgSrc,this.bgImg=new Image,this.hasBgImg()?r()(this.bgImg).on("load",this.bgImageLoaded.bind(this)).on("error",this.bgImageLoadError.bind(this)).attr("src",this.imgSrc):(this.once(this.EVENT.SHOWN,(function(){this.setCanvasSize(this.canvasHeight,this.canvasWidth),this.makeResponsive()}),this),l.a.delay(l.a.bind((function(){this.trigger(this.EVENT.LOADED),this.trigger(this.EVENT.SHOWN)}),this))),this.on(this.EVENT.RESET,this.setState,this),r()(window).on("resize orientationchange",l.a.debounce(l.a.bind(this.makeResponsive,this),400))},addCurrentMarkToBuffer:function addCurrentMarkToBuffer(){var t=this.state;t.buffer=t.buffer.slice(0,t.position+1),t.buffer.push(this.currentMark),t.bufferToRender=t.bufferToRender.slice(0,t.position+1),t.bufferToRender.push(this.getPointToRender(this.currentMark)),t.position=t.buffer.length-1},bgImageLoaded:function bgImageLoaded(){this.options.imgWidth||(this.canvasWidth=this.bgImg.width),this.options.imgHeight||(this.canvasHeight=this.bgImg.height),this.bgLoaded=!0,this.makeResponsive(),this.trigger(this.EVENT.LOADED)},bgImageLoadError:function bgImageLoadError(){this.trigger(this.EVENT.LOAD_ERROR)},makeResponsive:function makeResponsive(){Object(x.a)(this.$container,l.a.bind(this.fitCanvasToContainer,this))},fitCanvasToContainer:function fitCanvasToContainer(){var t=this.canvasWidth,e=this.canvasHeight,i=t/e,n=this.$container.innerWidth();n&&t>n&&(e=(t=n)/i),this.bgImgScale=this.bgImg.width?t/this.bgImg.width:t/this.canvasWidth,this.setCanvasSize(e,t),this.$(this.CLASSNAMES.CANVAS_WRAPPER).width(t),this.$toolbar.width()<=this.TOOLBAR_OPTIMISED_WIDTH&&this.$toolbar.addClass("lrn_toolbar_optimised"),this.hasFlashCanvas()?r()(this.cnv).css("background-image","url("+this.imgSrc+")"):this.imgSrc&&this.ctx.drawImage(this.bgImg,0,0,t,e),this.setBufferToRender(),this.redraw(!1)},setBufferToRender:function setBufferToRender(){var t=this,e=this.bgImgScale;this.state.bufferToRender=l.a.map(this.state.buffer,(function(i){return i.points?l.a.extend({},i,{points:l.a.map(i.points,(function(n){return t.getPointToRender(n,i.bgImgScale,e)}))}):i}))},getPointToRender:function getPointToRender(t,e,i){return e=e||1,i=i||1,l.a.extend({},t,{x:t.x/e*i,y:t.y/e*i})},clearAll:function clearAll(){this.currentMark={type:this.MARK_TYPES.CLEAR,startTime:(new Date).getTime()-this.initTime},this.resetBackground(),this.addCurrentMarkToBuffer(),this.update()},expandCanvasToContainer:function expandCanvasToContainer(){this.setCanvasSize(this.$el.height(),this.$el.width())},getEventPoint:function getEventPoint(t){var e=this,i=this.scale||1,n=function getMousePoint(t){var n=t.offsetX?t.offsetX:Math.round(t.pageX-e.$el.find(".lrn_canvas").offset().left),r=t.offsetY?t.offsetY:Math.round(t.pageY-e.$el.find(".lrn_canvas").offset().top);return{x:n/i,y:r/i}};return t.type.indexOf("mouse")>-1?n(t):t.type.indexOf("touch")>-1?function getTouchPoint(t){var n=t.originalEvent.touches[0],a=r()(e.cnv).offset(),s=n.pageX-a.left,o=n.pageY-a.top;return{x:s/i,y:o/i}}(t):t.type.indexOf("keydown")>-1&&n(t)},getVisibleMarks:function getVisibleMarks(t){for(var e=this.state.buffer,i=0,n=t?"buffer":"bufferToRender",r=this.state.position;r>-1;r--)if(e[r].type===this.MARK_TYPES.CLEAR){i=r+1;break}return this.state[n].slice(i,this.state.position+1)},hasBgImg:function hasBgImg(){return!(!this.imgSrc||!this.imgSrc.length)},ie8PreventBlurEvent:function ie8PreventBlurEvent(){var t=document.activeElement;l.a.defer((function(){r()(t).focus()}))},paintDot:function paintDot(t,e){this.ctx.fillStyle=e||this.selectedLineColour,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,this.options.line_width,0,2*Math.PI),this.ctx.fill(),this.lastDrawnPoint=t},paintLine:function paintLine(t,e,i){this.ctx.strokeStyle=i||this.selectedLineColour,this.ctx.lineJoin=this.options.line_join,this.ctx.lineWidth=this.options.line_width,this.ctx.lineCap=this.options.line_cap,this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke(),this.lastDrawnPoint=e},paintToHere:function paintToHere(t){var e,i;if(!this.isPainting)return!1;this.isKeypadMoving&&this.getCursorCoordinates(t),e=this.getEventPoint(t),i=null!==this.lastDrawnPoint.x?this.lastDrawnPoint:e,this.paintLine(i,e),this.currentMark.points.push(this.lastDrawnPoint),t.preventDefault()},redo:function redo(){this.state.position++,this.update(),this.redraw(!0)},redraw:function redraw(t){var e,i,n,r=!!l.a.isUndefined(t)||t,a=this.animateRedraw,s=0,o=this.getVisibleMarks(),c=this;if(r&&this.resetBackground(),!o.length)return!1;e=function drawCurrentLine(t,e){a&&c.redrawQueue.shift();var i=t.points[e],n=e>0?e-1:0,r=t.points[n];1===t.points.length?c.paintDot(i,t.line_colour):c.paintLine(r,i,t.line_colour)},i=function drawCurrentMark(t){var i,n=(t.endTime-t.startTime)/t.points.length;l.a.each(t.points,(function(r,s){a?(i=l.a.delay(l.a.bind(e,c),n*s,t,s),c.redrawQueue.push(i)):e(t,s)})),c.ctx.closePath()},l.a.each(o,(function(t){switch(t.type){case this.MARK_TYPES.GESTURE:a?(n=l.a.delay(l.a.bind(i,this),s,t),s+=t.endTime-t.startTime,c.markRedrawQueue.push(n)):i(t);break;case this.MARK_TYPES.CLEAR:this.resetBackground();break;default:throw new Error("Unsupported mark type ",t.type)}}),this),this.animateRedraw=!1},render:function render(){return this.$el.html(this.template({displayLogic:l.a.pick(this,"canPaint","showRedraw","imageAlt"),lineColourData:{colours:this.options.line_colour,limit:this.MAX_LINE_COLOUR_NUMBER},labels:this.i18n.labels})),this.cnv=this.$("canvas.lrn_canvas")[0],this.hasFlashCanvas()&&(this.$(".lrn_canvas_drawing").addClass("lrn_old_ie"),v.a.initElement(this.cnv)),this.ctx=this.cnv.getContext("2d"),this},resetBackground:function resetBackground(){this.ctx.clearRect(0,0,this.cnv.width,this.cnv.height),this.bgLoaded&&!this.hasFlashCanvas()&&this.ctx.drawImage(this.bgImg,0,0,this.cnv.width,this.cnv.height),l.a.each(this.redrawQueue,clearTimeout),l.a.each(this.markRedrawQueue,clearTimeout)},setCanvasSize:function setCanvasSize(t,e){r()(this.cnv).height(t).width(e).attr("height",t+"px").attr("width",e+"px"),this.hasFlashCanvas()&&this.ctx._resize(e,t)},setDisabled:function setDisabled(t){t?this.undelegateEvents():this.delegateEvents()},setDrawingOptions:function setDrawingOptions(){var t=this.options,e={line_colour:"#c92e32",line_join:"round",line_width:5,line_cap:"round"};t.line_color&&(t.line_colour=t.line_color),l.a.isArray(t.line_colour)?this.selectedLineColour=t.line_colour[0]:l.a.isString(t.line_colour)?this.selectedLineColour=t.line_colour:this.selectedLineColour=e.line_colour;var i=this;l.a.each(e,(function(e,n){i.options[n]=t.hasOwnProperty(n)?t[n]:e}))},setSelectedLineColour:function setSelectedLineColour(t){var e=r()(t.currentTarget);e&&e.length&&(r()(".lrn_btn_color_selector").removeClass("lrn_selected"),e.addClass("lrn_selected"),this.selectedLineColour=e.attr(this.DATA_SELECTOR.LINE_COLOUR_DATA_SELECTION),this.$(this.CLASSNAMES.LINE_COLOUR_PALETTE_TRIGGER).find("span").css("background",this.selectedLineColour),this.$(this.CLASSNAMES.LINE_COLOUR_PALETTE).removeClass("lrn_active")),t.preventDefault()},setState:function setState(t){t.buffer=t.buffer||[],t.bufferToRender=t.bufferToRender||[],t.position=l.a.isNumber(t.position)?t.position:t.buffer.length-1,this.state=t,this.redraw(!0),this.updateButtonStates()},getCursorCoordinates:function getCursorCoordinates(t){return t.offsetX=Math.round(this.$indicator.offset().left-this.$canvas.offset().left),t.offsetY=Math.round(this.$indicator.offset().top-this.$canvas.offset().top),t.pageX=Math.round(this.$indicator.offset().left),t.pageY=Math.round(this.$indicator.offset().top),t},startPainting:function startPainting(t){this.isPainting=!0,this.hasActiveDrawingIndicator()&&this.getCursorCoordinates(t),this.lastDrawnPoint=this.getEventPoint(t),this.currentMark={type:this.MARK_TYPES.GESTURE,line_colour:this.selectedLineColour,line_join:this.options.line_join,line_width:this.options.line_width,startTime:(new Date).getTime()-this.initTime,points:[],bgImgScale:this.bgImgScale},this.currentMark.points.push(this.lastDrawnPoint),this.trigger(this.EVENT.STROKE_BEGIN),t.preventDefault()},stopPainting:function stopPainting(t){this.isPainting&&(1===this.currentMark.points.length&&this.paintDot(this.currentMark.points[0]),this.ctx.closePath(),this.isPainting=!1,this.currentMark.endTime=(new Date).getTime()-this.initTime,this.addCurrentMarkToBuffer(),this.update()),t.preventDefault()},toggleLineColourPalette:function toggleLineColourPalette(t){this.$(this.CLASSNAMES.LINE_COLOUR_PALETTE).toggleClass("lrn_active"),t.preventDefault()},undo:function undo(){this.state.position--,this.update(),this.redraw(!0)},update:function update(){var t=this.getVisibleMarks(!0);this.trigger(this.EVENT.UPDATED,t,this.state),this.updateButtonStates(),this.$(this.CLASSNAMES.LINE_COLOUR_PALETTE).removeClass("lrn_active")},updateButtonStates:function updateButtonStates(){var t=this.state.position>-1,e=this.state.buffer.length>this.state.position+1,i=this.getVisibleMarks(!0).length>0;this.$(".lrn_undo").toggleClass("lrn_disabled",!t),this.$(".lrn_redo").toggleClass("lrn_disabled",!e),this.$(".lrn_clear").toggleClass("lrn_disabled",!i)},replay:function replay(){this.animateRedraw=!0,this.redraw(!0)},buttonKeyDown:function buttonKeyDown(t){switch(t.keyCode){case this.KEYCODES.LEFT:case this.KEYCODES.UP:case this.KEYCODES.RIGHT:case this.KEYCODES.DOWN:t.preventDefault(),this.isKeypadMoving=!0,this.moveIndicator(t),this.paintToHere(t);break;case this.KEYCODES.SPACE:case this.KEYCODES.ENTER:this.startPainting(t),this.isKeypadMoving&&(this.moveIndicator(t),this.paintToHere(t))}},buttonKeyUp:function buttonKeyUp(t){switch(t.keyCode){case this.KEYCODES.LEFT:case this.KEYCODES.UP:case this.KEYCODES.RIGHT:case this.KEYCODES.DOWN:this.isKeypadMoving=!1,this.stopMovingIndicator(t);break;case this.KEYCODES.SPACE:case this.KEYCODES.ENTER:this.isKeypadMoving=!1,this.stopPainting(t)}},buttonKeyDownOnCanvas:function buttonKeyDownOnCanvas(t){switch(t.keyCode){case this.KEYCODES.TAB:this.createKeyboardDrawingCursor(t)}},calculateNewPointCoordinates:function calculateNewPointCoordinates(t,e,i,n){var r=this.keysPressed[e]?this.pixelMoveDistance:0,a=this.keysPressed[i]?this.pixelMoveDistance:0,s=parseInt(t,10)-r+a;return this.getBoundedCursorCoordinate(s,n)},getBoundedCursorCoordinate:function getBoundedCursorCoordinate(t,e){var i=e?this.$canvas.position().left+this.$canvas.innerWidth():this.$canvas.position().top+this.$canvas.innerHeight(),n=e?this.$canvas.position().left:this.$canvas.position().top;return t<n?n:t>i?i:t},moveIndicator:function moveIndicator(t){var e=this;this.keysPressed[t.which]=!0,this.$indicator.css({top:function top(t,i){return e.calculateNewPointCoordinates(i,e.KEYCODES.UP,e.KEYCODES.DOWN)},left:function left(t,i){return e.calculateNewPointCoordinates(i,e.KEYCODES.LEFT,e.KEYCODES.RIGHT,!0)}})},stopMovingIndicator:function stopMovingIndicator(t){this.keysPressed[t.which]=!1},createKeyboardDrawingCursor:function createKeyboardDrawingCursor(){this.$el.find(".lrn_toolbar");this.$indicator=this.$el.find(".lrn_keyboard_paintable"),this.$indicator.css(this.getIndicatorPosition())},addMarker:function addMarker(){this.$indicator.append("<span>+</span>")},hasActiveDrawingIndicator:function hasActiveDrawingIndicator(){return!(!this.$indicator||!this.$indicator.children().length)},getIndicatorPosition:function getIndicatorPosition(){var t;return this.$canvas=this.$el.find(".lrn_canvas"),{top:(t=this.$canvas.position()).top+"px",left:t.left+"px"}},destroyDrawingIndicator:function destroyDrawingIndicator(){this.$indicator.empty()},hasFlashCanvas:function hasFlashCanvas(){return l.a.isUndefined(this._hasFlashCanvas)&&(this._hasFlashCanvas=!l.a.isEmpty(v.a)),this._hasFlashCanvas}}),T=i(41),O=i(184),S=i(131),q=u.a.View.extend({DELAY:750,LINE_COLOUR:"#52a8ec",appendParent:"body",touchEvents:{"touchstart .lrn_canvas_drawing":"stopPropagation"},fixedPositionEvents:{"mousedown .lrn_btn":"preventAction"},EVENT:{SHOWN:"shown",WRITING_STARTED:"writing-started",RECOGNITION_ENDED:"recognition-ended",RECOGNITION_REQUEST:"recognition-request",CANCEL_RECOGNITION:"cancel-recognition",RECEIVED_RESULT:"received-result",CHANGE_CONTEXT:"change-context",DELETE_CONTEXTS:"delete-contexts",ERROR:"error"},results:{},initialize:function initialize(){this.options.mathEvents;var t=w.a.isTouchDevice(),e=this;this.events=t?this.touchEvents:{},this.isRecognising=!1,this.i18n=this.options.i18n,this.results={},this.contexts=this.initContexts(),this.currentContext={},this.render(),this.listenTo(this.canvasDrawing,this.canvasDrawing.EVENT.UPDATED,this.onUpdate,this),this.listenTo(this.canvasDrawing,this.canvasDrawing.EVENT.STROKE_BEGIN,(function(){e.endRecognition(),e.trigger(e.EVENT.WRITING_STARTED)})),this.on(this.EVENT.CANCEL_RECOGNITION,this.endRecognition,this),this.on(this.EVENT.RECOGNITION_REQUEST,this.requestRecognition,this),this.on(this.EVENT.CHANGE_CONTEXT,this.changeContext,this),this.on(this.EVENT.DELETE_CONTEXTS,this.deleteContexts,this),this.on(this.EVENT.SHOWN,(function(){e.canvasDrawing.trigger(e.canvasDrawing.EVENT.SHOWN)}))},appendToBody:function appendToBody(){var t=this;this.$el.appendTo(this.appendParent).addClass("lrn_widget lrn_handwriting_fixed"),this.events=l.a.extend({},this.events,this.fixedPositionEvents),this.delegateEvents(),this.scaler=new O.a(this.$el,{debounceTime:300,onUpdate:function onUpdate(e){t.canvasDrawing.scale=e}}),this.fullScreenObserver=S.b.fullScreen.observe((function(t){var e=t||"body";e!==this.appendParent&&(this.$el.appendTo(e),this.appendParent=e)}),this),this.show=function(){this.$el.finish().fadeIn(100),this.trigger(this.EVENT.SHOWN),this.scaler.start().scale()},this.hide=function(){this.$el.finish().fadeOut(100),this.scaler.stop()}},changeContext:function changeContext(t){var e=this.contexts[t];e||(e=this.contexts[t]={state:{}}),e!==this.currentContext&&(this.canvasDrawing.trigger(this.canvasDrawing.EVENT.RESET,e.state),this.currentContext=e)},deleteContexts:function deleteContexts(t){l.a.each(t,(function(t){delete this.contexts[t]}),this)},endRecognition:function endRecognition(){this.isRecognising=!1,this.trigger(this.EVENT.RECOGNITION_ENDED),T.a.cancel()},getHandwriting:function getHandwriting(){var t={};return l.a.each(this.contexts,(function(e,i){t[i]=e.marks})),t},getMarksDigest:function getMarksDigest(t){return l.a.reduce(t,(function(t,e){return t+e.startTime}),"")},initContexts:function initContexts(){var t={};return l.a.each(this.options.handwriting,(function(e,i){t[i]={state:{buffer:e},marks:e}})),t},onUpdate:function onUpdate(t,e){var i=this.getMarksDigest(t),n=this.results[i],r=this;clearTimeout(this.recogniseTimeout),this.currentContext.state=e,this.currentContext.marks=t,this.endRecognition(),n?this.trigger(this.EVENT.RECEIVED_RESULT,n):(this.isRecognising=!0,this.recogniseTimeout=setTimeout((function(){r.isRecognising&&r.recognise.call(r,t,i)}),this.DELAY))},preventAction:function preventAction(t){t.preventDefault(),t.stopPropagation()},recognise:function recognise(t,e){var i=this;this.trigger(this.EVENT.RECOGNITION_REQUEST,t,(function(t){i.results[e]=t,i.isRecognising&&(i.endRecognition(),i.trigger(i.EVENT.RECEIVED_RESULT,t))}),(function(t){i.isRecognising&&(i.endRecognition(),i.trigger(i.EVENT.ERROR,i.i18n.labels.handwritingApiError))}))},remove:function remove(){return this.scaler&&(this.scaler.destroy(),this.scaler=null),this.fullScreenObserver&&S.b.fullScreen.unobserve(this.fullScreenObserver),this.canvasDrawing.remove(),delete this.canvasDrawing,u.a.View.prototype.remove.apply(this,arguments)},render:function render(){return this.canvasDrawing=new k({el:this.el,i18n:this.i18n,canPaint:!0,line_colour:this.LINE_COLOUR}),this.options.fixed&&this.appendToBody(),this},requestRecognition:function requestRecognition(t,e,i){T.a.recognise({type:T.a.TYPE.EQUATION,marks:t,successFn:e,failFn:i,handwritingRecognises:this.options.handwritingRecognises,security:this.options.security})},stopPropagation:function stopPropagation(t){t.stopPropagation()}}),A=i(185),R=i(36),D=i(156);function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function _unsupportedIterableToArray(t,e){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,e)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function getSymbolGroupsCustomLabels(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="symbols.options.";return Object.keys(t).filter((function(t){return t.indexOf(e)>-1})).map((function(i){return{id:i.replace(e,""),label:t[i]}}))}var L={},I=u.a.View.extend({CLASSES:{BUTTON_ACTIVE:"lrn_active"},SELECTORS:{KEYBOARD_HELP:".lrn-formula-keyboard-help",MENU_GROUP:'[data-lrn-component="menuGroup"]',MENU_GROUP_TOGGLE:'[data-lrn-component="menuGroup"] .lrn_dropdown_toggle',ARIA_LIVE:".lrn-formula-keypad-arialive"},DEFAULTSYMBOLGROUPS:{math:["basic","qwerty"],chemistry:["chemistry","basic","qwerty"]},EVENT:{ACTIVATED_GROUP:"activated-group",HIDDEN:"hidden",SHOWN:"shown"},KEYCODES:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,ESC:27,SPACE:32,ENTER:13},ACTIONS:{KEYPAD_OPEN:"open-keypad"},MINIMUM_KEYPAD_VISIBILITY:.25,TYPE:{FLOATING_KEYBOARD:"floating-keyboard",BLOCK_KEYBOARD:"block-keyboard",BLOCK_ON_FOCUS_KEYBOARD:"block-on-focus-keyboard",FIXED_HANDWRITING_ONLY:"fixed-handwriting-only",NO_INPUT_UI:"no-input-ui"},appendParent:"body",buttonMap:[],defaultNumColumns:8,helpModal:void 0,isBlockOnFocus:!1,isFloating:!1,isVisible:!0,shouldIgnoreNextAction:!1,lastFocusedElement:null,lazyRemoveTimeout:6e4,mainGroupNumColumns:4,$window:r()(window),normalEvents:{"mousedown button":"preventAction","mousedown button *":"preventAction","click .lrn-formula-keyboard-close":"closeButtonAction","keydown .lrn-formula-keyboard-close span":"closeButtonAction","click [tabindex]":"buttonAction","keydown [tabindex]":"buttonKeyDown","keydown .lrn_dropdown_toggle":"buttonKeyDown","keyup [tabindex]":"handleKeyEvent","keypress [tabindex]":"handleKeyEvent","blur [tabindex]":"blurredButton","mousedown div":"preventAction","selectstart div":"preventAction","mousedown .lrn_dropdown_toggle":"onDropdownToggleMouseUp","mouseup .lrn_dropdown_toggle":"onDropdownToggleMouseDown","mousedown .lrn-ui-style-floating-keyboard .lrn-drag-area":"startDrag","mousedown .lrn-ui-style-floating-keyboard .lrn-drag-area *":"startDrag"},touchEvents:{"touchend [tabindex]":"buttonAction","touchstart .lrn-ui-style-floating-keyboard .lrn-drag-area":"startTouchDrag","touchstart .lrn-formula-keyboard":"preventAction","touchstart .lrn-formula-keyboard-mask":"onMaskTouchstart","touchend .lrn-formula-keyboard-mask":"onMaskTouchend"},defaultNumberPadSymbols:["7","8","9","÷","4","5","6","multiply","1","2","3","minus","0","decimal","comma","plus","left","right","backspace","="],defaultHorizontalNumberPadSymbols:["0","1","2","3","4","5","6","7","8","9","decimal","comma","plus","minus","multiply","÷","=","left","right","backspace"],initialize:function initialize(){var t=this.options;this.i18n=t.i18n;var e,i=t.mathEvents,n=this.DEFAULTSYMBOLGROUPS[t.chemistry?"chemistry":"math"],r=l.a.isUndefined(t.symbols)?n:t.symbols,a=getSymbolGroupsCustomLabels(this.i18n.labels);h.a.updateI18nSymbols(this.i18n,r,a),this.horizontalLayout=t.horizontalLayout,e=this.horizontalLayout?t.horizontalPad||this.defaultHorizontalNumberPadSymbols:t.numberPad||this.defaultNumberPadSymbols,this.symbolGroups=h.a.getForInputUi(r,t.chemistry),this.numberPadSymbols=h.a.getForInputNumberPad(e),this.horizontalLayout&&(this.numberPadSymbols.columnCount=10,this.numberPadSymbols.rowCount=2),this.masterSymbolCollection=h.a.getNewerFormatMasterCollection(),this.numColumns=this.defaultNumColumns,this.buttonMapCache={},l.a.isUndefined(this.symbolGroups.value)&&(this.numColumns=4),this.resetDraggableElementPosition=l.a.debounce(l.a.bind(this.resetDraggableElementPosition,this),10),this.showHint=l.a.debounce(l.a.bind(this.showHint,this),200),this.updateAriaLiveText=l.a.debounce(l.a.bind(this.updateAriaLiveText,this),500),this.whetherToShowHints=l.a.isUndefined(t.showHints)||!0===t.showHints,this.uiBelowResponse=!!t.uiBelowResponse,this.setEvents(),this.listenTo(i,i.EVENT.EDITOR_FOCUSED,this.show),this.isLazy()||this.render()},activateGroup:function activateGroup(t){var e=!l.a.isUndefined(this.symbolGroups[t]),i=e&&!!this.symbolGroups[t].value.length,n='[data-symbol-group="'+t+'"]';e&&(this.$(".lrn-formula-keyboard-pager button").not(n).removeClass(this.CLASSES.BUTTON_ACTIVE).end().filter(n).addClass(this.CLASSES.BUTTON_ACTIVE),this.$(".lrn-formula-keyboard-page").not(n).hide().end().filter(n).show(),this.group=t,this.trigger(this.EVENT.ACTIVATED_GROUP,t),this.$(".lrn-formula-keyboard-main, lrn-keyboard-button-parent lrn-formula-keyboard-page").toggle(i),"handwriting"===this.group?this.$(this.SELECTORS.KEYBOARD_HELP).hide():this.$(this.SELECTORS.KEYBOARD_HELP).show()),this.updateButtonMap()},activateHelpModal:function activateHelpModal(){var t=r()(this.$el.closest(".lrn_response_wrapper")[0]||this.el),e=t.offset().top,i=t.find(".lrn_response_input").innerHeight(),n=this.$(".lrn-formula-keyboard").innerHeight();this.helpModal.show(e,i+n)},blurredButton:function blurredButton(){if(this._isDropdownClosed()&&!this.$el.find(":focus").length){var t=this.options.mathEvents;t.trigger(t.EVENT.ITEM_BLURRED)}},buttonAction:function buttonAction(t){var e=r()(t.currentTarget);if(!this.maskHasBeenScrolled(t))if(e.closest(".lrn-formula-keyboard-mask").length&&(t.preventDefault(),t.stopPropagation()),this.shouldIgnoreNextAction)this.shouldIgnoreNextAction=!1;else if(!this.isDragging){var i=e.data("mq-command"),n=e.data("symbol-group"),a=e.data("type");"help"===a&&this.activateHelpModal(),"caps"===a&&this.toggleCaps(),i&&this.sendMathCommand(t),n&&(t.currentTarget.focus(),this.activateGroup(n))}},buttonKeyDown:function buttonKeyDown(t){if(this._isDropdownClosed()){var e=this.options.mathEvents;switch(t.keyCode){case this.KEYCODES.LEFT:case this.KEYCODES.UP:case this.KEYCODES.RIGHT:case this.KEYCODES.DOWN:this.moveFocusInDirection(t);break;case this.KEYCODES.ESC:e.trigger(e.EVENT.ESCAPE_UI);break;case this.KEYCODES.TAB:t.shiftKey?(t.preventDefault(),e.trigger(e.EVENT.ESCAPE_UI_WITHOUT_KEYBOARD)):this.nextTab?(this.nextTab.is(":hidden")&&this.nextTab.parent().first().hasClass("lrn-formulaessay-button")&&(this.nextTab=this.nextTab.parent().siblings().find("button").filter(":visible").first()),this.nextTab.is(":visible")&&(t.preventDefault(),l.a.defer(l.a.bind((function(){this.nextTab.focus()}),this)))):e.trigger(e.EVENT.ESCAPE_UI_WITHOUT_KEYBOARD)}return this.handleKeyEvent(t)}},getLastNonEmptyElementIndex:function getLastNonEmptyElementIndex(t){var e=t.slice().reverse().reduce((function(t,e,i){return""!==e&&null===t?i:t}),null);return t.length-e-1},getAdjustedLayout:function getAdjustedLayout(t){var e=this.getLastNonEmptyElementIndex(t),i=t.reduce((function(t,i,n){return""!==i||n<e?t:t+1}),0);return t.slice(0,t.length-i)},shouldAdjustWidthOfTopRow:function shouldAdjustWidthOfTopRow(){var t=this.options.horizontalPad||this.defaultHorizontalNumberPadSymbols;return!(!this.horizontalLayout||!l.a.isArray(t))&&this.getAdjustedLayout(t).length<=10},shouldAdjustWidthOfBothRows:function shouldAdjustWidthOfBothRows(){var t=this.options.horizontalPad||this.defaultHorizontalNumberPadSymbols;if(!this.horizontalLayout||!l.a.isArray(t))return!1;var e=t.slice(0,10),i=this.getAdjustedLayout(e).length<=10,n=t.slice(10),r=this.getAdjustedLayout(n).length<=10;return i&&r},shouldAdjustWidth:function shouldAdjustWidth(){return this.shouldAdjustWidthOfTopRow()||this.shouldAdjustWidthOfBothRows()},calculatePositionAndWidth:function calculatePositionAndWidth(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.calculateWidth(t).width,i=t.pLeft+(t.pWidth-e)/2,n=t.pTop+t.pHeight,r=t.boardHeight;if(i+e>t.hLeft+t.hWidth&&(i=t.hLeft+t.hWidth-e),(t.hWidth<e||i<t.hLeft)&&(i=t.hLeft),!t.uiBelowResponse&&t.isFloating&&(n+r>this.$window.height()+this.$window.scrollTop()&&(n=t.pTop-r),n<=0)){var a=(n=t.pTop+t.pHeight)<=0;a&&(e=t.boardWidth,n=t.boardTop,i=t.boardLeft)}return this.shouldAdjustWidth()&&(e=null),{top:n,width:e,left:i}},calculateWidth:function calculateWidth(t){return{width:this.isFloating||this.isImageCloze?l.a.min([t.maxWidth,t.hWidth])*t.widthScale:100*t.widthScale+"%"}},calculateWidthScale:function calculateWidthScale(t){var e=1,i=this.numColumns;return i<this.mainGroupNumColumns&&(i=this.mainGroupNumColumns),!this.shouldAdjustWidth()&&t>this.minWidth&&(e=i/this.defaultNumColumns),e},getDraggableElement:function getDraggableElement(){return this.$(".lrn-formula-keyboard")},getHandwriting:function getHandwriting(){var t=this.handwritingPad;if(this.hasHandwriting())return t.getHandwriting.apply(t,arguments)},getPositionWithinBounds:function getPositionWithinBounds(t,e,i,n){return e<i+t?i+t:e>n+t?n+t:e},handleKeyEvent:function handleKeyEvent(t){if(this._isDropdownClosed()){var e=this.options.mathEvents,i=t.keyCode||t.which;l.a.contains(this.KEYCODES,i)||(e.trigger(e.EVENT.EXTERNAL_KEY,t),"keypress"!==t.type&&8!==i||t.preventDefault(),"keydown"===t.type&&t.shiftKey&&t.altKey&&t.preventDefault())}},hasHandwriting:function hasHandwriting(){return!(!this.symbolGroups.handwriting&&!this.isFixedHandwriting)},hide:function hide(){var t=this;(this.isFloating||this.isBlockOnFocus)&&this.isVisible?(this.$(".lrn-formula-keyboard").finish().fadeOut(100,(function(){t.resetDraggableElement(),t.trigger(t.EVENT.HIDDEN)})),this.isVisible=!1):this.isFixedHandwriting&&this.handwritingPad.hide(),this.isLazy()&&this.resetRemoveTimeout(),t.updateAriaLiveText(t.i18n.labels.ariaLiveText.mathKeyboard.mathKeyboardClosed)},closeButtonAction:function closeButtonAction(t){var e=this;(function shouldHideKeypad(t){if("click"===t.type)return!0;if("keydown"===t.type){var i=t.charCode||t.keyCode;if(i===e.KEYCODES.SPACE||i===e.KEYCODES.ENTER)return!0}})(t)&&(this.lastFocusedElement=null,t.preventDefault(),this.restoreFocusToInput(),this.hide())},hideHint:function hideHint(){this.$(".lrn-formula-keyboard-hint").addClass("lrn-empty"),this.hintShowing=!1},isCapitalised:function isCapitalised(){return this.$(".lrn-formula-keyboard").hasClass("lrn_caps_on")},isLazy:function isLazy(){var t=[this.TYPE.FLOATING_KEYBOARD,this.TYPE.BLOCK_ON_FOCUS_KEYBOARD,this.TYPE.FIXED_HANDWRITING_ONLY];return this.options.lazy&&l.a.contains(t,this.options.uiStyleType)},moveFocusInDirection:function moveFocusInDirection(t){var e=l.a.findWhere(this.buttonMap,{el:t.currentTarget}),i=l.a.invert(this.KEYCODES)[t.keyCode];if(e&&e.links[i]){var n=e.links[i];n===this.rootControlElement&&"UP"===i&&(this.rootControlElement.links.DOWN=e),this.lastFocusedElement=n.el,r()(this.lastFocusedElement).focus()}t.preventDefault(),t.stopPropagation()},notifyContainerWidth:function notifyContainerWidth(t){this.isFloating||this.isFixedHandwriting||this.horizontalLayout||(this.getDraggableElement().width(t),this.isImageCloze=!0)},onAttach:function onAttach(){var t,e,i=this,n=this.menuGroupDropdown;this.isRendered&&!this.isAttached&&(t=this.$(".lrn-formula-keyboard"),e=l.a.keys(this.symbolGroups),Object(x.a)(t,(function(){var t=i.menuGroupDropdown;t&&t.open({focusToSelectedOption:!1}),i.renderLatex(),t&&t.close()})),this.maxWidth=parseInt(t.css("max-width")),this.minWidth=parseInt(t.css("min-width")),"master"===e[0]&&e.length>1?(this.activateGroup(e[1]),n&&(n.selectedIndex=1)):(n&&(n.selectedIndex=0),this.activateGroup(e[0])),this.isAttached=!0)},pickCoords:function pickCoords(t,e){var i=this.$(".lrn-formula-keyboard").height()*this.MINIMUM_KEYPAD_VISIBILITY,n=this.$(".lrn-formula-keyboard").width()*this.MINIMUM_KEYPAD_VISIBILITY,r=this.pageWidth-n,a=-3*n,s=this.pageHeight-i;return{x:this.getPositionWithinBounds(e.x,t.clientX,a,r),y:this.getPositionWithinBounds(e.y,t.clientY,0,s)}},preventAction:function preventAction(t){var e=r()(t.target);!e.closest(this.SELECTORS.MENU_GROUP).length&&!e.closest(".lrn-formula-keyboard-mask").length&&(t.cancelable?t.preventDefault():this.shouldIgnoreNextAction=!0,t.stopPropagation())},pulseButton:function pulseButton(t,e,i){var n,r=1===e.length?e.toLowerCase():e,a=this;"\\"!==r&&(r=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),(n=i?this.$('[data-symbol-cid="'+i.cid+'"]'):this.$('[data-mq-value="'+r+'"]')).addClass(this.CLASSES.BUTTON_ACTIVE),setTimeout((function(){n.removeClass(a.CLASSES.BUTTON_ACTIVE)}),100)),this.isVisible||t!==this.ACTIONS.KEYPAD_OPEN||this.show()},remove:function remove(t){return r()(document).off(".lrn."+this.cid),S.b.capsLock.unobserve(this.capsObserver),this.fullScreenObserver&&S.b.fullScreen.unobserve(this.fullScreenObserver),this.unSetHintToShow(),!t&&this.clone&&(r()(this.clone).remove(),this.clone=null),this.$(".mq-math-mode.lrn-mq-original").each((function(){s()(this).revert()})),this.helpModal&&(this.helpModal.remove(),this.helpModal=null),this.handwritingPad&&(this.handwritingPad.remove(),this.handwritingPad=null),this.buttonMap=[],this.buttonMapCache={},u.a.View.prototype.remove.apply(this,arguments)},adjustHorizontalKeypadWidth:function adjustHorizontalKeypadWidth(){this.shouldAdjustWidthOfTopRow()?this.adjustWidthOfTopRow():this.shouldAdjustWidthOfBothRows()&&this.adjustWidthOfBothRows()},getHorizontalKeypadElements:function getHorizontalKeypadElements(){var t=this.el,e=t.querySelector(".lrn-formula-keyboard"),i=e.querySelector(".lrn-formula-keyboard-main");return{outerKeypadContainer:t,innerKeypadContainer:e,buttonsContainer:i,allButtons:l.a.toArray(i.children)}},applyStylesToAdjustedHorizontalKeypad:function applyStylesToAdjustedHorizontalKeypad(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.getHorizontalKeypadElements(),n=i.outerKeypadContainer,r=i.innerKeypadContainer;r.classList.add("lrn-formula-keyboard--adjusted"),n.classList.add("lrn_absolute_keyboard_parent--adjusted"),n.style.maxWidth="".concat(80*t.length,"px");var a=e||t;a.forEach((function(e){e.style.width="".concat(100/t.length,"%")}));var s=a.length,o="320px";s<=3&&(o="".concat(80*s,"px")),n.style.minWidth=o},isNonEmpty:function isNonEmpty(t){return t.classList.contains("lrn_btn_grid")},isPurposedlyEmpty:function isPurposedlyEmpty(t,e){var i=e.classList.contains("lrn-btn-placeholder"),n=t.filter(this.isNonEmpty),r=t.indexOf(l.a.last(n)),a=t.indexOf(e)<r;return i&&a},adjustWidthOfTopRow:function adjustWidthOfTopRow(){var t=this;if(this.shouldAdjustWidthOfTopRow()){var e=this.getHorizontalKeypadElements().allButtons,i=e.filter((function(i){return t.isNonEmpty(i)||t.isPurposedlyEmpty(e,i)}));l.a.difference(e,i).forEach((function(t){return t.classList.add("lrn-btn-placeholder--hidden")})),this.applyStylesToAdjustedHorizontalKeypad(i)}},adjustWidthOfBothRows:function adjustWidthOfBothRows(){var t=this;if(this.shouldAdjustWidthOfBothRows()){for(var e=this.getHorizontalKeypadElements(),i=e.buttonsContainer,n=e.allButtons,r=n.slice(0,10),a=r.filter((function(e){return t.isNonEmpty(e)||t.isPurposedlyEmpty(r,e)})),s=n.slice(10),o=s.filter((function(e){return t.isNonEmpty(e)||t.isPurposedlyEmpty(s,e)})),l=document.createElement("div"),c=document.createElement("div");i.firstChild;)i.removeChild(i.firstChild);a.forEach((function(t){l.appendChild(t)})),o.forEach((function(t){c.appendChild(t)})),i.appendChild(l),i.appendChild(c);var u=a.length>=o.length?a:o,h=[].concat(_toConsumableArray(a),_toConsumableArray(o));this.applyStylesToAdjustedHorizontalKeypad(u,h)}},render:function render(){var t=this.options.uiStyleType===this.TYPE.BLOCK_ON_FOCUS_KEYBOARD||this.options.uiStyleType===this.TYPE.FLOATING_KEYBOARD;this.$el.html(d()({symbolGroups:this.symbolGroups,showHints:this.whetherToShowHints,numberPadSymbols:this.numberPadSymbols,horizontalLayout:this.horizontalLayout,labels:this.i18n.labels,showCloseButton:t})),this.adjustHorizontalKeypadWidth(),this.$(".lrn-formula-keyboard").addClass("lrn-ui-style-"+this.options.uiStyleType).toggleClass("lrn-touch",!!w.a.isTouchDevice()),this.helpModal=new N({symbolGroups:this.symbolGroups,i18nLabels:this.i18n.labels}).render(),this.on(this.EVENT.ACTIVATED_GROUP,this.setWidthFromGroup),this.options.uiStyleType===this.TYPE.FIXED_HANDWRITING_ONLY&&(this.isFixedHandwriting=!0),this.hasHandwriting()&&(this.handwritingPad=new q({el:this.$(".lrn-handwriting")[0],security:this.options.security,handwriting:this.options.handwriting,handwritingRecognises:this.options.handwritingRecognises,fixed:this.isFixedHandwriting,i18n:this.i18n}),this.setHandwritingEvents()),this.options.uiStyleType===this.TYPE.BLOCK_ON_FOCUS_KEYBOARD&&(this.isBlockOnFocus=!0),this.options.uiStyleType===this.TYPE.FLOATING_KEYBOARD&&(this.isFloating=!0,this.options.immutablePositioner&&(this.options.positioner=this.options.immutablePositioner),this.$el.addClass("lrn lrn_widget lrn_absolute_keyboard_parent").appendTo(this.appendParent),this.fullScreenObserver=S.b.fullScreen.observe((function(t){var e=t||"body";e!==this.appendParent&&(this.$el.appendTo(e),this.appendParent=e)}),this),this.on(this.EVENT.SHOWN,l.a.debounce(this.resetVirginDraggableElement)),this.on(this.EVENT.ACTIVATED_GROUP,this.resetVirginDraggableElement)),this.options.uiStyleType!==this.TYPE.FLOATING_KEYBOARD&&this.options.uiStyleType!==this.TYPE.BLOCK_ON_FOCUS_KEYBOARD||(this.isVisible=!1);var e=this.TYPE;return l.a.contains([e.BLOCK_KEYBOARD,e.BLOCK_ON_FOCUS_KEYBOARD],this.options.uiStyleType)&&this.hideKeyboardMenuBar(),l.a.isEmpty(this.symbolGroups)||this.renderMenuGroup(),this.setMathEvents(this.options.mathEvents),this.capsObserver=S.b.capsLock.observe(this.toggleCaps,this),this.isRendered=!0,r.a.contains(document,this.el)&&this.onAttach(),this},renderMenuGroup:function renderMenuGroup(){var t=this,e=this.SELECTORS,i=e.MENU_GROUP,n=e.MENU_GROUP_TOGGLE,r=this.$(i).get(0),a=getSymbolGroupsCustomLabels(this.i18n.labels),s=this.options.disableSpokenmathUserInputs;Object(x.a)(r,(function(e){t.menuGroupDropdown=new A.a(r,function getDropdownSymbols(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return l.a.map(t,(function(t,n){var r=t.title,a=t.render_latex,s=t.label;return r||!a||i||R.a.translateOrEmptyString(s,(function(t){r=t})),{title:r,value:n,label:function labelFunction(){var t=l.a.findWhere(e,{id:n});return t?t.label:a&&s.indexOf("\\")>-1?'<span class="mathquill-embedded-latex">'.concat(s,"</span>"):"qwerty"===n?'<span class="lrn-group-qwerty" />':s}}}))}(t.symbolGroups,a,s),{scaleToFit:!0,toggleButton:{disableArrowKey:!0},ariaLabel:t.i18n.labels.ariaLabel.mathKeyboard.selectSymbolGroup,ariaDescription:t.i18n.labels.ariaLabel.mathKeyboard.symbolGroupRole,ariaSelected:t.i18n.labels.ariaLabel.mathKeyboard.currentSymbolGroup}),l.a.delay((function(){e()}),10)})),this.menuGroupDropdown.on("change",this.selectGroup,this).on("blur",this.blurredButton,this).on("updateComplete",(function(){return t.renderLatex(t.$(n))}))},renderLatex:function renderLatex(t){(t=t||this.$el).find(".mathquill-embedded-latex").each((function(){var t=this.textContent,e=L[t];e?this.parentNode.replaceChild(e.cloneNode(!0),this):(s.a.InertMath(this),L[t]=this.cloneNode(!0),this.classList.add("lrn-mq-original"))}))},resetDraggableElement:function resetDraggableElement(){this.isFloating&&(this.resetDraggableElementPosition(),this.hasBeenDragged=!1)},hideKeyboardMenuBar:function hideKeyboardMenuBar(){this.$(".lrn-drag-area").addClass("lrn_hide"),this.$(".lrn-formula-keyboard-menu").addClass("lrn-hide-menu-bar")},resetDraggableElementPosition:function resetDraggableElementPosition(){if(this.options.horizontalParent&&this.options.positioner){var t=r()(this.options.horizontalParent),e=r()(this.options.positioner),i=this.getDraggableElement(),n=t.outerWidth(),a=e.offset(),s=this.calculateWidthScale(n);i.css(this.calculatePositionAndWidth({pLeft:a.left,pTop:a.top,pWidth:e.outerWidth(),pHeight:e.outerHeight(),hLeft:t.offset().left,hWidth:n,maxWidth:this.maxWidth,boardHeight:i.outerHeight(),boardWidth:i.outerWidth(),boardTop:i.offset().top,boardLeft:i.offset().left,widthScale:s,isFloating:this.isFloating,uiBelowResponse:this.uiBelowResponse}))}},resetRemoveTimeout:function resetRemoveTimeout(){var t=this.options.mathEvents,e=this;clearTimeout(this.removeTimeout),this.removeTimeout=setTimeout((function(){e.isRendered&&(e.remove(!0),e.setElement(r()(e.clone).removeClass("lrn_clone")[0]),e.isRendered=!1,e.isAttached=!1,e.listenToOnce(t,t.EVENT.EDITOR_FOCUSED,(function(){e.show()})))}),this.lazyRemoveTimeout)},resetVirginDraggableElement:function resetVirginDraggableElement(){this.hasBeenDragged||this.resetDraggableElementPosition()},sendMathCommand:function sendMathCommand(t){var e=r()(t.currentTarget).attr("data-mq-command"),i=r()(t.currentTarget).attr("data-mq-value"),n=r()(t.currentTarget).data("symbol-cid"),a=this.masterSymbolCollection.get(n),s=this.options.mathEvents;"qwerty"===this.group&&this.isCapitalised()&&i.match(/^[a-z]$/)&&(i=i.toUpperCase()),s.trigger(s.EVENT.MATH_COMMAND,e,i,a)},setElement:function setElement(){return u.a.View.prototype.setElement.apply(this,arguments),this.clone=this.$el.clone().insertBefore(this.$el).addClass("lrn_clone")[0],this.options.el=this.el,this.options.$el=this.$el,this},setEvents:function setEvents(){this.events={},this.additionalEvents={},this.additionalTouchEvents={},this.whetherToShowHints&&(this.additionalEvents["mouseenter button[title]"]="setHintToShow",this.additionalEvents["mouseleave button[title]"]="unSetHintToShow",this.additionalTouchEvents["touchstart button[title]"]="showTouchHint"),r.a.extend(this.events,this.normalEvents,this.additionalEvents),w.a.isTouchDevice()&&r.a.extend(this.events,this.touchEvents,this.additionalTouchEvents)},setHandwritingEvents:function setHandwritingEvents(){var t=this.handwritingPad,e=this;this.listenTo(t,t.EVENT.WRITING_STARTED,(function(){var t=e.options.mathEvents;t.trigger(t.EVENT.CONTENT_OUTDATED)})),this.listenTo(t,t.EVENT.RECOGNITION_ENDED,(function(){var t=e.options.mathEvents;t.trigger(t.EVENT.RESET_STATE)})),this.listenTo(t,t.EVENT.RECOGNITION_REQUEST,(function(){var t=e.options.mathEvents;t.trigger(t.EVENT.AWAIT_UPDATE)})),this.listenTo(t,t.EVENT.RECEIVED_RESULT,(function(t){var i=e.options.mathEvents;i.trigger(i.EVENT.WRITE_LATEX,t)})),this.listenTo(t,t.EVENT.ERROR,(function(t){var i=e.options.mathEvents;i.trigger(i.EVENT.SET_ERROR,t)})),this.on(this.EVENT.ACTIVATED_GROUP+" "+this.EVENT.SHOWN,(function(){e.isVisible&&"handwriting"===e.group&&e.handwritingPad.trigger(e.handwritingPad.EVENT.SHOWN)}))},setHintToShow:function setHintToShow(t){this.hintToShow=t.currentTarget,this.showHint()},setMathEvents:function setMathEvents(t){var e,i=this,n=this;function changeHandwritingContext(){t.trigger(t.EVENT.GET_ACTIVE_ID,(function(t){n.handwritingPad.trigger(n.handwritingPad.EVENT.CANCEL_RECOGNITION),n.handwritingPad.trigger(n.handwritingPad.EVENT.CHANGE_CONTEXT,t)}))}return this.stopListening(this.options.mathEvents),this.options.mathEvents=t,this.listenTo(t,t.EVENT.MATH_COMMAND,this.pulseButton),this.listenTo(t,t.EVENT.SHIFT_KEY,(function(){S.b.capsLock.status&&"osx"===w.a.getOs()||n.toggleCaps()})),this.listenTo(t,t.EVENT.EDITOR_FOCUSED,this.show),this.listenTo(t,t.EVENT.EDITOR_BLURRED,(function(){i._mathDropdownFocus||i.hide()})),this.listenTo(t,t.EVENT.TAB_EDITOR,(function(t){t&&t.nextTabElement&&(t.isFirstElement||(n.nextTab=t.nextTabElement),n.isFixedHandwriting||(t.originalEvent.preventDefault(),l.a.defer((function(){(e=n.lastFocusedElement?n.$(n.lastFocusedElement):n.$("button:visible, [tabindex]:visible").get(0))?e.focus():t.nextTabElement.focus()}))))})),this.isFloating&&this.listenTo(t,t.EVENT.UPDATED,this.resetVirginDraggableElement),this.hasHandwriting()&&(this.listenTo(t,[t.EVENT.EDITOR_PRESSED,t.EVENT.UPDATED,t.EVENT.EDITOR_BLURRED,t.EVENT.MATH_COMMAND].join(" "),(function(){n.handwritingPad.trigger(n.handwritingPad.EVENT.CANCEL_RECOGNITION)})),changeHandwritingContext(),this.listenTo(t,t.EVENT.EDITOR_FOCUSED,changeHandwritingContext),this.listenTo(t,t.EVENT.EDITOR_REMOVED,(function(t){n.handwritingPad.trigger(n.handwritingPad.EVENT.DELETE_CONTEXTS,t)}))),this.listenTo(t,t.EVENT.MATH_COMMAND,this.updateCapitalisation),this.listenTo(t,"all",(function(e){e!==t.EVENT.ITEM_BLURRED&&n.helpModal&&n.helpModal.hide()}),this),this},onDropdownToggleMouseUp:function onDropdownToggleMouseUp(){this._mathDropdownFocus=!0},onDropdownToggleMouseDown:function onDropdownToggleMouseDown(){this._mathDropdownFocus=!1},setPositioner:function setPositioner(t,e){return this.isFloating&&!this.options.immutablePositioner&&(this.options.positioner=t,e&&(this.options.horizontalParent=t),this.resetVirginDraggableElement()),this},setWidthFromGroup:function setWidthFromGroup(t){this.numColumns=(this.symbolGroups[t]?this.symbolGroups[t].columnCount:0)+(this.numberPadSymbols.hasSymbols?this.symbolGroups[t].custom?4:this.numberPadSymbols.columnCount:0);var e=this.horizontalLayout&&this.shouldAdjustWidth()?1:this.numColumns/this.defaultNumColumns;this.shouldUpdateWidth()&&this.getDraggableElement().css(this.calculateWidth({hWidth:r()(this.options.horizontalParent).outerWidth(),widthScale:e,maxWidth:this.maxWidth}))},shouldUpdateWidth:function shouldUpdateWidth(){return this.options.horizontalParent&&r()(this.options.horizontalParent).is(":visible")},updateAriaLiveText:function updateAriaLiveText(t){r()(this.el).find(this.SELECTORS.ARIA_LIVE).text("").hide().text(t).show()},show:function show(){var t=this;this.updateAriaLiveText(this.i18n.labels.ariaLiveText.mathKeyboard.mathKeyboardOpened),clearTimeout(this.removeTimeout),this.isRendered||(this.render(),this.onAttach()),!this.isFloating&&!this.isBlockOnFocus||this.isVisible?this.isFixedHandwriting&&this.handwritingPad.show():(this.resetDraggableElement(),l.a.defer((function(){t.$(".lrn-formula-keyboard").finish().fadeIn(100,(function(){t.trigger(t.EVENT.SHOWN)}))})),this.isVisible=!0),delete this.tempPageWidth},showHint:function showHint(){if(this.hintToShow){var t=r()(this.hintToShow),e=t.data("shortcut");this.$(".lrn-hint-title").text(t.attr("title")||""),this.$(".lrn-hint-shortcut").text(l.a.exists(e)?e:""),this.$(".lrn-formula-keyboard-hint").removeClass("lrn-empty"),this.hintShowing=!0}},showTouchHint:function showTouchHint(t){this.hintTimeout&&clearTimeout(this.hintTimeout),this.showHint(t),this.hintTimeout=setTimeout(l.a.bind(this.hideHint,this),1e3)},startDrag:function startDrag(t){var e,i=this.getDraggableElement(),n=i.position(),a=this,s=this.$(".lrn-formula-keyboard-menu"),o={x:t.clientX-s.offset().left,y:t.clientY-s.offset().top};this.isDragging||(this.pageHeight=r()(document).outerHeight(),this.tempPageWidth=this.tempPageWidth||r()(document).innerWidth(),this.pageWidth=this.tempPageWidth),r()(document).on("mousemove.lrn."+this.cid,(function(t){var r=a.pickCoords(t,o);e?i.css({top:n.top+(r.y-e.y),left:n.left+(r.x-e.x)}):(e=r,a.hasBeenDragged=!0,a.isDragging=!0)})),r()(document).one("mouseup.lrn."+this.cid,(function(t){a.isDragging=!1,r()(document).off("mousemove.lrn."+a.cid)}))},startTouchDrag:function startTouchDrag(t){var e,i=this.getDraggableElement(),n=i.position(),a=this,s=this.$(".lrn-formula-keyboard-menu"),o={x:t.originalEvent.touches[0].clientX-s.offset().left,y:t.originalEvent.touches[0].clientY-s.offset().top};this.isDragging||(this.pageHeight=r()(document).outerHeight(),this.tempPageWidth=this.tempPageWidth||r()(document).innerWidth(),this.pageWidth=this.tempPageWidth),r()(document).on("touchmove.lrn."+this.cid,(function(t){var r=a.pickCoords(t.originalEvent.touches[0],o);e?i.css({top:n.top+(r.y-e.y),left:n.left+(r.x-e.x)}):(e=r,a.hasBeenDragged=!0)})),r()(document).one("touchend.lrn."+this.cid,(function(t){r()(document).off("touchmove.lrn."+a.cid)}))},toggleCaps:function toggleCaps(t){this.$(".lrn-formula-keyboard").toggleClass("lrn_caps_on",t)},unSetHintToShow:function unSetHintToShow(){this.hintShowing&&this.hideHint(),this.hintToShow=null},getElementByClassName:function getElementByClassName(t){return l.a.find(this.buttonMap,(function(e){return e.el.classList.contains(t)}))},getControlElements:function getControlElements(){return{dropdownElement:this.getElementByClassName("lrn_dropdown_toggle"),closeButtonElement:this.getElementByClassName("lrn-formula-keyboard-close-button"),helpButtonElement:this.getElementByClassName("lrn-formula-keyboard-help-button")}},getRootControlElement:function getRootControlElement(){var t=this.getControlElements(),e=t.dropdownElement,i=t.closeButtonElement,n=t.helpButtonElement;return this.horizontalLayout?n||i:e||n||i},getFirstRowElements:function getFirstRowElements(){var t=this.getControlElements(),e=t.dropdownElement,i=this.buttonMap.filter((function(i){var n=l.a.values(t).indexOf(i)>-1,r=!!e&&e.el.parentNode.contains(i.el);return!n&&!r})),n=l.a.min(i,(function(t){return t.top}));return this.buttonMap.filter((function(t){return t.top===n.top}))},applyArrowNavigationFixes:function applyArrowNavigationFixes(){var t=this.getControlElements(),e=t.dropdownElement,i=t.helpButtonElement,n=t.closeButtonElement,r=this.getFirstRowElements(),a=this.getRootControlElement();this.buttonMap.forEach((function(t){l.a.contains(r,t)&&(t.isInFirstRow=!0,a&&(t.links.UP=a))})),e&&n&&(e.links.UP=n),n&&(i||e)&&(n.links.DOWN=i||e);var s=e&&e.links.DOWN&&e.links.DOWN.el;s&&e.el.parentNode.contains(s)&&(e.links.DOWN=r[0])},updateButtonMap:function updateButtonMap(t){var e=this;!t&&this.buttonMapCache[this.group]?this.buttonMap=this.buttonMapCache[this.group]:Object(x.a)(this.$(".lrn-formula-keyboard"),(function(){e.buttonMap=e.buttonMapCache[e.group]=S.b.updateButtonMap(e.$("button.lrn_dropdown_toggle, [tabindex]:visible")),e.applyArrowNavigationFixes()})),this.rootControlElement=this.getRootControlElement()},updateCapitalisation:function updateCapitalisation(t,e){"qwerty"===this.group&&/^[a-zA-Z]$/.test(e)&&this.toggleCaps(/[A-Z]/.test(e))},selectGroup:function selectGroup(t){this.activateGroup(t.value),this.isFloating&&this.restoreFocusToInput()},onMaskTouchstart:function onMaskTouchstart(t){this.maskTouchstart=t.originalEvent.touches[0].clientY},restoreFocusToInput:function restoreFocusToInput(){var t=r()(this.options.positioner).find(".lrn_focusable");t&&t.focus()},maskHasBeenScrolled:function maskHasBeenScrolled(t){if(!l.a.isNumber(this.maskTouchstart))return!1;var e=Math.abs(t.originalEvent.changedTouches[0].clientY-this.maskTouchstart)>5;return this.maskTouchstart=null,e},getMenuContainer:function getMenuContainer(){return this.$(".lrn-formula-keyboard-menu-right").get(0)},_isDropdownClosed:function _isDropdownClosed(){var t=this.menuGroupDropdown;return!t||!t.isOpen()}}),N=u.a.View.extend({isMathRendered:!1,restoreFocus:void 0,events:{"keydown .lrn-close":"handleKeyDown","mousedown.lrn.formula.modal .lrn-ignore-mousedown":"handleMouseDown","click .lrn-close":"hide"},handleKeyDown:function handleKeyDown(t){27!==t.keyCode&&13!==t.keyCode&&32!==t.keyCode||(this.hide(),t.stopPropagation(),t.preventDefault())},handleMouseDown:function handleMouseDown(t){t.stopPropagation()},hide:function hide(){this.$el.parent().length&&(l.a.isFunction(this.restoreFocus)&&(this.restoreFocus(),this.restoreFocus=null),this.$el.detach().css({opacity:""}),r()(document).off(".lrn."+this.cid))},renderMath:function renderMath(){this.$(".mathquill-embedded-latex").each((function(){s.a.InertMath(this)})),this.isMathRendered=!0},remove:function remove(){return r()(document).off(".lrn."+this.cid),this.$(".mathquill-embedded-latex.mq-math-mode").each((function(){s()(this).revert()})),u.a.View.prototype.remove.apply(this,arguments)},render:function render(){var t=this.options.i18nLabels.mathKeyboardHelp;return this.setElement(r()(m()({symbolGroups:this.options.symbolGroups,formulaHelpLabels:t}))),this},show:function show(t,e){if(!this.$el.parent().length){var i=l.a.bind(this.hide,this);this.$el.css({top:t}).appendTo("body"),this.$(".lrn-content").css({height:e-parseInt(this.$el.css("marginTop"))}),this.isMathRendered||this.renderMath(),S.b.recomputeOpacityOn(this.el),this.$el.css({opacity:1}),r()(document).on("mousedown.lrn."+this.cid,i),this.restoreFocus=Object(D.a)(this.el)}}});e.a=I},166:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span class="lrn-spokenmath" aria-live="polite" data-lrn-component="logger"></span><span class="lrn_math_editable',displayLogic.hasOwnBorder&&(__p+=" lrn_bordered_mathinput"),__p+="",displayLogic.disableInput&&(__p+="",displayLogic.hasOwnBorder&&(__p+=" mq-editable-field"),__p+=" lrn_hide_cursor"),__p+='"',displayLogic.templateAriaLabel&&(__p+='aria-label="'+(null==(__t=displayLogic.templateAriaLabel)?"":_.escape(__t))+'"'),__p+="></span>";return __p}},167:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="sr-only lrn-formula-keypad-arialive" aria-live="polite"></div><div class="lrn-formula-keyboard lrn_clearfix" role="toolbar" aria-label="'+(null==(__t=labels.ariaLabel.mathKeyboard.title)?"":_.escape(__t))+'"><div class="lrn_toolbar lrn-formula-keyboard-menu lrn_clearfix '+(null==(__t=horizontalLayout&&"lrn-formula-keyboard-menu--horizontal")?"":__t)+" "+(null==(__t=!showHints&&"lrn-formula-keyboard-menu--no-hints")?"":__t)+'"><div class="lrn-drag-area"><div class="lrn-drag-handler"><span></span><span></span><span></span><span></span></div>',showCloseButton&&(__p+='<div class="lrn-formula-keyboard-close"><button class="lrn-formula-keyboard-close-button" tabindex="0" aria-label="'+(null==(__t=labels.ariaLabel.mathKeyboard.close)?"":_.escape(__t))+'"></button></div>'),__p+='</div><div class="clearfix"><div class="lrn-formula-keyboard-menu-right">',showHints&&(__p+='<div class="lrn-formula-keyboard-menu-container  lrn-formula-keyboard-menu-help  lrn-desktop-only"><button type="button" class="lrn-formula-keyboard-help-button" data-type="help" tabindex="-1" aria-label="'+(null==(__t=labels.ariaLabel.mathKeyboard.help)?"":_.escape(__t))+'"></button></div>'),__p+='</div><div class="lrn-formula-keyboard-menu-left">',_.keys(symbolGroups).length&&(__p+='<div class="lrn-formula-keyboard-menu-container lrn-formula-keyboard-menu-groups" data-lrn-component="menuGroup"></div>'),__p+="",showHints&&(__p+='<span class="lrn-formula-keyboard-hint lrn-empty"><span class="lrn-hint-title"></span> <span class="lrn-hint-shortcut lrn-desktop-only"></span></span>'),__p+='</div></div></div><div class="lrn-keyboard-holder">',numberPadSymbols.hasSymbols){__p+="";var fullKeypadClassName="lrn-keyboard-wrapper-"+numberPadSymbols.columnCount+"-columns";__p+='<div class="lrn-formula-keyboard-main '+(null==(__t=horizontalLayout?"lrn-formula-keyboard--horizontal":fullKeypadClassName)?"":__t)+'">';var numberPadIndex=1,numberPadRowIndex=0;_.each(numberPadSymbols.processedSymbols,(function(t){if(__p+="",numberPadRowIndex<numberPadSymbols.rowCount){if(__p+="",numberPadIndex<=numberPadSymbols.columnCount){var e=t.get("style")||"lrn-btn-grid-sym";__p+='<button type="button"class="'+(null==(__t=t.isPlaceholder()?"lrn-btn-placeholder":"lrn_btn_grid "+e)?"":__t)+'"aria-label="'+(null==(__t=t.get("title")||"")?"":__t)+'"data-mq-command="'+(null==(__t=t.get("type"))?"":_.escape(__t))+'"data-mq-value="'+(null==(__t=t.get("val"))?"":_.escape(__t))+'"tabindex="-1"',_.isArray(t.get("displayableShortcut"))&&(__p+="",showHints&&(__p+='title="'+(null==(__t=t.get("title"))?"":_.escape(__t))+'"'),__p+='data-shortcut="'+(null==(__t=t.get("displayableShortcut").join(" + "))?"":_.escape(__t))+'"'),__p+=">",t.isAria(t.get("val"))?(__p+='<span aria-hidden="true"',t.isFunctional()?__p+='class="'+(null==(__t=t.get("key_style"))?"":_.escape(__t))+'">':__p+=">"+(null==(__t=t.get("val"))?"":_.escape(__t)),__p+='</span><span class="sr-only">'+(null==(__t=t.get("title"))?"":_.escape(__t))+"</span>"):(__p+="",t.renderLabelAsLatex()?__p+='<span class="mathquill-embedded-latex">'+(null==(__t=t.get("label"))?"":_.escape(__t))+"</span>":__p+='<span class="lrn-btn-grid-sym__label" data-symbol-id="'+(null==(__t=t.get("val"))?"":_.escape(__t))+'">'+(null==(__t=t.get("label"))?"":_.escape(__t))+"</span>",__p+=""),__p+="</button>"}numberPadIndex===numberPadSymbols.columnCount&&numberPadRowIndex++,4===numberPadIndex?numberPadIndex=1:numberPadIndex++}})),__p+="</div>"}__p+="",!horizontalLayout&&_.each(symbolGroups,(function(t,e){if(__p+="",t.value.length){__p+='<div class="lrn-formula-keyboard-page lrn-keyboard-wrapper-'+(null==(__t=t.columnCount)?"":__t)+'-columns" data-symbol-group="'+(null==(__t=e)?"":__t)+'">',"master"===e&&(__p+='<div class="lrn-formula-keyboard-mask">');var i=1,n=0;_.each(t.value,(function(e){__p+="",n<t.rowCount&&(__p+="",i<=t.columnCount&&(__p+='<button aria-label="'+(null==(__t=e.get("title")||"")?"":__t)+'"type="button"class="'+(null==(__t=e.isPlaceholder()?" lrn-btn-placeholder ":"lrn_btn_grid")?"":__t)+(null==(__t=e.isFunctional()?" lrn-btn-grid-sym-functional":"")?"":__t)+(null==(__t=e.hasOwnStyle()?" "+e.get("style"):" lrn-btn-grid-sym")?"":__t)+'"data-symbol-cid="'+(null==(__t=e.cid)?"":_.escape(__t))+'"data-symbol-id="'+(null==(__t=e.get("id"))?"":_.escape(__t))+'"data-mq-command="'+(null==(__t=e.get("type"))?"":_.escape(__t))+'"data-mq-value="'+(null==(__t=e.get("val"))?"":_.escape(__t))+'"tabindex="-1"',_.isArray(e.get("displayableShortcut"))&&(__p+="",showHints&&(__p+='title="'+(null==(__t=e.get("title"))?"":_.escape(__t))+'"'),__p+='data-shortcut="'+(null==(__t=e.get("displayableShortcut").join(" + "))?"":_.escape(__t))+'"'),__p+=">",e.isFunctional()?__p+='<span aria-hidden="true" class="'+(null==(__t=e.get("key_style"))?"":_.escape(__t))+'"></span><span class="sr-only">'+(null==(__t=e.get("label"))?"":_.escape(__t))+"</span>":e.renderLabelAsLatex()?__p+='<span class="mathquill-embedded-latex">'+(null==(__t=e.get("label"))?"":_.escape(__t))+"</span>":__p+='<span class="lrn-btn-grid-sym__label" data-symbol-id="'+(null==(__t=e.get("val"))?"":_.escape(__t))+'">'+(null==(__t=e.get("label"))?"":_.escape(__t))+"</span>",__p+="</button>"),i===t.columnCount&&n++,4===i?i=1:i++)})),__p+="","master"===e&&(__p+="</div>"),__p+="</div>"}__p+=""})),__p+='</div><div class="lrn-qwerty lrn-formula-keyboard-page" data-symbol-group="qwerty"><div class="lrn-qwerty-row lrn-qwerty-row-1"><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="1" tabindex="-1">1</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="2" tabindex="-1">2</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="3" tabindex="-1">3</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="4" tabindex="-1">4</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="5" tabindex="-1">5</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="6" tabindex="-1">6</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="7" tabindex="-1">7</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="8" tabindex="-1">8</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="9" tabindex="-1">9</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="0" tabindex="-1">0</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="keystroke" data-mq-value="Backspace" tabindex="-1"><span aria-hidden="true" class="lrn_backspace"></span><span class="sr-only">Backspace</span></button></div><div class="lrn-qwerty-row lrn-qwerty-row-2"><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="q" tabindex="-1">q</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="w" tabindex="-1">w</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="e" tabindex="-1">e</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="r" tabindex="-1">r</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="t" tabindex="-1">t</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="y" tabindex="-1">y</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="u" tabindex="-1">u</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="i" tabindex="-1">i</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="o" tabindex="-1">o</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="p" tabindex="-1">p</button></div><div class="lrn-qwerty-row lrn-qwerty-row-3"><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="a" tabindex="-1">a</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="s" tabindex="-1">s</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="d" tabindex="-1">d</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="f" tabindex="-1">f</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="g" tabindex="-1">g</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="h" tabindex="-1">h</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="j" tabindex="-1">j</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="k" tabindex="-1">k</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="l" tabindex="-1">l</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value=":" tabindex="-1">:</button></div><div class="lrn-qwerty-row lrn-qwerty-row-4"><button type="button" class="lrn_btn_grid lrn-btn-grid-dir" data-mq-command="keystroke" data-mq-value="Up" tabindex="-1"><span aria-hidden="true">↑</span><span class="sr-only">Up</span></button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="z" tabindex="-1">z</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="x" tabindex="-1">x</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="c" tabindex="-1">c</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="v" tabindex="-1">v</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="b" tabindex="-1">b</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="n" tabindex="-1">n</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="m" tabindex="-1">m</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="," tabindex="-1">,</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid" data-mq-command="write" data-mq-value="." tabindex="-1">.</button></div><div class="lrn-qwerty-row lrn-qwerty-row-5"><button type="button" class="lrn_btn_grid lrn-btn-grid-dir " data-mq-command="keystroke" data-mq-value="Left" tabindex="-1"><span aria-hidden="true">←</span><span class="sr-only">Left</span></button><button type="button" class="lrn_btn_grid lrn-btn-grid-dir " data-mq-command="keystroke" data-mq-value="Down" tabindex="-1"><span aria-hidden="true">↓</span><span class="sr-only">Down</span></button><button type="button" class="lrn_btn_grid lrn-btn-grid-dir"  data-mq-command="keystroke" data-mq-value="Right" tabindex="-1"><span aria-hidden="true">→</span><span class="sr-only">Right</span></button><button type="button" class="lrn-qwerty-btn lrn-spacebar lrn_btn_grid" data-mq-command="cmd" data-mq-value="space" tabindex="-1">␣</button><button type="button" class="lrn-qwerty-btn lrn_btn_grid lrn_btn_caps" data-type="caps" data-mq-value="Shift" tabindex="-1"><span aria-hidden="true">⇧</span><span class="sr-only">Caps Lock</span></button></div></div><div class="lrn lrn-handwriting lrn-formula-keyboard-page" data-symbol-group="handwriting"></div></div>'}return __p}},168:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn lrn-formula-symbols-help" role="dialog" aria-labelledby="lrn_formula_help_dialog_label" aria-modal="true"><div class="lrn-formula-symbols-help-header lrn-ignore-mousedown"><h3 id="lrn_formula_help_dialog_label">'+(null==(__t=formulaHelpLabels.title)?"":__t)+'</h3><button class="lrn-close lrn-math-keep-keyboard-open" aria-label="'+(null==(__t=formulaHelpLabels.close)?"":__t)+'"></button></div><div class="lrn-content lrn-ignore-mousedown"><p>'+(null==(__t=formulaHelpLabels.shortcuts)?"":__t)+"</p>",_.each(symbolGroups,(function(t,e){__p+="",_.isEmpty(t.value)||(__p+="<h4>"+(null==(__t=t.title)?"":__t)+'</h4><table aria-label="'+(null==(__t=t.title)?"":__t)+'"><thead><tr><th>Symbol</th><th>Name</th><th>Shortcut</th></tr></thead><tbody>',_.each(t.value,(function(t){__p+="",_.isArray(t.get("displayableShortcut"))&&t.get("displayableShortcut").length&&(__p+='<tr><td><span class="sr-only">'+(null==(__t=t.get("title"))?"":__t)+" Rendered</span>",t.renderLabelAsLatex()?__p+='<span class="mathquill-embedded-latex" aria-hidden="true">'+(null==(__t=t.get("label"))?"":__t)+"</span>":__p+='<span aria-hidden="true">'+(null==(__t=t.get("label").replace("<","&lt;").replace(">","&gt;"))?"":__t)+"</span>",__p+="</td><td>"+(null==(__t=t.get("title"))?"":__t)+'</td><td class="lrn-shortcut">'+(null==(__t=t.get("displayableShortcut").join(" + ").replace("<","&lt;").replace(">","&gt;"))?"":__t)+"</td></tr>"),__p+=""})),__p+="</tbody></table>"),__p+=""})),__p+='<p class="lrn-disclaimer">'+(null==(__t=formulaHelpLabels.disclaimer)?"":__t)+"</p></div></div>";return __p}},169:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span class="lrn-accessibility-label">To answer this question, you need to highlight areas of an image. If you have trouble seeing the image, you should skip this question.</span><div class="lrn_canvas_drawing"><div class="lrn_toolbar"><ul class="lrn_toolbar_left">',displayLogic.canPaint&&(__p+='<li class="lrn_btn lrn_clear lrn_disabled" title="'+(null==(__t=labels.clear)?"":__t)+'" aria-label="'+(null==(__t=labels.clear)?"":_.escape(__t))+'" role="button"><button class="lrn-label" type="button" tabindex="0">'+(null==(__t=labels.clear)?"":__t)+'</button></li><li class="lrn_btn lrn_undo lrn_disabled" title="'+(null==(__t=labels.undo)?"":__t)+'" aria-label="'+(null==(__t=labels.undo)?"":_.escape(__t))+'" role="button"><button class="lrn-label" type="button" tabindex="0">'+(null==(__t=labels.undo)?"":__t)+'</button></li><li class="lrn_btn lrn_redo lrn_disabled" title="'+(null==(__t=labels.redo)?"":__t)+'" aria-label="'+(null==(__t=labels.redo)?"":_.escape(__t))+'" role="button"><button class="lrn-label" type="button" tabindex="0">'+(null==(__t=labels.redo)?"":__t)+"</button></li>"),__p+="",displayLogic.showRedraw&&(__p+='<li class="lrn_btn lrn_replay" title="'+(null==(__t=labels.replay)?"":__t)+'"><span class="lrn-label">'+(null==(__t=labels.replay)?"":__t)+"</span></li>"),__p+="",lineColourData&&_.isArray(lineColourData.colours)&&lineColourData.colours.length>1&&(__p+='<li class="lrn_line_colour_palette"><a class="lrn_btn lrn_line_colour_palette_trigger"><span style="background: '+(null==(__t=lineColourData.colours[0])?"":__t)+';"></span></a><ul>',_.each(lineColourData.colours,(function(t,e){__p+="",e<lineColourData.limit&&(__p+='<li class="lrn_btn_color_selector ',0==e&&(__p+="lrn_selected "),__p+='" data-colour-selection="'+(null==(__t=t)?"":__t)+'"><span style="background: '+(null==(__t=t)?"":__t)+';"></span></li>'),__p+=""})),__p+="</ul></li>"),__p+='</ul></div><canvas class="lrn_canvas',displayLogic.canPaint&&(__p+=" lrn_paintable"),__p+='" tabindex="0">'+(null==(__t=displayLogic.imageAlt)?"":_.escape(__t))+'</canvas><div class="lrn_keyboard_paintable" tabindex="0" aria-label="'+(null==(__t=labels.ariaLabel.drawing.highlight)?"":_.escape(__t))+'"></div></div>';return __p}},170:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_RESULT__=function(){if(window.ActiveXObject&&!window.CanvasRenderingContext2D&&function(window,document,undefined){var NULL=null,CANVAS="canvas",CANVAS_RENDERING_CONTEXT_2D="CanvasRenderingContext2D",CANVAS_GRADIENT="CanvasGradient",CANVAS_PATTERN="CanvasPattern",FLASH_CANVAS="FlashCanvas",G_VML_CANVAS_MANAGER="G_vmlCanvasManager",OBJECT_ID_PREFIX="external",ON_FOCUS="onfocus",ON_PROPERTY_CHANGE="onpropertychange",ON_READY_STATE_CHANGE="onreadystatechange",ON_UNLOAD="onunload",config=window[FLASH_CANVAS+"Options"]||{},BASE_URL=config.swfPath||getScriptUrl().replace(/[^\/]+$/,""),SWF_URL=BASE_URL+"flashcanvas.swf",INDEX_SIZE_ERR=1,NOT_SUPPORTED_ERR=9,INVALID_STATE_ERR=11,SYNTAX_ERR=12,TYPE_MISMATCH_ERR=17,SECURITY_ERR=18;function Lookup(t){for(var e=0,i=t.length;e<i;e++)this[t[e]]=e}var properties=new Lookup(["toDataURL","save","restore","scale","rotate","translate","transform","setTransform","globalAlpha","globalCompositeOperation","strokeStyle","fillStyle","createLinearGradient","createRadialGradient","createPattern","lineWidth","lineCap","lineJoin","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","clearRect","fillRect","strokeRect","beginPath","closePath","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","arcTo","rect","arc","fill","stroke","clip","isPointInPath","font","textAlign","textBaseline","fillText","strokeText","measureText","drawImage","createImageData","getImageData","putImageData","addColorStop","direction","resize"]),isReady={},images={},lock={},callbacks={},canvases={},spans={},CanvasRenderingContext2D=function(t,e){this.canvas=t,this._swf=e,this._canvasId=e.id.slice(8),this._initialize(),this._gradientPatternId=0,this._direction="",this._font="";var i=this;setInterval((function(){0===lock[i._canvasId]&&i._executeCommand()}),30)};CanvasRenderingContext2D.prototype={save:function(){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setFillStyle(),this._setLineStyles(),this._setFontStyles(),this._stateStack.push([this._globalAlpha,this._globalCompositeOperation,this._strokeStyle,this._fillStyle,this._lineWidth,this._lineCap,this._lineJoin,this._miterLimit,this._shadowOffsetX,this._shadowOffsetY,this._shadowBlur,this._shadowColor,this._font,this._textAlign,this._textBaseline]),this._queue.push(properties.save)},restore:function(){var t=this._stateStack;if(t.length){var e=t.pop();this.globalAlpha=e[0],this.globalCompositeOperation=e[1],this.strokeStyle=e[2],this.fillStyle=e[3],this.lineWidth=e[4],this.lineCap=e[5],this.lineJoin=e[6],this.miterLimit=e[7],this.shadowOffsetX=e[8],this.shadowOffsetY=e[9],this.shadowBlur=e[10],this.shadowColor=e[11],this.font=e[12],this.textAlign=e[13],this.textBaseline=e[14]}this._queue.push(properties.restore)},scale:function(t,e){this._queue.push(properties.scale,t,e)},rotate:function(t){this._queue.push(properties.rotate,t)},translate:function(t,e){this._queue.push(properties.translate,t,e)},transform:function(t,e,i,n,r,a){this._queue.push(properties.transform,t,e,i,n,r,a)},setTransform:function(t,e,i,n,r,a){this._queue.push(properties.setTransform,t,e,i,n,r,a)},_setCompositing:function(){var t=this._queue;this._globalAlpha!==this.globalAlpha&&(this._globalAlpha=this.globalAlpha,t.push(properties.globalAlpha,this._globalAlpha)),this._globalCompositeOperation!==this.globalCompositeOperation&&(this._globalCompositeOperation=this.globalCompositeOperation,t.push(properties.globalCompositeOperation,this._globalCompositeOperation))},_setStrokeStyle:function(){if(this._strokeStyle!==this.strokeStyle){var t=this._strokeStyle=this.strokeStyle;if("string"==typeof t);else{if(!(t instanceof CanvasGradient||t instanceof CanvasPattern))return;t=t.id}this._queue.push(properties.strokeStyle,t)}},_setFillStyle:function(){if(this._fillStyle!==this.fillStyle){var t=this._fillStyle=this.fillStyle;if("string"==typeof t);else{if(!(t instanceof CanvasGradient||t instanceof CanvasPattern))return;t=t.id}this._queue.push(properties.fillStyle,t)}},createLinearGradient:function(t,e,i,n){return isFinite(t)&&isFinite(e)&&isFinite(i)&&isFinite(n)||throwException(NOT_SUPPORTED_ERR),this._queue.push(properties.createLinearGradient,t,e,i,n),new CanvasGradient(this)},createRadialGradient:function(t,e,i,n,r,a){return isFinite(t)&&isFinite(e)&&isFinite(i)&&isFinite(n)&&isFinite(r)&&isFinite(a)||throwException(NOT_SUPPORTED_ERR),(i<0||a<0)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.createRadialGradient,t,e,i,n,r,a),new CanvasGradient(this)},createPattern:function(t,e){t||throwException(TYPE_MISMATCH_ERR);var i,n=t.tagName,r=this._canvasId;if(n)if("img"===(n=n.toLowerCase()))i=t.getAttribute("src",2);else{if(n===CANVAS||"video"===n)return;throwException(TYPE_MISMATCH_ERR)}else t.src?i=t.src:throwException(TYPE_MISMATCH_ERR);return"repeat"!==e&&"no-repeat"!==e&&"repeat-x"!==e&&"repeat-y"!==e&&""!==e&&e!==NULL&&throwException(SYNTAX_ERR),this._queue.push(properties.createPattern,encodeXML(i),e),!images[r][i]&&isReady[r]&&(this._executeCommand(),++lock[r],images[r][i]=!0),new CanvasPattern(this)},_setLineStyles:function(){var t=this._queue;this._lineWidth!==this.lineWidth&&(this._lineWidth=this.lineWidth,t.push(properties.lineWidth,this._lineWidth)),this._lineCap!==this.lineCap&&(this._lineCap=this.lineCap,t.push(properties.lineCap,this._lineCap)),this._lineJoin!==this.lineJoin&&(this._lineJoin=this.lineJoin,t.push(properties.lineJoin,this._lineJoin)),this._miterLimit!==this.miterLimit&&(this._miterLimit=this.miterLimit,t.push(properties.miterLimit,this._miterLimit))},_setShadows:function(){var t=this._queue;this._shadowOffsetX!==this.shadowOffsetX&&(this._shadowOffsetX=this.shadowOffsetX,t.push(properties.shadowOffsetX,this._shadowOffsetX)),this._shadowOffsetY!==this.shadowOffsetY&&(this._shadowOffsetY=this.shadowOffsetY,t.push(properties.shadowOffsetY,this._shadowOffsetY)),this._shadowBlur!==this.shadowBlur&&(this._shadowBlur=this.shadowBlur,t.push(properties.shadowBlur,this._shadowBlur)),this._shadowColor!==this.shadowColor&&(this._shadowColor=this.shadowColor,t.push(properties.shadowColor,this._shadowColor))},clearRect:function(t,e,i,n){this._queue.push(properties.clearRect,t,e,i,n)},fillRect:function(t,e,i,n){this._setCompositing(),this._setShadows(),this._setFillStyle(),this._queue.push(properties.fillRect,t,e,i,n)},strokeRect:function(t,e,i,n){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setLineStyles(),this._queue.push(properties.strokeRect,t,e,i,n)},beginPath:function(){this._queue.push(properties.beginPath)},closePath:function(){this._queue.push(properties.closePath)},moveTo:function(t,e){this._queue.push(properties.moveTo,t,e)},lineTo:function(t,e){this._queue.push(properties.lineTo,t,e)},quadraticCurveTo:function(t,e,i,n){this._queue.push(properties.quadraticCurveTo,t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,a){this._queue.push(properties.bezierCurveTo,t,e,i,n,r,a)},arcTo:function(t,e,i,n,r){r<0&&isFinite(r)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.arcTo,t,e,i,n,r)},rect:function(t,e,i,n){this._queue.push(properties.rect,t,e,i,n)},arc:function(t,e,i,n,r,a){i<0&&isFinite(i)&&throwException(INDEX_SIZE_ERR),this._queue.push(properties.arc,t,e,i,n,r,a?1:0)},fill:function(){this._setCompositing(),this._setShadows(),this._setFillStyle(),this._queue.push(properties.fill)},stroke:function(){this._setCompositing(),this._setShadows(),this._setStrokeStyle(),this._setLineStyles(),this._queue.push(properties.stroke)},clip:function(){this._queue.push(properties.clip)},isPointInPath:function(t,e){},_setFontStyles:function(){var t=this._queue;if(this._font!==this.font)try{var e=spans[this._canvasId];e.style.font=this._font=this.font;var i=e.currentStyle,n=e.offsetHeight,r=[i.fontStyle,i.fontWeight,n,i.fontFamily].join(" ");t.push(properties.font,r)}catch(t){}this._textAlign!==this.textAlign&&(this._textAlign=this.textAlign,t.push(properties.textAlign,this._textAlign)),this._textBaseline!==this.textBaseline&&(this._textBaseline=this.textBaseline,t.push(properties.textBaseline,this._textBaseline)),this._direction!==this.canvas.currentStyle.direction&&(this._direction=this.canvas.currentStyle.direction,t.push(properties.direction,this._direction))},fillText:function(t,e,i,n){this._setCompositing(),this._setFillStyle(),this._setShadows(),this._setFontStyles(),this._queue.push(properties.fillText,encodeXML(t),e,i,n===undefined?1/0:n)},strokeText:function(t,e,i,n){this._setCompositing(),this._setStrokeStyle(),this._setShadows(),this._setFontStyles(),this._queue.push(properties.strokeText,encodeXML(t),e,i,n===undefined?1/0:n)},measureText:function(t){var e=spans[this._canvasId];try{e.style.font=this.font}catch(t){}return e.innerText=(""+t).replace(/[ \n\f\r]/g,"\t"),new TextMetrics(e.offsetWidth)},drawImage:function(t,e,i,n,r,a,s,o,l){t||throwException(TYPE_MISMATCH_ERR);var c,u=t.tagName,h=arguments.length,p=this._canvasId;if(u)if("img"===(u=u.toLowerCase()))c=t.getAttribute("src",2);else{if(u===CANVAS||"video"===u)return;throwException(TYPE_MISMATCH_ERR)}else t.src?c=t.src:throwException(TYPE_MISMATCH_ERR);if(this._setCompositing(),this._setShadows(),c=encodeXML(c),3===h)this._queue.push(properties.drawImage,h,c,e,i);else if(5===h)this._queue.push(properties.drawImage,h,c,e,i,n,r);else{if(9!==h)return;0!==n&&0!==r||throwException(INDEX_SIZE_ERR),this._queue.push(properties.drawImage,h,c,e,i,n,r,a,s,o,l)}!images[p][c]&&isReady[p]&&(this._executeCommand(),++lock[p],images[p][c]=!0)},createImageData:function(){},getImageData:function(t,e,i,n){},putImageData:function(t,e,i,n,r,a,s){},loadImage:function(t,e,i){var n,r=t.tagName,a=this._canvasId;r?"img"===r.toLowerCase()&&(n=t.getAttribute("src",2)):t.src&&(n=t.src),n&&!images[a][n]&&((e||i)&&(callbacks[a][n]=[t,e,i]),this._queue.push(properties.drawImage,1,encodeXML(n)),isReady[a]&&(this._executeCommand(),++lock[a],images[a][n]=!0))},_initialize:function(){this.globalAlpha=this._globalAlpha=1,this.globalCompositeOperation=this._globalCompositeOperation="source-over",this.strokeStyle=this._strokeStyle="#000000",this.fillStyle=this._fillStyle="#000000",this.lineWidth=this._lineWidth=1,this.lineCap=this._lineCap="butt",this.lineJoin=this._lineJoin="miter",this.miterLimit=this._miterLimit=10,this.shadowOffsetX=this._shadowOffsetX=0,this.shadowOffsetY=this._shadowOffsetY=0,this.shadowBlur=this._shadowBlur=0,this.shadowColor=this._shadowColor="rgba(0, 0, 0, 0.0)",this.font=this._font="10px sans-serif",this.textAlign=this._textAlign="start",this.textBaseline=this._textBaseline="alphabetic",this._queue=[],this._stateStack=[]},_flush:function(){var t=this._queue;return this._queue=[],t},_executeCommand:function(){var commands=this._flush();if(commands.length>0)return eval(this._swf.CallFunction('<invoke name="executeCommand" returntype="javascript"><arguments><string>'+commands.join("&#0;")+"</string></arguments></invoke>"))},_resize:function(t,e){this._executeCommand(),this._initialize(),t>0&&(this._swf.width=t),e>0&&(this._swf.height=e),this._queue.push(properties.resize,t,e)}};var CanvasGradient=function(t){this._ctx=t,this.id=t._gradientPatternId++};CanvasGradient.prototype={addColorStop:function(t,e){(isNaN(t)||t<0||t>1)&&throwException(INDEX_SIZE_ERR),this._ctx._queue.push(properties.addColorStop,this.id,t,e)}};var CanvasPattern=function(t){this.id=t._gradientPatternId++},TextMetrics=function(t){this.width=t},DOMException=function(t){this.code=t,this.message=DOMExceptionNames[t]};DOMException.prototype=new Error;var DOMExceptionNames={1:"INDEX_SIZE_ERR",9:"NOT_SUPPORTED_ERR",11:"INVALID_STATE_ERR",12:"SYNTAX_ERR",17:"TYPE_MISMATCH_ERR",18:"SECURITY_ERR"};function onReadyStateChange(){if("complete"===document.readyState){document.detachEvent(ON_READY_STATE_CHANGE,onReadyStateChange);for(var t=document.getElementsByTagName(CANVAS),e=0,i=t.length;e<i;++e)FlashCanvas.initElement(t[e])}}function onFocus(){var t=event.srcElement,e=t.parentNode;t.blur(),e.focus()}function onPropertyChange(){var t=event.propertyName;if("width"===t||"height"===t){var e=event.srcElement,i=e[t],n=parseInt(i,10);(isNaN(n)||n<0)&&(n="width"===t?300:150),i===n?(e.style[t]=n+"px",e.getContext("2d")._resize(e.width,e.height)):e[t]=n}}function onUnload(){for(var t in window.detachEvent(ON_UNLOAD,onUnload),canvases){var e,i=canvases[t],n=i.firstChild;for(e in n)"function"==typeof n[e]&&(n[e]=NULL);for(e in i)"function"==typeof i[e]&&(i[e]=NULL);n.detachEvent(ON_FOCUS,onFocus),i.detachEvent(ON_PROPERTY_CHANGE,onPropertyChange)}window[CANVAS_RENDERING_CONTEXT_2D]=NULL,window[CANVAS_GRADIENT]=NULL,window[CANVAS_PATTERN]=NULL,window[FLASH_CANVAS]=NULL,window[G_VML_CANVAS_MANAGER]=NULL}var FlashCanvas={setPath:function(t){SWF_URL=(BASE_URL=t)+"flashcanvas.swf"},initElement:function(t){if(t.getContext)return t;var e=getUniqueId(),i=OBJECT_ID_PREFIX+e;isReady[e]=!1,images[e]={},lock[e]=1,callbacks[e]={},setCanvasSize(t),t.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+location.protocol+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="100%" height="100%" id="'+i+'"><param name="allowScriptAccess" value="always"><param name="flashvars" value="id='+i+'"><param name="wmode" value="transparent"></object><span style="margin:0;padding:0;border:0;display:inline-block;position:static;height:1em;overflow:visible;white-space:nowrap"></span>',canvases[e]=t;var n=t.firstChild;spans[e]=t.lastChild;var r=document.body.contains;if(r(t))n.movie=SWF_URL;else var a=setInterval((function(){r(t)&&(clearInterval(a),n.movie=SWF_URL)}),0);"BackCompat"!==document.compatMode&&window.XMLHttpRequest||(spans[e].style.overflow="hidden");var s=new CanvasRenderingContext2D(t,n);return t.getContext=function(t){return"2d"===t?s:NULL},t.toDataURL=function(t,e){return"image/jpeg"===(""+t).replace(/[A-Z]+/g,toLowerCase)?s._queue.push(properties.toDataURL,t,"number"==typeof e?e:""):s._queue.push(properties.toDataURL,t),s._executeCommand()},n.attachEvent(ON_FOCUS,onFocus),t},saveImage:function(t){t.firstChild.saveImage()},setOptions:function(t){},trigger:function(t,e){canvases[t].fireEvent("on"+e)},unlock:function(t,e,i){var n,r,a,s,o,l,c;lock[t]&&--lock[t],e===undefined?(r=(n=canvases[t]).firstChild,setCanvasSize(n),a=n.width,s=n.height,n.style.width=a+"px",n.style.height=s+"px",a>0&&(r.width=a),s>0&&(r.height=s),r.resize(a,s),n.attachEvent(ON_PROPERTY_CHANGE,onPropertyChange),isReady[t]=!0,"function"==typeof n.onload&&setTimeout((function(){n.onload()}),0)):(o=callbacks[t][e])&&(l=o[0],c=o[1+i],delete callbacks[t][e],"function"==typeof c&&c.call(l))}};function getScriptUrl(){var t=document.getElementsByTagName("script"),e=t[t.length-1];return document.documentMode>=8?e.src:e.getAttribute("src",4)}function getUniqueId(){return Math.random().toString(36).slice(2)||"0"}function encodeXML(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function toLowerCase(t){return t.toLowerCase()}function throwException(t){throw new DOMException(t)}function setCanvasSize(t){var e=parseInt(t.width,10),i=parseInt(t.height,10);(isNaN(e)||e<0)&&(e=300),(isNaN(i)||i<0)&&(i=150),t.width=e,t.height=i}document.createElement(CANVAS),document.createStyleSheet().cssText=CANVAS+"{display:inline-block;overflow:hidden;width:300px;height:150px}","complete"===document.readyState?onReadyStateChange():document.attachEvent(ON_READY_STATE_CHANGE,onReadyStateChange),window.attachEvent(ON_UNLOAD,onUnload),window[CANVAS_RENDERING_CONTEXT_2D]=CanvasRenderingContext2D,window[CANVAS_GRADIENT]=CanvasGradient,window[CANVAS_PATTERN]=CanvasPattern,window[FLASH_CANVAS]=FlashCanvas,window[G_VML_CANVAS_MANAGER]={init:function(){},init_:function(){},initElement:FlashCanvas.initElement},keep=[CanvasRenderingContext2D.measureText,CanvasRenderingContext2D.loadImage]}(window,document),"undefined"!=typeof FlashCanvas)return FlashCanvas}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},175:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(176),s=i.n(a),o=i(17),l=function ShuffledArray(t,e){this.unshuffled=t,this.seed=e||ShuffledArray.generateSeed(),this.value=ShuffledArray.shuffle(this.unshuffled,this.seed)};l.create=function(t,e){return new l(t,e)},l.generateSeed=function(){return o.a.v4()},l.shuffle=function(t,e){var i,n,r,a,o;for(l.validate(t,e),i=t.slice(0),n=t.length,o=new s.a(e);n;)a=Math.floor(o()*n),r=i[n-=1],i[n]=i[a],i[a]=r;return i},l.validate=function(t,e){if(!r.a.isArray(t))throw new Error("ShuffledArray: must have an array as a first argument, but was: "+JSON.stringify(t));if(!r.a.isString(e))throw new Error("ShuffledArray: seed must be a string, but was: "+JSON.stringify(e));if(!e.length)throw new Error("ShuffledArray: seed must have a length, but was: "+JSON.stringify(e))};var c=l;function shuffleOrder(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.exclusions||[],i=c.shuffle(t.originalOrder,t.seed),n=r.a.range(20).map((function(t){return t.toString()})),a=i,s=t.seed,o=1,l=0;o<=20&&orderIsAnExclusion(a,e);)s+=n[l],a=c.shuffle(t.originalOrder,s),o++,l++;return orderIsAnExclusion(a,e)&&(a=i),a}function orderIsAnExclusion(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.a.any(e,(function(e){return r.a.isEqual(t,e)}))}e.a=function shuffleOrderWithQuestionSeed(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.exclusions,i=t.questionMetadata,n=void 0===i?{}:i,r=t.originalOrder,a=n.response_shuffle_seed||t.seed;return shuffleOrder({exclusions:e,originalOrder:r,seed:a})}},176:function(t,e,i){var n;void 0===(n=function(){"use strict";return function(t){var e=window,i=Math.pow(256,6),n=Math.pow(2,52),r=2*n;function ARC4(t){var e,i=t.length,n=this,r=0,a=n.i=n.j=0,s=n.S=[];for(i||(t=[i++]);r<256;)s[r]=r++;for(r=0;r<256;r++)s[r]=s[a=255&a+t[r%i]+(e=s[r])],s[a]=e;(n.g=function(t){for(var e,i=0,r=n.i,a=n.j,s=n.S;t--;)e=s[r=255&r+1],i=256*i+s[255&(s[r]=s[a=255&a+e])+(s[a]=e)];return n.i=r,n.j=a,i})(256)}function copy(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function mixkey(t,e){for(var i,n=t+"",r=0;r<n.length;)e[255&r]=255&(i^=19*e[255&r])+n.charCodeAt(r++);return tostring(e)}function tostring(t){return String.fromCharCode.apply(0,t)}return mixkey(Math.random(),t),function seedrandom(a,s,o){var l,c,u,h=[];return l=mixkey(function flatten(t,e){var i,n=[],r=typeof t;if(e&&"object"==r)for(i in t)try{n.push(flatten(t[i],e-1))}catch(t){}return n.length?n:"string"==r?t:t+"\0"}((s=1==s?{entropy:!0}:s||{}).entropy?[a,tostring(t)]:null==a?function autoseed(){var i,n,r;try{return i=new Uint8Array(256),(e.crypto||e.msCrypto).getRandomValues(i),tostring(i)}catch(i){return n=e.navigator,r=n&&n.plugins,[+new Date,e,r,e.screen,tostring(t)]}}():a,3),h),c=new ARC4(h),(u=function(){for(var t=c.g(6),e=i,a=0;t<n;)t=256*(t+a),e*=256,a=c.g(1);for(;t>=r;)t/=2,e/=2,a>>>=1;return(t+a)/e}).int32=function(){return 0|c.g(4)},u.quick=function(){return c.g(4)/4294967296},u.double=u,mixkey(tostring(c.S),t),(s.pass||o||function(t,e,i,n){if(!n)return t;n.S&&copy(n,c),t.state=function(){return copy(c,{})}})(u,l,"global"in s?s.global:this==Math,s.state)}}([])}.call(e,i,e,t))||(t.exports=n)},179:function(t,e,i){"use strict";var n=i(5),r=i.n(n),a=i(0),s=i.n(a),o=i(51),l=["toggle"],c=["Left","Right","Backspace","÷","×","-","+","="];switch(o.a.getOs()){case"osx":l=["shift","opt"];break;case"windows":case"unix":case"linux":l=["shift","alt"]}var u=r.a.Model.extend({keysForToggle:l,keyForCtrlToggle:"ctrl",ariaHiddenSymbols:c,defaults:{type:"write"},initialize:function initialize(){this.createDisplayableShortcut(),this.on("change:shortcut",this.createDisplayableShortcut,this)},createDisplayableShortcut:function createDisplayableShortcut(){var t=s.a.clone(this.get("shortcut"));"toggle"===s.a.first(t)&&(t=s.a.union(this.keysForToggle,s.a.rest(t,1))),"ctrl"===s.a.first(t)&&(t=s.a.union(["ctrl"],s.a.rest(t))),t&&t[0]===this.get("title")&&(t=[]),this.set("displayableShortcut",t)},renderLabelAsLatex:function renderLabelAsLatex(){var t=this.get("label_latex");return s.a.isBoolean(t)?t:this.get("label").indexOf("\\")>-1},isPlaceholder:function isPlaceholder(){return""===this.get("id")},isFunctional:function isFunctional(){return!("addmatrixcol"===this.get("name")||"addmatrixrow"===this.get("name"))&&"keystroke"===this.get("type")},hasOwnStyle:function hasOwnStyle(){return!!this.get("style")},isAria:function isAria(t){return s.a.contains(c,t)}});e.a=r.a.Collection.extend({model:u,get:function get(t){return r.a.Collection.prototype.get.apply(this,arguments)||this.find((function(e){return s.a.contains(e.get("aliases"),t)}))},add:function add(t){this.isUnique(t)&&r.a.Collection.prototype.add.apply(this,arguments)},isUnique:function isUnique(t){var e=t.aliases&&s.a.union(t.aliases,t.id)||[];return!this.any((function(i){return t.id===i.id||s.a.intersection(e,i.get("aliases")).length}))},getShortcutsMap:function getShortcutsMap(){var t={};return this.each((function(e){var i=e.get("shortcut");"toggle"===s.a.first(i)&&(t[i[1]]=e)})),t},getGroups:function getGroups(){var t=s.a.unique(this.pluck("group")),e=this;return s.a.map(t,(function(t){return e.where({group:t})}))},getFirstInEachGroup:function getFirstInEachGroup(){return s.a.map(this.getGroups(),s.a.first)}})},183:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(0),r=i.n(n),a=i(2),s=i(13);function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o="spokenmathWorker";var l=new(function(){function SingletonWorker(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,SingletonWorker),this._loading=!1,this._collections=[],this._resolveCollections=this._resolveCollections.bind(this),this.getPostMessage=e.getPostMessage.bind(this),this.processReceivedMessage=e.processReceivedMessage.bind(this)}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(SingletonWorker,[{key:"process",value:function process(t){var e=this,i=this._collections;return new a.default((function(n){i.push({data:t,resolve:n}),e._loading||e._loadWorker()}))}},{key:"_loadWorker",value:function _loadWorker(){var t=this;this._loading=!0,function loadWorker(t){return new a.default((function(e){s.a.getExposedExternalBundle(t)().then((function(t){e(t)}))}))}(o).then((function(e){var i=new e,n=t._collections,a=r.a.pluck(n,"data");i.postMessage(t.getPostMessage(a)),i.addEventListener("message",(function(e){var r=e.data;i.terminate(),t._loading=!1,t._resolveCollections(t.processReceivedMessage(r)),n.length&&t._loadWorker()}))}))}},{key:"_resolveCollections",value:function _resolveCollections(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this._collections;t.length&&e.length;){var i=e.shift(),n=i.resolve;n(t.shift())}}}]),SingletonWorker}())(o,{getPostMessage:function getPostMessage(t){return{latexes:t}},processReceivedMessage:function processReceivedMessage(t){return t.value}})},184:function(t,e,i){"use strict";var n=i(1),r=i.n(n),a=i(0),s=i.n(a),o=function ScaleCompensator(t,e){var i=this;this.id=s.a.uniqueId("lrn_scale_compensator_"),this.$el=t,this.opts=e,this.scale=s.a.debounce((function(){var t=s.a.bind(i.scaleAndPosition,i);window.requestAnimationFrame?window.requestAnimationFrame(t):t()}),e.debounceTime)};s.a.extend(o.prototype,{start:function start(t){return r()(window).on("resize."+this.id+" orientationchange."+this.id+" scroll."+this.id,this.scale),this},stop:function stop(){r()(window).off("."+this.id)},scaleAndPosition:function scaleAndPosition(){var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight,i=window.innerWidth,n=window.innerHeight,r=i/t,a="scale("+r+") translateX("+window.pageXOffset/r+"px) translateY("+-(e-(window.pageYOffset+n))/r+"px)";r>.99?(this.$el.removeClass("lrn_scalable"),a=""):this.$el.addClass("lrn_scalable"),this.setTransform(a),this.opts.onUpdate(r)},setTransform:function setTransform(t){return this.$el.css({transform:t,"-moz-transform":t,"-o-transform":t,"-webkit-transform":t,"-ms-transform":t}),this},destroy:function destroy(){this.stop(),this.setTransform("").$el.removeClass("lrn_scalable"),this.$el=this.opts=null}}),e.a=o},185:function(t,e,i){"use strict";var n=i(5),r=i.n(n),a=i(127),s=i.n(a),o=i(132),l=i.n(o),c=i(159);function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u=function(){function CustomDropdown(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,CustomDropdown),_defineProperty(this,"on",r.a.Events.on),_defineProperty(this,"once",r.a.Events.once),_defineProperty(this,"off",r.a.Events.off),_defineProperty(this,"trigger",r.a.Events.trigger),_defineProperty(this,"_selectedIndex",-1),_defineProperty(this,"_value",null),_defineProperty(this,"_onChange",(function(t){var e=t.index,n=t.value;i._selectedIndex=e,i._value=n,i.trigger("change",{value:n,selectedIndex:e})})),_defineProperty(this,"_onBlur",(function(){i.trigger("blur")})),_defineProperty(this,"_onUpdateComplete",(function(){i.trigger("updateComplete")})),this.el=t,this.menuOptions=e,this.options=n,this._render()}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(CustomDropdown,[{key:"selectedIndex",get:function get(){return this._selectedIndex},set:function set(t){this._selectedIndex=t,this.component.setSelectedIndex(t)}},{key:"value",get:function get(){return this._value}},{key:"open",value:function open(t){this.component.open(t)}},{key:"close",value:function close(){this.component.close()}},{key:"isOpen",value:function isOpen(){return this.component.isOpen()}},{key:"_render",value:function _render(){var t=this.menuOptions,e=this.options;this.component=l.a.render(s.a.createElement(c.a,_extends({},e,{containerClass:"lrn_theme_primary",menuOptions:t,onChange:this._onChange,onBlur:this._onBlur,updateComplete:this._onUpdateComplete,selectedIndex:this.selectedIndex})),this.el)}}]),CustomDropdown}();e.a=u},190:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=["syntax","argument"],s=["stringMatch"];String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),e.a={processSpec:function processSpec(t){var e,i,n;if(r.a.isObject(t)&&"equivSyntax"===t.method)return r.a.isObject(t.options)&&r.a.isString(t.options.syntax)&&""!==t.options.syntax||!t.value?("\\number",n={method:"equivSyntax",value:""},i=t.options.syntax||"\\number",n.value="\\format{"+i,r.a.isNumber(t.options.argument)&&(n.value+="{"+t.options.argument+"}"),n.value+="}",r.a.isBoolean(t.options.ignoreText)&&(n.options={ignoreText:t.options.ignoreText}),n):t;for(e=0;e<a.length;e++)r.a.isObject(t.options)&&!r.a.isUndefined(t.options[a[e]])&&delete t.options[a[e]];return t},useMathCore:function useMathCore(t){return!(r.a.isObject(t)&&-1!==r.a.indexOf(s,t.method))},validate:function validate(t,e){var i,n,a,s,o,l={errorCode:0,location:void 0,message:"Normal completion",result:!1};return r.a.isObject(t)&&r.a.isString(e)&&"stringMatch"===t.method&&r.a.isString(t.value)&&(i=t.value.replace(/\\\s/g," "),n=e.replace(/\\\s/g," "),s=!r.a.isObject(t.options)||r.a.isObject(t.options)&&!1!==t.options.ignoreLeadingAndTrailingSpaces,o=!r.a.isObject(t.options)||r.a.isObject(t.options)&&!1!==t.options.treatMultipleSpacesAsOne,a=r.a.isObject(t.options)&&!0===t.options.inverseResult,s&&(i=i.trim(),n=n.trim()),o&&(i=i.replace(/\s+/g," "),n=n.replace(/\s+/g," ")),l.result=i===n,a&&(l.result=!l.result)),l}}},201:function(t,e,i){"use strict";i(5);var n=i(0),r=i.n(n),a=i(52),s=i(226),o=i.n(s),l=i(136);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}(ClozeAssociationScorer,t);var e=_createSuper(ClozeAssociationScorer);function ClozeAssociationScorer(){return _classCallCheck(this,ClozeAssociationScorer),e.apply(this,arguments)}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(ClozeAssociationScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ClozeAssociationScorer}(l.a);function clozeinlinetext_scoring_typeof(t){return(clozeinlinetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozeinlinetext_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function clozeinlinetext_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function clozeinlinetext_scoring_setPrototypeOf(t,e){return(clozeinlinetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function clozeinlinetext_scoring_createSuper(t){var e=function clozeinlinetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=clozeinlinetext_scoring_getPrototypeOf(t);if(e){var r=clozeinlinetext_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return clozeinlinetext_scoring_possibleConstructorReturn(this,i)}}function clozeinlinetext_scoring_possibleConstructorReturn(t,e){if(e&&("object"===clozeinlinetext_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function clozeinlinetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clozeinlinetext_scoring_getPrototypeOf(t){return(clozeinlinetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function clozeinlinetext_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&clozeinlinetext_scoring_setPrototypeOf(t,e)}(ClozeInlinetextScorer,t);var e=clozeinlinetext_scoring_createSuper(ClozeInlinetextScorer);function ClozeInlinetextScorer(){return clozeinlinetext_scoring_classCallCheck(this,ClozeInlinetextScorer),e.apply(this,arguments)}return function clozeinlinetext_scoring_createClass(t,e,i){return e&&clozeinlinetext_scoring_defineProperties(t.prototype,e),i&&clozeinlinetext_scoring_defineProperties(t,i),t}(ClozeInlinetextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!0}}}]),ClozeInlinetextScorer}(l.a);function clozedropdown_scoring_typeof(t){return(clozedropdown_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozedropdown_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function clozedropdown_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function clozedropdown_scoring_setPrototypeOf(t,e){return(clozedropdown_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function clozedropdown_scoring_createSuper(t){var e=function clozedropdown_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=clozedropdown_scoring_getPrototypeOf(t);if(e){var r=clozedropdown_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return clozedropdown_scoring_possibleConstructorReturn(this,i)}}function clozedropdown_scoring_possibleConstructorReturn(t,e){if(e&&("object"===clozedropdown_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function clozedropdown_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clozedropdown_scoring_getPrototypeOf(t){return(clozedropdown_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function clozedropdown_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&clozedropdown_scoring_setPrototypeOf(t,e)}(ClozeDropdownScorer,t);var e=clozedropdown_scoring_createSuper(ClozeDropdownScorer);function ClozeDropdownScorer(){return clozedropdown_scoring_classCallCheck(this,ClozeDropdownScorer),e.apply(this,arguments)}return function clozedropdown_scoring_createClass(t,e,i){return e&&clozedropdown_scoring_defineProperties(t.prototype,e),i&&clozedropdown_scoring_defineProperties(t,i),t}(ClozeDropdownScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1,strictEquality:!0,trimWhiteSpace:!0}}}]),ClozeDropdownScorer}(l.a);function clozetext_scoring_typeof(t){return(clozetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozetext_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function clozetext_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function clozetext_scoring_setPrototypeOf(t,e){return(clozetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function clozetext_scoring_createSuper(t){var e=function clozetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=clozetext_scoring_getPrototypeOf(t);if(e){var r=clozetext_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return clozetext_scoring_possibleConstructorReturn(this,i)}}function clozetext_scoring_possibleConstructorReturn(t,e){if(e&&("object"===clozetext_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function clozetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clozetext_scoring_getPrototypeOf(t){return(clozetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function clozetext_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&clozetext_scoring_setPrototypeOf(t,e)}(ClozeTextScorer,t);var e=clozetext_scoring_createSuper(ClozeTextScorer);function ClozeTextScorer(){return clozetext_scoring_classCallCheck(this,ClozeTextScorer),e.apply(this,arguments)}return function clozetext_scoring_createClass(t,e,i){return e&&clozetext_scoring_defineProperties(t.prototype,e),i&&clozetext_scoring_defineProperties(t,i),t}(ClozeTextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!0}}}]),ClozeTextScorer}(l.a);function imageclozeassociation_scoring_typeof(t){return(imageclozeassociation_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozeassociation_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function imageclozeassociation_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function imageclozeassociation_scoring_setPrototypeOf(t,e){return(imageclozeassociation_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function imageclozeassociation_scoring_createSuper(t){var e=function imageclozeassociation_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=imageclozeassociation_scoring_getPrototypeOf(t);if(e){var r=imageclozeassociation_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return imageclozeassociation_scoring_possibleConstructorReturn(this,i)}}function imageclozeassociation_scoring_possibleConstructorReturn(t,e){if(e&&("object"===imageclozeassociation_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function imageclozeassociation_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function imageclozeassociation_scoring_getPrototypeOf(t){return(imageclozeassociation_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function imageclozeassociation_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&imageclozeassociation_scoring_setPrototypeOf(t,e)}(ImageClozeAssociationScorer,t);var e=imageclozeassociation_scoring_createSuper(ImageClozeAssociationScorer);function ImageClozeAssociationScorer(){return imageclozeassociation_scoring_classCallCheck(this,ImageClozeAssociationScorer),e.apply(this,arguments)}return function imageclozeassociation_scoring_createClass(t,e,i){return e&&imageclozeassociation_scoring_defineProperties(t.prototype,e),i&&imageclozeassociation_scoring_defineProperties(t,i),t}(ImageClozeAssociationScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeAssociationScorer}(l.a);function imageclozedropdown_scoring_typeof(t){return(imageclozedropdown_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozedropdown_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function imageclozedropdown_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function imageclozedropdown_scoring_setPrototypeOf(t,e){return(imageclozedropdown_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function imageclozedropdown_scoring_createSuper(t){var e=function imageclozedropdown_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=imageclozedropdown_scoring_getPrototypeOf(t);if(e){var r=imageclozedropdown_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return imageclozedropdown_scoring_possibleConstructorReturn(this,i)}}function imageclozedropdown_scoring_possibleConstructorReturn(t,e){if(e&&("object"===imageclozedropdown_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function imageclozedropdown_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function imageclozedropdown_scoring_getPrototypeOf(t){return(imageclozedropdown_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function imageclozedropdown_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&imageclozedropdown_scoring_setPrototypeOf(t,e)}(ImageClozeDropdownScorer,t);var e=imageclozedropdown_scoring_createSuper(ImageClozeDropdownScorer);function ImageClozeDropdownScorer(){return imageclozedropdown_scoring_classCallCheck(this,ImageClozeDropdownScorer),e.apply(this,arguments)}return function imageclozedropdown_scoring_createClass(t,e,i){return e&&imageclozedropdown_scoring_defineProperties(t.prototype,e),i&&imageclozedropdown_scoring_defineProperties(t,i),t}(ImageClozeDropdownScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeDropdownScorer}(l.a);function imageclozetext_scoring_typeof(t){return(imageclozetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozetext_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function imageclozetext_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function imageclozetext_scoring_setPrototypeOf(t,e){return(imageclozetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function imageclozetext_scoring_createSuper(t){var e=function imageclozetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=imageclozetext_scoring_getPrototypeOf(t);if(e){var r=imageclozetext_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return imageclozetext_scoring_possibleConstructorReturn(this,i)}}function imageclozetext_scoring_possibleConstructorReturn(t,e){if(e&&("object"===imageclozetext_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function imageclozetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function imageclozetext_scoring_getPrototypeOf(t){return(imageclozetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m=function(t){!function imageclozetext_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&imageclozetext_scoring_setPrototypeOf(t,e)}(ImageClozeTextScorer,t);var e=imageclozetext_scoring_createSuper(ImageClozeTextScorer);function ImageClozeTextScorer(){return imageclozetext_scoring_classCallCheck(this,ImageClozeTextScorer),e.apply(this,arguments)}return function imageclozetext_scoring_createClass(t,e,i){return e&&imageclozetext_scoring_defineProperties(t.prototype,e),i&&imageclozetext_scoring_defineProperties(t,i),t}(ImageClozeTextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeTextScorer}(l.a),g=i(4),b=i(157);e.a=a.a.extend({richTextAttributes:["metadata.distractor_rationale_response_level[*]","template"],imageTemplate:o.a,RESPONSE_MARKER_REGEXP:"{{response}}",initialize:function initialize(){a.a.prototype.initialize.apply(this,arguments),this.updateValidationObject()},validateStartup:function validateStartup(){a.a.prototype.validateStartup.call(this)},processResponseValue:function processResponseValue(t){this.hasResponse()||this.set({response:{value:[],type:this.RESPONSE_TYPE.ARRAY}},{silent:!0}),this.get("response").value=t},isDefaultValidResponseValue:function isDefaultValidResponseValue(t){return 0===r.a.filter(t,(function(t){return t||0===t})).length},getScorerClass:function getScorerClass(){var t,e=this.TYPE;switch(this.get("type")){case e.CLOZETEXT:t=p;break;case e.CLOZEASSOCIATION:t=c;break;case e.CLOZEDROPDOWN:t=h;break;case e.CLOZEINLINETEXT:t=u;break;case e.IMAGECLOZEASSOCIATION:t=d;break;case e.IMAGECLOZEDROPDOWN:t=f;break;case e.IMAGECLOZETEXT:t=m}return t},validateResponse:function validateResponse(){var t=this.getScorer(),e=t.error();if(!e)return t.validateIndividualResponses();if("MathQuestionException"!==e.name)throw e;"user"!==e.location&&g.a.exception({code:10019,detail:e.message,i18n:this.activity.get("i18n")})},isImageCloze:function isImageCloze(){var t=this.TYPE;return r.a.include([t.IMAGECLOZETEXT,t.IMAGECLOZEASSOCIATION,t.IMAGECLOZEDROPDOWN,t.IMAGECLOZEFORMULA,t.IMAGECLOZECHEMISTRY],this.get("type"))},getDynamicShuffleSeed:function getDynamicShuffleSeed(){return new b.a(this).getDynamicSeed()},getContentTemplate:function getContentTemplate(){if(this.isImageCloze()){var t=o.a,e=this.get("question"),i={img_alt:!!e.img_alt&&e.img_alt,img_title:!!e.img_title&&e.img_title,img_src:e.img_src,response_positions:e.response_positions,response_container:e.response_container,padding:!!e.padding&&e.padding,question_type:this.get("type")};return e.image&&(e.image.src&&(i.img_src=e.image.src),e.image.alt&&(i.img_alt=e.image.alt),e.image.title&&(i.img_title=e.image.title)),t({displayLogic:i})}return this.get("question").template},getImageClozeAriaLabels:function getImageClozeAriaLabels(){if(this.isImageCloze())return r.a.isUndefined(this._ariaLabels)&&(this._ariaLabels=r.a.map(this.get("question").aria_labels,(function(t){return r.a.escape(t)}))),this._ariaLabels},updateValidationObject:function updateValidationObject(){var t=this.get("question");if(t.hasOwnProperty("valid_responses")){var e,i,n,a=[],s=[],o=!0;r.a.each(t.valid_responses,(function(t,l){a[l]=[],s[l]=[],r.a.each(t,(function(t,c){i=r.a.isUndefined(t.value)?null:t.value,null!==(n=r.a.isUndefined(t.score)?null:t.score)&&(n=parseInt(n,10)),a[l].push(i),s[l].push(n),r.a.isUndefined(e)?e=n:o&=e===n}))})),delete t.valid_responses,t.validation={valid_responses:a},e=o?e:s,r.a.isNull(e)||(t.validation.valid_score=e),this.set({question:t},{silent:!0}),this.trackEvent("Updated pre v1.24.0 question object.")}},getCorrectByIndex:function getCorrectByIndex(t){if(this.canValidateResponse())return this.getValidResponse().value[t]},isVerticalTopContainer:function isVerticalTopContainer(){return r.a.isUndefined(this._verticalTop)&&(this._verticalTop=!!this.isImageCloze()&&!!r.a.getNested(this.get("question"),"response_container.vertical_top")),this._verticalTop},getIgnoreLeadingAndTrailingSpaces:function getIgnoreLeadingAndTrailingSpaces(){var t=this.get("question").ignore_leading_and_trailing_spaces;return!r.a.isBoolean(t)||t}})},212:function(t,e,i){"use strict";i.d(e,"a",(function(){return applySelectiveFontBoost}));var n=i(7),r=i.n(n);function applySelectiveFontBoost(t,e){t&&!e&&r.a.isWindows&&[].slice.call(t.querySelectorAll(".mq-math-mode span")).filter((function(t){return"−"===t.textContent})).forEach((function(t){t.style.fontSize="120%"}))}},213:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_incorrectBubble"><strong>'+(null==(__t=labels.correctAnswer)?"":__t)+':</strong><p class="lrn_answer">'+(null==(__t=correctAnswer)?"":__t)+"</p></div>";return __p}},217:function(t,e,i){"use strict";var n=i(206),r=i.n(n),a=i(190);e.a=function validateSingleSpec(t,e){return a.a.useMathCore(t)?r.a.evaluateVerbose(a.a.processSpec(t),e):a.a.validate(t,e)}},218:function(t,e,i){"use strict";i.d(e,"a",(function(){return mathAccessibility}));var n=i(0),r=i.n(n);function mathAccessibility(t,e){t.processAccessibility=r.a.wrap(t.processAccessibility,(function(e,i){(i=i||{}).getSourceText=function(t){return t.find(".lrn-spokenmath").text()},e.call(t,i)})),t.activity.get("state")===t.activity.STATE.REVIEW&&(t.processAccessibility=r.a.wrap(t.processAccessibility,(function(i,n){var a=e(),s=0;r.a.each(a,(function(e){var r=e.mathEvents;t.listenToOnce(r,r.EVENT.EDITOR_SPOKENMATH_UPDATED,(function(){++s===a.length&&i.call(t,n)}))}))})))}},220:function(t,e,i){"use strict";var n=i(1),r=i.n(n),a=i(0),s=i.n(a),o=i(53),l=i(250),c=i.n(l),u=i(213),h=i.n(u),p=i(11),d=i(24),f=(i(7),o.a.extend({template:c.a,responseMarkerRegExp:void 0,responseValue:[],showingValidationUI:!1,previousResponseValue:[],readOnly:!1,validGap:11,pointLeftRightGap:1.4,pointerWidth:20,pointerTopBottomHeight:25,pointerLeftRightHeight:36,pointerHeight:"10px",RESPONSE_CONTAINER_DEFAULT_DATA:{defaultData:{bottom:"0px",width:"96px",height:"2.3em"},imageclozeassociation:{width:"20px"},imageclozedropdown:{width:"50px"}},responseContainerDefaultInputType:"text",responseContainerInputTypes:["text","number"],incorrectAnswerBubbleTemplate:h.a,initialize:function initialize(){var t,e;o.a.prototype.initialize.call(this),this.jqNamespace=".lrn-cloze-".concat(this.cid),this.events=s.a.extend({},f.prototype.events,this.events),this.activity=this.options.activity,this.i18n=this.activity.get("i18n"),this.responseMarkerRegExp=new RegExp(this.model.RESPONSE_MARKER_REGEXP,"g"),t=this.model.getContentTemplate().match(this.responseMarkerRegExp),this.responseValue=[],this.responseValue.length=t?t.length:0;for(var i=0;i<this.responseValue.length;i++)this.responseValue[i]=null;this.activity.get("state")===this.activity.STATE.RESUME&&this.model.hasResponse()&&(this.responseValue=this.model.getResponseValue()||[]),this.responseContainerDefaultData=s.a.extend({},this.RESPONSE_CONTAINER_DEFAULT_DATA.defaultData),(e=this.RESPONSE_CONTAINER_DEFAULT_DATA[this.model.get("type")])&&s.a.extend(this.responseContainerDefaultData,e),this.readOnly=this.activity.get("state")===this.activity.STATE.REVIEW||this.activity.get("state")===this.activity.STATE.PREVIEW,this.displayLogic={},this.addRenderingLogic(),this.render(),this.initialisationCompleted()},render:function render(t){var e,i=this.model,n=this,a=i.get("question"),o=i.isVerticalTopContainer();function resizeImage(){var t=function setWidth(){return Object(d.a)(n.$el,(function(){n.setImageWidth()}))};t(),n.isListeningToWindowResize||(r()(window).on("resize"+n.jqNamespace,t),n.isListeningToWindowResize=!0)}function resizeImageOnLoad(){var t=n.$(".lrn_imagecloze_image");t.prop("complete")?resizeImage():t.on("load",resizeImage)}return e=t||this.template({questionResponse:i,displayLogic:this.displayLogic,labels:this.i18n.labels}),this.renderViewContent(e,this.extraClasses),this.displayLogic.isReviewState&&this.renderValidatableUI(),this.$el.toggleClass("lrn_cloze_vertical_top_none",!o),this.displayLogic.isMath&&i.isImageCloze()&&s.a.hasProperty(a,"ui_style.possibility_list_position")&&("left"===a.ui_style.possibility_list_position||"right"===a.ui_style.possibility_list_position)?this.mathquillRendering()?(this.renderMathquill(),resizeImageOnLoad()):p.a.once(p.a.EVENT.RENDERED,resizeImageOnLoad):resizeImageOnLoad(),this},setImageWidth:function setImageWidth(){var t=this.$(".lrn_imagecloze_image"),e=this.$(".lrn_possibilityList"),i=this.$(".lrn_imagecloze_container"),n=this.$(".lrn_cloze_response_container"),r=this.$(".lrn_response_input"),a=this.$(".lrn_response_innerbody");n.add(a).add(i).add(t).css({maxWidth:"",width:""});var o,l,c,u,h,p,d=2*parseFloat(r.css("padding-left"),10)||0,f=a.innerWidth(),m=e.length,g=this.getScaledWidth(t.width());return t.css({width:g}),n.css({"max-width":f,display:"block"}),m&&(l=e.css("position"),e.css("position","absolute"),c=this.model.get("question"),p=s.a.hasProperty(c,"ui_style.possibility_list_position")&&("left"===c.ui_style.possibility_list_position||"right"===c.ui_style.possibility_list_position),o=this.$(".lrn_response_innerbody"),u=r.outerWidth(),h=0,e.css("position",l),p&&(h=e.outerWidth()),n.css({width:this.getScaledWidth(u+h+d)}),o.css({"max-width":f,width:this.getScaledWidth(u+h+d)})),i.css({width:t.width()}),g},getScaledWidth:function getScaledWidth(t){return this.displayLogic.imageScale?t/this.model.FONTSIZE_MAP[this.model.FONTSIZE.NORMAL]+"em":t},addRenderingLogic:function addRenderingLogic(){o.a.prototype.addRenderingLogic.call(this);var t=this,e=this.model.get("question"),i=this.activity.get("state")===this.activity.STATE.REVIEW;this.displayLogic.readOnly=i||this.activity.get("state")===this.activity.STATE.PREVIEW,this.displayLogic.multipleResponses=this.responseValue&&this.responseValue.length>1,this.displayLogic.isMath=!!e.is_math,s.a.isObject(this.displayLogic.responseContainer)||(this.displayLogic.responseContainer={}),this.displayLogic.responseContainer.inputType=this.responseContainerDefaultInputType,s.a.isObject(e.response_container)&&(e.response_container.hasOwnProperty("width")&&(this.displayLogic.responseContainer.width=e.response_container.width,e.response_container.width.indexOf("%")>0&&(this.displayLogic.responseContainer.fluid_width=!0)),e.response_container.hasOwnProperty("height")&&(this.displayLogic.responseContainer.height=e.response_container.height,e.response_container.height.indexOf("%")>0&&(this.displayLogic.responseContainer.fluid_height=!0)),e.response_container.hasOwnProperty("placeholder")&&(this.displayLogic.responseContainer.placeholder=e.response_container.placeholder,this.displayLogic.responseContainer.showPlaceholder=!s.a.isEmpty(e.response_container.placeholder)&&!this.displayLogic.readOnly),e.response_container.hasOwnProperty("pointer")&&(this.displayLogic.responseContainer.pointer=e.response_container.pointer),e.response_container.hasOwnProperty("wordwrap")&&(this.displayLogic.responseContainer.wordwrap=e.response_container.wordwrap),s.a.contains(this.responseContainerInputTypes,e.response_container.input_type)&&(this.displayLogic.responseContainer.inputType=e.response_container.input_type)),e.image&&(this.displayLogic.imageScale=e.image.scale),this.extraClasses="lrn_cloze";var n=this.model.getContentTemplate(),r=-1;n=n.replace(this.responseMarkerRegExp,(function(){return r++,t.getResponseInputHTML(r,t.getPointerVars(r))})),this.displayLogic.processedTemplate=n,this.displayLogic.extraContentHTML=this.getExtraContentHTML()},getResponseInputHTML:function getResponseInputHTML(t){return"{replacedInput"+t+"}"},getExtraContentHTML:function getExtraContentHTML(){return null},showCorrectAnswer:function showCorrectAnswer(){this.showCorrectAnswerList()},showCorrectAnswersHover:function showCorrectAnswersHover(){throw new Error("Unimplemented function showCorrectAnswersHover for question type:"+this.model.get("type"))},getResponseContainerFor:function getResponseContainerFor(t){var e=this.model.get("question"),i=s.a.extend({},this.displayLogic.responseContainer);return s.a.isArray(e.response_containers)&&s.a.isObject(e.response_containers[t])&&(s.a.extend(i,e.response_containers[t]),s.a.contains(this.responseContainerInputTypes,e.response_containers[t].input_type)&&(i.inputType=e.response_containers[t].input_type),i.showPlaceholder=!s.a.isEmpty(i.placeholder)&&!this.displayLogic.readOnly),i},getImageClozeAriaLabelFor:function getImageClozeAriaLabelFor(t){var e=this.model.getImageClozeAriaLabels();if(s.a.isArray(e))return e[t]},getPointerVars:function getPointerVars(t){if(!this.model.isImageCloze())return{};var e=this.model.getFontSize(),i=this.getResponseContainerFor(t),n=this.getPixel(i.width||this.responseContainerDefaultData.width,e),r=this.getPixel(i.height||this.responseContainerDefaultData.height,e),a=this.getPixel(i.height||this.responseContainerDefaultData.bottom,e),s=(this.getPixel(this.pointerHeight,e),{position:i.pointer});switch(this.model.get("type")===this.model.TYPE.IMAGECLOZEDROPDOWN&&(this.validGap=0),this.model.get("type")===this.model.TYPE.IMAGECLOZETEXT&&(this.responseContainerDefaultHeight="24px"),i.pointer){case"top":s.top=r/2+this.getPointLeftRightGap()+"px",s.left=this.getEm(-1*(Math.ceil((n-this.pointerWidth)/2)+2));break;case"right":s.right=this.pointerWidth/2+this.getPointLeftRightGap()+"px",s.top=this.getEm(-1*Math.floor((r-this.pointerLeftRightHeight)/2));break;case"bottom":s.bottom=a+this.getPointLeftRightGap()/2+"px",s.left=this.getEm(-1*(Math.ceil((n-this.pointerWidth)/2)+2));break;case"left":s.left=this.pointerWidth*this.pointLeftRightGap+this.getPointLeftRightGap()+"px",s.top=this.getEm(-1*Math.floor((r-this.pointerLeftRightHeight)/2));break;default:s={}}return s},getPointLeftRightGap:function getPointLeftRightGap(){if(!this._pointLeftRightGap){var t=this.model.getFontSize();this._pointLeftRightGap=this.pointLeftRightGap*t}return this._pointLeftRightGap},getPixel:function getPixel(t,e){var i=(t=t.toString()).substr(-2),n=parseFloat(t.substr(0,t.length-2));return"em"===i?n*e:n},getEm:function getEm(t,e,i){var n=t/(i?this.model.FONTSIZE_MAP.normal:this.model.getFontSize());return e?n:n+"em"},remove:function remove(){r()(window).off(this.jqNamespace),o.a.prototype.remove.call(this)}}));e.a=f},226:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_imagecloze_container"'+(null==(__t=displayLogic.padding?' style="padding: '+displayLogic.padding+'px"':"")?"":__t)+' ><img draggable="false"',displayLogic.img_alt&&(__p+='alt="'+(null==(__t=displayLogic.img_alt)?"":_.escape(__t))+'"'),__p+="",displayLogic.img_title&&(__p+='title="'+(null==(__t=displayLogic.img_title)?"":_.escape(__t))+'"'),__p+='class="lrn_imagecloze_image"src="'+(null==(__t=displayLogic.img_src)?"":_.escape(__t))+'">',_.each(displayLogic.response_positions,(function(t){__p+='<div class="lrn_imagecloze_response" style="left:'+(null==(__t=t.x)?"":__t)+"%;top:"+(null==(__t=t.y)?"":__t)+"%;",displayLogic.response_container&&"imageclozeassociation"===displayLogic.question_type&&(__p+="",displayLogic.response_container.hasOwnProperty("height")&&(__p+="height:"+(null==(__t=displayLogic.response_container.height)?"":__t)+";"),__p+=""),__p+='">{{response}}</div>'})),__p+="</div>";return __p}},228:function(t,e,i){"use strict";var n=i(289),r=i.n(n),a=i(190);e.a=function validateSingleSpec(t,e){return a.a.useMathCore(t)?r.a.evaluateVerbose(t,e):a.a.validate(t,e)}},250:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_cloze_response_container">'+(null==(__t="clozeassociation"==displayLogic.questiontype?'<div class="lrn_response_input_wrapper lrn-response-validate-wrapper">':"")?"":__t)+(null==(__t="imageclozeassociation"==displayLogic.questiontype?'<div class="lrn_response_input_wrapper lrn_response_input_wrapper_left lrn-response-validate-wrapper">':"")?"":__t)+'<div class="lrn_response_innerbody '+(null==(__t="imageclozeassociation"!=displayLogic.questiontype&&"clozeassociation"!=displayLogic.questiontype?"lrn-response-validate-wrapper":"")?"":__t)+'">',_.isUndefined(displayLogic.possibilityListPosition)||"top"!==displayLogic.possibilityListPosition&&"left"!==displayLogic.possibilityListPosition||(__p+="",displayLogic.extraContentHTML&&(__p+=""+(null==(__t=displayLogic.extraContentHTML)?"":__t)),__p+=""),__p+="",_.isUndefined(displayLogic.possibilityListPosition)||"left"!==displayLogic.possibilityListPosition&&"right"!==displayLogic.possibilityListPosition||(__p+='<div class="lrn_response_input_position">'),__p+='<div class="lrn_response_input lrn_response_math'+(null==(__t=displayLogic.hasBoostedFont?" lrn_response_font_boost":"")?"":__t)+'" aria-label="'+(null==(__t=displayLogic.questionText)?"":_.escape(__t))+'">'+(null==(__t=displayLogic.processedTemplate)?"":__t)+"</div>",_.isUndefined(displayLogic.possibilityListPosition)||"left"!==displayLogic.possibilityListPosition&&"right"!==displayLogic.possibilityListPosition||(__p+="</div>"),__p+="",(_.isUndefined(displayLogic.possibilityListPosition)||_.isNull(displayLogic.possibilityListPosition)||"bottom"===displayLogic.possibilityListPosition||"right"===displayLogic.possibilityListPosition)&&(__p+="",displayLogic.extraContentHTML&&(__p+=""+(null==(__t=displayLogic.extraContentHTML)?"":__t)),__p+=""),__p+="</div>"+(null==(__t="imageclozeassociation"==displayLogic.questiontype||"clozeassociation"==displayLogic.questiontype?"</div>":"")?"":__t)+'</div><div class="lrn_correctAnswers lrn_hide"><span>'+(null==(__t=labels.correctAnswers)?"":__t)+':</span><ul class="lrn_correctAnswerList"></ul></div>',displayLogic.showValidationButton&&(__p+='<button type="button" '+(null==(__t=displayLogic.readOnly?'disabled="disabled"':"")?"":__t)+' class="lrn_btn lrn_validate"><span>'+(null==(__t=displayLogic.multipleResponses?labels.checkAnswers:labels.checkAnswer)?"":__t)+"</span></button>"),__p+="";return __p}},251:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",displayLogic.showInputUi&&(__p+='<div class="lrn_input_ui">\x3c!-- Keyboard --\x3e</div>'),__p+="";return __p}},252:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span data-lrn-access-review-dest class="lrn_textinput lrn-clozeformula-input lrn_cloze_response '+(null==(__t=displayLogic.readOnly?" lrn_disabled":"")?"":__t)+'"data-inputid="'+(null==(__t=displayLogic.inputId)?"":__t)+'"',(displayLogic.responseContainer.hasOwnProperty("width")||displayLogic.responseContainer.hasOwnProperty("height"))&&(__p+='style="',displayLogic.responseContainer.width&&(__p+="min-width: "+(null==(__t=displayLogic.responseContainer.width)?"":__t)+";"),displayLogic.responseContainer.height&&(__p+="min-height: "+(null==(__t=displayLogic.responseContainer.height)?"":__t)+";"),__p+='"'),__p+="></span>";return __p}},269:function(t,e,i){"use strict";var n=i(1),r=i.n(n),a=(i(5),i(0)),s=i.n(a),o=i(163),l=i(164),c=i(26),u=i(148),h=i(220),p=i(251),d=i.n(p),f=(i(213),i(252)),m=i.n(f),g=i(218),b=i(212);e.a=h.a.extend({clozeFormulaExtraHtmlTemplate:d.a,clozeFormulaSpan:m.a,defaultUiStyle:l.a.prototype.TYPE.FLOATING_KEYBOARD,addFacadeMethods:c.a.addFacadeMethods,addRenderingLogic:function addRenderingLogic(){var t=this.activity.get("state")===this.activity.STATE.REVIEW,e=this.activity.get("state")===this.activity.STATE.PREVIEW,i=t||e,n=this.model.get("question").ui_style||{},r=n.type||this.defaultUiStyle,a=n&&n.disable_input,s=!(r===l.a.prototype.TYPE.NO_INPUT_UI)&&!i;this.displayLogic.hasBoostedFont="normal"!==n.response_font_scale,this.displayLogic.disableInput=a,this.displayLogic.showInputUi=s,this.displayLogic.uiStyleType=r,this.displayLogic.uiBelowResponse=!!n.keyboard_below_response_area,h.a.prototype.addRenderingLogic.call(this)},cacheOriginalHeight:function cacheOriginalHeight(){var t=this.$(".lrn_response_input").outerHeight();t>0&&(this.originalHeight=t)},clearValidationUI:function clearValidationUI(){this.readOnly||(this.displayLogic.enableCorrectAnswerHover=!1,this.showingValidationUI&&(this.$(".lrn_correct,.lrn_incorrect,.lrn_correct_marker,.lrn_incorrect_marker,.lrn_not_attempted").removeClass("lrn_correct lrn_incorrect lrn_correct_marker lrn_incorrect_marker lrn_not_attempted"),this.showingValidationUI=!1),h.a.prototype.clearValidationUI.call(this)),this.clearCorrectAnswers()},createMathEditor:function createMathEditor(t,e){var i,n,r=this,a=this.model,l=a.get("question"),u=a.getResponseValue(),h=a.get("response")&&a.get("response").responses,p=this.activity.get("disable_spokenmath_user_inputs"),d=l.response_container;return s.a.isArray(l.response_containers)&&e<l.response_containers.length&&(d=s.a.extend({},d,l.response_containers[e])),i=d&&d.template||"",n=new o.a({el:t,editables:h&&h[e]||[],disableSpokenmathUserInputs:p,value:u&&u[e]||"",disableInput:this.displayLogic.disableInput,readOnly:this.displayLogic.readOnly,clozeBordering:!0,template:i.replace(/^{{response}}$/,""),symbols:l.symbols,i18n:this.i18n,ui_style:l.ui_style,showInputUi:this.displayLogic.showInputUi,response_container:d,text_blocks:l.text_blocks,persistent_id:"formulaeditor"+e,disableItalics:c.a.isChemistry.call(this)}),this.listenTo(n.mathEvents,"all",(function(){Array.prototype.splice.call(arguments,1,0,n),r.trigger.apply(r,arguments)})),n},getCorrectResponseTextByIndex:function getCorrectResponseTextByIndex(t){var e=this.model.getCorrectByIndex(t);return"\\("+s.a.escape(e)+"\\)"},getExtraContentHTML:function getExtraContentHTML(){return this.clozeFormulaExtraHtmlTemplate({displayLogic:this.displayLogic})},getResponseInputHTML:function getResponseInputHTML(t){var e={inputId:t};return s.a.extend(e,this.displayLogic),e.responseContainer=this.getResponseContainerFor(t),this.clozeFormulaSpan({displayLogic:e})},insertUiKeyboard:function insertUiKeyboard(t){var e=this.model.get("question"),i=this.model.get("response"),n=t.find(".lrn_response_input")[0],r=this.activity.get("disable_spokenmath_user_inputs");this.keyboardView=new l.a({el:t.find("div.lrn_input_ui")[0],disableSpokenmathUserInputs:r,horizontalParent:n,mathEvents:s.a.size(this.inputs)>0?s.a.first(this.inputs).mathEvents:new u.a,symbols:e.symbols,showHints:s.a.isUndefined(e.showHints)||!0===e.showHints,security:this.activity.get("security"),handwriting:i&&i.handwriting,handwritingRecognises:e.handwriting_recognises,lazy:c.a.usesLazyKeyboard(this.options.activity),uiStyleType:this.displayLogic.uiStyleType,immutablePositioner:this.displayLogic.uiBelowResponse&&n,i18n:this.i18n,chemistry:c.a.isChemistry.call(this),numberPad:e.numberPad,horizontalLayout:e.horizontal_layout,horizontalPad:e.horizontalPad,uiBelowResponse:this.displayLogic.uiBelowResponse})},onAttach:function onAttach(){c.a.onAttach.call(this),s.a.invoke(this.inputs,"onAttach")},onItemBlurred:function onItemBlurred(t){var e=t.mathEvents,i=this.$(".lrn_response_innerbody").get(0),n=this.keyboardView&&this.keyboardView.el;c.a.onItemBlurred(e,i,n)},render:function render(){var t,e=this;this.model.get("question");if(this.inputs={},this.responseResponses=[],this.activity.get("state")===this.activity.STATE.RESUME&&this.model.hasResponse())this.responseResponses=this.model.get("response").responses;else for(var i=0;i<this.responseValue.length;i++)this.responseResponses[i]=null;return(t=r()(this.template({questionResponse:this.model,displayLogic:this.displayLogic,labels:this.i18n.labels}))).find(".lrn-clozeformula-input").each((function(t){var i=r()(this).data("inputid");e.inputs[i]=e.createMathEditor(this,t)})),Object(g.a)(this,(function(){return s.a.values(e.inputs)})),this.on(u.a.UPDATED,this.updateModel,this),this.on(u.a.ITEM_BLURRED,this.onItemBlurred,this),this.on(u.a.EDITOR_FOCUSED,this.setActiveEditor,this),this.displayLogic.showInputUi&&this.insertUiKeyboard(t),h.a.prototype.render.call(this,t),this.setMinWidth(),this.cacheOriginalHeight(),this},setActiveEditor:function setActiveEditor(t){this.clearValidationUI(),this.updateHeight(),this.keyboardView&&this.keyboardView.setPositioner(t.el).setMathEvents(t.mathEvents).show()},setDisabled:function setDisabled(t){c.a.setDisabled(this.inputs,t),this.showingValidationUI&&this.showValidationUI(),this.setButtonsDisabled(t)},setImageWidth:function setImageWidth(){var t=!0===s.a.getNested(this.model.get("question"),"image.prevent_scale");if(t)this.preventImageScale();else{var e=h.a.prototype.setImageWidth.apply(this,arguments);this.keyboardView&&this.keyboardView.notifyContainerWidth(e),this.cacheOriginalHeight()}},preventImageScale:function preventImageScale(){var t=this.$(".lrn_imagecloze_image"),e=this.$(".lrn_cloze_response_container"),i=t.width()+2;t.css("max-width","none"),e.css({"max-width":i,width:i})},setMinWidth:function setMinWidth(){var t=s.a.isObject(this.model.get("question").ui_style)&&!s.a.isUndefined(this.model.get("question").ui_style.min_width)?this.model.get("question").ui_style.min_width:null;this.$el.find(".lrn_response_input").css("min-width",t)},showValidationUI:function showValidationUI(){var t=h.a.prototype.showValidationUI.call(this)||[],e=this.model.getResponseValue()||this.responseValue;s.a.each(e,(function(e,i){var n=this.responseResponses[i]||[],r=this.inputs[i].$el;t[i]?r.addClass("lrn_correct"):e&&!n.length||n.join("").length?r.addClass("lrn_incorrect"):r.addClass("lrn_not_attempted"),this.displayLogic.displayCorrectAnswer&&r.prepend('<span class="lrn_responseIndex">'+this.getResponseIndexLabel(i)+"</span>")}),this),c.a.addAriaLabelToValidationUi.call(this)},updateHeight:function updateHeight(){var t=!0===s.a.getNested(this.model.get("question"),"image.prevent_scale"),e=0;this.$(".lrn_imagecloze_response").each((function(){var t=r()(this),i=t.position().top+t.outerHeight();e=i>e?i:e})),e>this.originalHeight&&!t&&this.$(".lrn_response_input").height(e)},updateModel:function updateModel(t,e,i){var n=t.$el.data("inputid");this.responseValue[n]=e,this.responseResponses[n]=i,this.model.updateResponseValue({value:this.responseValue,responses:this.responseResponses,handwriting:this.keyboardView&&this.keyboardView.getHandwriting()}),this.clearValidationUI(),this.updateHeight(),Object(b.a)(this.el,this.displayLogic.hasBoostedFont)},showCorrectAnswer:function showCorrectAnswer(){c.a.addAriaLabelToValidationUi.call(this),this.showCorrectAnswerList()},getReviewAriaLabel:function getReviewAriaLabel(t){return(t=t.clone()).text("response"),h.a.prototype.getReviewAriaLabel.call(this,t)}})},272:function(t,e,i){"use strict";var n=i(0),r=i.n(n),a=i(201),s=i(136),o=i(206),l=i.n(o),c=i(217);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=_getPrototypeOf(t);if(e){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}(ClozeFormulaScorer,t);var e=_createSuper(ClozeFormulaScorer);function ClozeFormulaScorer(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,ClozeFormulaScorer);var n=i.includeError;return r.a.isObject(i)&&r.a.isNumber(i.mathcoreTimeoutDuration)?l.a.setTimeoutDuration(i.mathcoreTimeoutDuration):l.a.setTimeoutDuration(5e3),e.call(this,t,{includeError:n})}return function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(ClozeFormulaScorer,[{key:"flags",get:function get(){return{validateSingleSpec:c.a}}}]),ClozeFormulaScorer}(s.a);function clozeformulaV2_scoring_typeof(t){return(clozeformulaV2_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozeformulaV2_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function clozeformulaV2_scoring_setPrototypeOf(t,e){return(clozeformulaV2_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function clozeformulaV2_scoring_createSuper(t){var e=function clozeformulaV2_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=clozeformulaV2_scoring_getPrototypeOf(t);if(e){var r=clozeformulaV2_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return clozeformulaV2_scoring_possibleConstructorReturn(this,i)}}function clozeformulaV2_scoring_possibleConstructorReturn(t,e){if(e&&("object"===clozeformulaV2_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function clozeformulaV2_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clozeformulaV2_scoring_getPrototypeOf(t){return(clozeformulaV2_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function clozeformulaV2_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&clozeformulaV2_scoring_setPrototypeOf(t,e)}(ClozeFormulaV2Scorer,t);var e=clozeformulaV2_scoring_createSuper(ClozeFormulaV2Scorer);function ClozeFormulaV2Scorer(){return clozeformulaV2_scoring_classCallCheck(this,ClozeFormulaV2Scorer),e.apply(this,arguments)}return ClozeFormulaV2Scorer}(u),p=i(228);function clozechemistry_scoring_typeof(t){return(clozechemistry_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozechemistry_scoring_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function clozechemistry_scoring_defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function clozechemistry_scoring_setPrototypeOf(t,e){return(clozechemistry_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function clozechemistry_scoring_createSuper(t){var e=function clozechemistry_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,n=clozechemistry_scoring_getPrototypeOf(t);if(e){var r=clozechemistry_scoring_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return clozechemistry_scoring_possibleConstructorReturn(this,i)}}function clozechemistry_scoring_possibleConstructorReturn(t,e){if(e&&("object"===clozechemistry_scoring_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function clozechemistry_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clozechemistry_scoring_getPrototypeOf(t){return(clozechemistry_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function clozechemistry_scoring_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&clozechemistry_scoring_setPrototypeOf(t,e)}(ClozeChemistryScorer,t);var e=clozechemistry_scoring_createSuper(ClozeChemistryScorer);function ClozeChemistryScorer(){return clozechemistry_scoring_classCallCheck(this,ClozeChemistryScorer),e.apply(this,arguments)}return function clozechemistry_scoring_createClass(t,e,i){return e&&clozechemistry_scoring_defineProperties(t.prototype,e),i&&clozechemistry_scoring_defineProperties(t,i),t}(ClozeChemistryScorer,[{key:"flags",get:function get(){return{validateSingleSpec:p.a}}}]),ClozeChemistryScorer}(s.a);e.a=a.a.extend({processResponseValue:function processResponseValue(t){var e=this.hasResponse();if(!e||!t){var i=e?this.get("response").dynamic:void 0,n={value:[],responses:{},type:this.RESPONSE_TYPE.ARRAY};i&&(n.dynamic=i),this.set({response:n},{silent:!0})}t&&r.a.deepExtend(this.get("response"),t)},isDefaultValidResponseValue:function isDefaultValidResponseValue(t){var e=function hasInnerValue(t){return r.a.isObject(t)&&(t.value||t.method)};return 0===r.a.filter(t,(function(t){return r.a.isArray(t)&&0!==r()(t).filter(e).length})).length},getScorerClass:function getScorerClass(){var t;switch(this.get("type")){case this.TYPE.CLOZEFORMULA:t=u;break;case this.TYPE.CLOZEFORMULAV2:t=h;break;case this.TYPE.IMAGECLOZEFORMULA:t=u;break;case this.TYPE.CLOZECHEMISTRY:case this.TYPE.IMAGECLOZECHEMISTRY:t=d}return t},getScorer:function getScorer(){if(!this.scorer||this._prevModifiedForScorer!==this.lastModified)if(this._prevModifiedForScorer=this.lastModified,this.scorer)this.scorer.reset(this.toJSON());else{var t=this.getScorerClass();0,this.scorer=new t(this.toJSON(),{mathcoreTimeoutDuration:5e3,includeError:!1})}return this.scorer},getCorrectByIndex:function getCorrectByIndex(t){if(this.canValidateResponse()){this.get("question");var e,i=this.getValidResponse().value;return r.a.isArray(i)&&i.length>t&&(i=i[t],r.a.isArray(i)&&(e=r.a.find(i,(function(t){return r.a.isObject(t)&&r.a.isString(t.value)})))),e?e.value:""}}})},63:function(t,e,i){var n,r;n=[i(1)],void 0===(r=function(t){var e="mathquill-command-id",i="mathquill-block-id",n=Math.min,r=Math.max;function noop(){}var a=[].slice;function variadic(t){var e=t.length-1;return function(){var i=a.call(arguments,0,e),n=a.call(arguments,e);return t.apply(this,i.concat([n]))}}var s=variadic((function(t,e){return variadic((function(i,n){if(t in i)return i[t].apply(i,e.concat(n))}))}));function iterator(t){return variadic((function(e,i){"function"!=typeof e&&(e=s(e));return t.call(this,(function(t){return e.apply(t,[t].concat(i))}))}))}function bind(t){var e=a.call(arguments,1);return function(){return t.apply(this,e)}}function pray(t,e){if(!e)throw new Error("prayer failed: "+t)}var o=function(t,e,i){function isObject(t){return"object"==typeof t}function isFunction(t){return"function"==typeof t}function SuperclassBare(){}return function P(t,i){function C(){var t=new Bare;return isFunction(t.init)&&t.init.apply(t,arguments),t}function Bare(){}void 0===i&&(i=t,t=Object),C.Bare=Bare;var n,r=SuperclassBare.prototype=t.prototype,a=Bare.prototype=C.prototype=C.p=new SuperclassBare;return a.constructor=C,C.mixin=function(t){return Bare.prototype=C.prototype=P(C,t).prototype,C},(C.open=function(i){if(n={},isFunction(i)?n=i.call(C,a,r,C,t):isObject(i)&&(n=i),isObject(n))for(var s in n)e.call(n,s)&&(a[s]=n[s]);return isFunction(a.init)||(a.init=t),C})(i)}}(0,{}.hasOwnProperty),l=MathQuill.L=-1,c=MathQuill.R=1;function prayDirection(t){pray("a direction was passed",t===l||t===c)}var u=o(t,(function(t){t.insDirOf=function(t,e){return t===l?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===l?this.prependTo(e):this.appendTo(e)}})),h=o((function(t){t.parent=0,t[l]=0,t[c]=0,t.init=function(t,e,i){this.parent=t,this[l]=e,this[c]=i},this.copy=function(t){return h(t.parent,t[l],t[c])}})),p=o((function(t){t[l]=0,t[c]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=function uniqueNodeId(){return e+=1}(),p.byId[this.id]=this,this.ends={},this.ends[l]=0,this.ends[c]=0},t.dispose=function(){delete p.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=u(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){t=u(t||this.html());function jQadd(t){if(t.getAttribute){var e=t.getAttribute("mathquill-command-id"),i=t.getAttribute("mathquill-block-id");e&&p.byId[e].jQadd(t),i&&p.byId[i].jQadd(t)}for(t=t.firstChild;t;t=t.nextSibling)jQadd(t)}for(var e=0;e<t.length;e+=1)jQadd(t[e]);return t},t.createDir=function(t,e){prayDirection(t);return this.jQize(),this.jQ.insDirOf(t,e.jQ),e[t]=this.adopt(e.parent,e[l],e[c]),this},t.createLeftOf=function(t){return this.createDir(l,t)},t.selectChildren=function(t,e){return y(t,e)},t.bubble=iterator((function(t){for(var e=this;e;e=e.parent){if(!1===t(e))break}return this})),t.postOrder=iterator((function(t){return function recurse(e){e.eachChild(recurse),t(e)}(this),this})),t.isEmpty=function(){return 0===this.ends[l]&&0===this.ends[c]},t.children=function(){return d(this.ends[l],this.ends[c])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,i,n){return d(this,this).withDirAdopt(t,e,i,n),this},t.adopt=function(t,e,i){return d(this,this).adopt(t,e,i),this},t.disown=function(){return d(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}}));function prayWellFormed(t,e,i){pray("a parent is always present",t),pray("leftward is properly set up",e?e[c]===i&&e.parent===t:t.ends[l]===i),pray("rightward is properly set up",i?i[l]===e&&i.parent===t:t.ends[c]===e)}var d=o((function(t){t.init=function(t,e,i){if(void 0===i&&(i=l),prayDirection(i),pray("no half-empty fragments",!t==!e),this.ends={},t){pray("withDir is passed to Fragment",t instanceof p),pray("oppDir is passed to Fragment",e instanceof p),pray("withDir and oppDir have the same parent",t.parent===e.parent),this.ends[i]=t,this.ends[-i]=e;var n=this.fold([],(function(t,e){return t.push.apply(t,e.jQ.get()),t}));this.jQ=this.jQ.add(n)}},t.jQ=u(),t.withDirAdopt=function(t,e,i,n){return t===l?this.adopt(e,i,n):this.adopt(e,n,i)},t.adopt=function(t,e,i){prayWellFormed(t,e,i);this.disowned=!1;var n=this.ends[l];if(!n)return this;var r=this.ends[c];return e||(t.ends[l]=n),i?i[l]=r:t.ends[c]=r,this.ends[c][c]=i,this.each((function(i){i[l]=e,i.parent=t,e&&(e[c]=i),e=i})),this},t.disown=function(){var t=this.ends[l];if(!t||this.disowned)return this;this.disowned=!0;var e=this.ends[c],i=t.parent;return prayWellFormed(i,t[l],t),prayWellFormed(i,e,e[c]),t[l]?t[l][c]=e[c]:i.ends[l]=e[c],e[c]?e[c][l]=t[l]:i.ends[c]=t[l],this},t.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},t.each=iterator((function(t){var e=this.ends[l];if(!e)return this;for(;e!==this.ends[c][c];e=e[c]){if(!1===t(e))break}return this})),t.fold=function(t,e){return this.each((function(i){t=e.call(this,t,i)})),t}})),f={},m={},g={},b=o(h,(function(t){t.init=function(t,e){this.parent=t,this.options=e;var i=this.jQ=this._jQ=u('<span class="mq-cursor">&#8203;</span>');this.blink=function(){i.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[c]?this.selection&&this.selection.ends[l][l]===this[l]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[c].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=u(),this},t.withDirInsertAt=function(t,e,i,n){e!==this.parent&&this.parent.blur&&this.parent.blur(),this.parent=e,this[t]=i,this[-t]=n},t.insDirOf=function(t,e){return prayDirection(t),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this.jQ.insDirOf(t,e.jQ),this},t.insLeftOf=function(t){return this.insDirOf(l,t)},t.insRightOf=function(t){return this.insDirOf(c,t)},t.insAtDirEnd=function(t,e){return prayDirection(t),this.withDirInsertAt(t,e,0,e.ends[t]),this.jQ.insAtDirEnd(t,e.jQ),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(l,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(c,t)},t.jumpUpDown=function(t,e){this.upDownCache[t.id]=h.copy(this);var i=this.upDownCache[e.id];if(i)i[c]?this.insLeftOf(i[c]):this.insAtRightEnd(i.parent);else{var n=this.offset().left;e.seek(n,this)}},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,i=t[c],n=t[l];if(t.disown().eachChild((function(r){r.isEmpty()||(r.children().adopt(e,n,i).each((function(e){e.jQ.insertBefore(t.jQ.first())})),n=r.ends[c])})),!this[c])if(this[l])this[c]=this[l][c];else for(;!this[c];){if(this.parent=this.parent[c],!this.parent){this[c]=t[c],this.parent=e;break}this[c]=this.parent.ends[l]}this[c]?this.insLeftOf(this[c]):this.insAtRightEnd(e),t.jQ.remove(),t[l].siblingDeleted&&t[l].siblingDeleted(this.options,c),t[c].siblingDeleted&&t[c].siblingDeleted(this.options,l)},t.startSelection=function(){for(var t=this.anticursor=h.copy(this),e=t.ancestors={},i=t;i.parent;i=i.parent)e[i.parent.id]=i},t.endSelection=function(){delete this.anticursor},t.select=function(){var t=this.anticursor;if(this[l]===t[l]&&this.parent===t.parent)return!1;for(var e=this;e.parent;e=e.parent)if(e.parent.id in t.ancestors){var i=e.parent;break}pray("cursor and anticursor in the same tree",i);var n,r,a=t.ancestors[i.id],s=c;if(e[l]!==a)for(var o=e;o;o=o[c])if(o[c]===a[c]){s=l,n=e,r=a;break}return s===c&&(n=a,r=e),n instanceof h&&(n=n[c]),r instanceof h&&(r=r[l]),this.hide().selection=i.selectChildren(n,r),this.insDirOf(s,this.selection.ends[s]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[l]=this.selection.ends[l][l],this[c]=this.selection.ends[c][c],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[l]=t.ends[l][l],this[c]=t.ends[c][c],delete this.selection),t},t.depth=function(){for(var t=this,e=0;t=t.parent;)e+=t instanceof N?1:0;return e},t.isTooDeep=function(t){if(void 0!==this.options.maxDepth)return this.depth()+(t||0)>this.options.maxDepth}})),y=o(d,(function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",(function(e,i){return e+i[t]()}))}})),v=o((function(t){t.init=function(t,e,i){this.API=t,this.root=e,this.container=i,t.__controller=e.controller=this,this.cursor=e.cursor=b(e,t.__options),this.setUnitalicizedTextCmds()},t.setUnitalicizedTextCmds=function(){G={};var t=this.API.__options.unItalicizedTextCmds||[];if(t instanceof Array){for(var e=0;e<t.length;e+=1)G[t[e]]=1;this.API.__options.unItalicizedTextCmds=G}else!t||t instanceof Array||(G=this.API.__options.unItalicizedTextCmds)},t.handle=function(t,e){var i=this.API.__options.handlers;i&&i[t]&&(e===l||e===c?i[t](e,this.API):i[t](this.API))};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}}));function MathQuill(t){if(!t||!t.nodeType)return null;var e=u(t).children(".mq-root-block").attr(i);return e?p.byId[e].controller.API:null}function APIFnFor(t){function APIFn(e,i){var n=MathQuill(e);return n instanceof t||!e||!e.nodeType?n:t(u(e),i)}return APIFn.prototype=t.prototype,APIFn}var w=o(),x={};MathQuill.__options=w.p;var E=o((function(n){n.init=function(){throw"wtf don't call me, I'm 'abstract'"},n.initRoot=function(n,r,a){this.__options=w(),this.config(a);var s=v(this,n,r);s.createTextarea();var o=r.contents().detach();n.jQ=u('<span class="mq-root-block"/>').attr(i,n.id).toggleClass("mq-disable-italics",!!a&&!!a.disableItalics).appendTo(r),this.latex(o.text()),this.revert=function(){return r.find("["+e+"]").each((function(){var t=p.byId[u(this).attr(e)];t&&t.remove()})),r.find("["+i+"]").each((function(){var t=p.byId[u(this).attr(i)];t&&t.dispose()})),r.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(o),t.each(p.byId,(function(t,e){e.jQ&&e.jQ.length&&3!==e.jQ[0].nodeType||e.dispose()})),t.each(s,(function(t,e){e instanceof u&&e.off(),delete s[t]})),r}},n.config=MathQuill.config=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e],n=x[e];this.__options[e]=n?n(i):i}return this},n.el=function(){return this.__controller.container[0]},n.text=function(){return this.__controller.exportText()},n.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},n.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},n.reflow=function(){return this.__controller.root.postOrder("reflow"),this}}));MathQuill.prototype=E.prototype,MathQuill.StaticMath=APIFnFor(o(E,(function(t,e){t.init=function(t){this.initRoot(N(),t.addClass("mq-math-mode")),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents()},t.latex=function(){var t=e.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[]),t}})));var k=MathQuill.EditableField=o(E,(function(t){t.initRootAndEvents=function(t,e,i){this.initRoot(t,e,i),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents()},t.focus=function(){return this.__controller.textarea.focus(),this},t.blur=function(){return this.__controller.textarea.blur(),this},t.write=function(t){return this.__controller.writeLatex(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},t.clear=function(){return this.select().__controller.backspace(),this},t.cmd=function(t){var e=this.__controller.notify(),i=e.cursor;/^\\[a-z]+$/i.test(t)&&!i.isTooDeep()?(t=t.slice(1),t=(f[t]||Rt[t]||qt)(t),i.selection&&t.replaces(i.replaceSelection()),t.createLeftOf(i.show())):i.parent.write(i,t);return e.blurred&&i.hide().parent.blur(),this},t.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[l];)t.selectLeft();return this},t.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},t.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},t.moveToLeftEnd=function(){return this.moveToDirEnd(l)},t.moveToRightEnd=function(){return this.moveToDirEnd(c)},t.keystroke=function(t){t=t.replace(/^\s+|\s+$/g,"").split(/\s+/);for(var e=0;e<t.length;e+=1)this.__controller.keystroke(t[e],{preventDefault:noop});return this},t.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this}}));function RootBlockMixin(t){for(var e="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf reflow".split(" "),i=0;i<e.length;i+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(e[i])}var T,O=o((function(t,e,i){function parseError(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}t.init=function(t){this._=t},t.parse=function(t){return this.skip(a)._(""+t,(function success(t,e){return e}),parseError)},t.or=function(t){pray("or is passed a parser",t instanceof i);var e=this;return i((function(i,n,r){return e._(i,n,(function failure(e){return t._(i,n,r)}))}))},t.then=function(t){var e=this;return i((function(n,r,a){return e._(n,(function success(e,n){var s=t instanceof i?t:t(n);return pray("a parser is returned",s instanceof i),s._(e,r,a)}),a)}))},t.many=function(){var t=this;return i((function(e,i,n){for(var r=[];t._(e,success,failure););return i(e,r);function success(t,i){return e=t,r.push(i),!0}function failure(){return!1}}))},t.times=function(t,e){arguments.length<2&&(e=t);var n=this;return i((function(i,r,a){for(var s,o=[],l=!0,c=0;c<t;c+=1)if(!(l=n._(i,success,firstFailure)))return a(i,s);for(;c<e&&l;c+=1)l=n._(i,success,secondFailure);return r(i,o);function success(t,e){return o.push(e),i=t,!0}function firstFailure(t,e){return s=e,i=t,!1}function secondFailure(t,e){return!1}}))},t.result=function(t){return this.then(r(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then((function(t){return e.many().map((function(e){return t.concat(e)}))}))},t.map=function(t){return this.then((function(e){return r(t(e))}))},t.skip=function(t){return this.then((function(e){return t.result(e)}))};this.string=function(t){var e=t.length,n="expected '"+t+"'";return i((function(i,r,a){var s=i.slice(0,e);return s===t?r(i.slice(e),s):a(i,n)}))};var n=this.regex=function(t){pray("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return i((function(i,n,r){var a=t.exec(i);if(a){var s=a[0];return n(i.slice(s.length),s)}return r(i,e)}))},r=i.succeed=function(t){return i((function(e,i){return i(e,t)}))},a=(i.fail=function(t){return i((function(e,i,n){return n(e,t)}))},i.letter=n(/^[a-z]/i),i.letters=n(/^[a-z]*/i),i.digit=n(/^[0-9]/),i.digits=n(/^[0-9]*/),i.whitespace=n(/^\s+/),i.optWhitespace=n(/^\s*/),i.any=i((function(t,e,i){return t?e(t.slice(1),t.charAt(0)):i(t,"expected any character")})),i.all=i((function(t,e,i){return e("",t)})),i.eof=i((function(t,e,i){return t?i(t,"expected EOF"):e(t,t)})))})),S=(T={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},function saneKeyboardEvents(e,i){var n,r=null,a=null,s=t(e),o=t(i.container||s),l=noop;function checkTextareaFor(t){l=t,clearTimeout(n),n=setTimeout(t)}o.bind("keydown keypress input keyup focusout paste",(function(){l()}));var c=!1;function handleKey(){i.keystroke(function stringify(t){var e,i=t.which||t.keyCode,n=T[i],r=[];return t.ctrlKey&&r.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&r.push("Meta"),t.altKey&&r.push("Alt"),t.shiftKey&&r.push("Shift"),e=n||String.fromCharCode(i),r.length||n?(r.push(e),r.join("-")):e}(r),r)}function typedText(){if(!function hasSelection(){var t=s[0];return"selectionStart"in t&&t.selectionStart!==t.selectionEnd}()){var t=s.val();1===t.length?(s.val(""),i.typedText(t)):t&&s[0]&&s[0].select&&s[0].select()}}function pastedText(){var t=s.val();s.val(""),t&&(t=(t=t.replace(/\^\{\{response\}\}/g,"^{}")).replace(/\{\{response\}\}/g,""),i.paste(t))}return o.bind({keydown:function onKeydown(t){r=t,a=null,c&&checkTextareaFor((function(){s[0]&&s[0].select&&s[0].select(),l=noop,clearTimeout(n)})),handleKey()},keypress:function onKeypress(t){r&&a&&handleKey(),a=t,checkTextareaFor(typedText)},focusout:function onBlur(){r=a=null},paste:function onPaste(t){s.focus(),checkTextareaFor(pastedText)}}),{select:function select(t){l(),l=noop,clearTimeout(n),s.val(t),t&&s[0]&&s[0].select&&s[0].select(),c=!!t}}});v.open((function(t,e){t.exportText=function(){return this.root.foldChildren("",(function(t,e){return t+e.text()}))}})),v.open((function(t){t.focusBlurEvents=function(){var t,e=this,i=e.root,n=e.cursor;function windowBlur(){clearTimeout(t),n.selection&&n.selection.jQ.addClass("mq-blur"),blur()}function blur(){n.hide().parent.blur(),e.root&&e.root.jQ.removeClass("mq-focused"),u(window).off("blur",windowBlur)}e.textarea.focus((function(){e.blurred=!1,clearTimeout(t),i.ultimateRoot&&i.ultimateRoot.jQ.find(".mq-last-focused").removeClass("mq-last-focused"),e.container.children(".mq-root-block").addClass("mq-focused mq-last-focused"),n.parent||n.insAtRightEnd(i),n.selection?(n.selection.jQ.removeClass("mq-blur"),e.selectionChanged()):n.show(),e.setUnitalicizedTextCmds()})).blur((function(){e.blurred=!0,t=setTimeout((function(){i.postOrder("intentionalBlur"),n.clearSelection(),blur()})),u(window).on("blur",windowBlur)})),e.blurred=!0,n.hide().parent.blur()}})),v.open((function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}})),p.open((function(t){t.keystroke=function(t,e,i){var n=i.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":for(;n[l]||n.selection;)i.backspace();break;case"Shift-Backspace":case"Backspace":i.backspace();break;case"Esc":return;case"Shift-Esc":return void i.escapeDir(l,t,e);case"End":i.notify("move").cursor.insAtRightEnd(n.parent);break;case"Ctrl-End":i.notify("move").cursor.insAtRightEnd(i.root);break;case"Shift-End":for(;n[c];)i.selectRight();break;case"Ctrl-Shift-End":for(;n[c]||n.parent!==i.root;)i.selectRight();break;case"Home":i.notify("move").cursor.insAtLeftEnd(n.parent);break;case"Ctrl-Home":i.notify("move").cursor.insAtLeftEnd(i.root);break;case"Shift-Home":for(;n[l];)i.selectLeft();break;case"Ctrl-Shift-Home":for(;n[l]||n.parent!==i.root;)i.selectLeft();break;case"Left":i.moveLeft();break;case"Shift-Left":i.selectLeft();break;case"Ctrl-Left":break;case"Right":i.moveRight();break;case"Shift-Right":i.selectRight();break;case"Ctrl-Right":break;case"Up":i.moveUp();break;case"Down":i.moveDown();break;case"Shift-Up":if(n[l])for(;n[l];)i.selectLeft();else i.selectLeft();case"Shift-Down":if(n[c])for(;n[c];)i.selectRight();else i.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":for(;n[c]||n.selection;)i.deleteForward();break;case"Shift-Del":case"Del":i.deleteForward();break;case"Meta-A":case"Ctrl-A":for(i.notify("move").cursor.insAtRightEnd(i.root);n[l];)i.selectLeft();break;default:return}e.preventDefault(),i.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){pray("overridden or never called on this node")}})),v.open((function(t){function moveUpDown(t,e){var i=t.notify("upDown").cursor,n=e+"Into",r=e+"OutOf";return i[c][n]?i.insAtLeftEnd(i[c][n]):i[l][n]?i.insAtRightEnd(i[l][n]):i.parent.bubble((function(t){var e=t[r];if(e&&("function"==typeof e&&(e=t[r](i)),e instanceof p&&i.jumpUpDown(t,e),!0!==e))return!1})),t}this.onNotify((function(t){"move"!==t&&"upDown"!==t||this.show().clearSelection()})),t.escapeDir=function(t,e,i){prayDirection(t);var n=this.cursor;if(n.parent!==this.root&&i.preventDefault(),n.parent!==this.root)return n.parent.moveOutOf(t,n),this.notify("move")},x.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){prayDirection(t);var e=this.cursor,i=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,i):e.parent.moveOutOf(t,e,i),this.notify("move")},t.moveLeft=function(){return this.moveDir(l)},t.moveRight=function(){return this.moveDir(c)},t.moveUp=function(){return moveUpDown(this,"up")},t.moveDown=function(){return moveUpDown(this,"down")},this.onNotify((function(t){"upDown"!==t&&(this.upDownCache={})})),this.onNotify((function(t){"edit"===t&&this.show().deleteSelection()})),t.deleteDir=function(t){prayDirection(t);var e=this.cursor,i=e.selection;return this.notify("edit"),i||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[l].siblingDeleted&&e[l].siblingDeleted(e.options,c),e[c].siblingDeleted&&e[c].siblingDeleted(e.options,l),e.parent.bubble("reflow"),this},t.backspace=function(){return this.deleteDir(l)},t.deleteForward=function(){return this.deleteDir(c)},this.onNotify((function(t){"select"!==t&&this.endSelection()})),t.selectDir=function(t){var e=this.notify("select").cursor,i=e.selection;prayDirection(t),e.anticursor||e.startSelection();var n=e[t];n?i&&i.ends[t]===n&&e.anticursor[-t]!==n?n.unselectInto(t,e):n.selectTowards(t,e):e.parent.selectOutOf(t,e),e.clearSelection(),e.select()||e.show()},t.selectLeft=function(){return this.selectDir(l)},t.selectRight=function(){return this.selectDir(c)}}));var q=function(){function joinBlocks(t){for(var e=t[0]||N(),i=1;i<t.length;i+=1)t[i].children().adopt(e,e.ends[c],0);return e}var t=O.string,e=O.regex,i=O.letter,n=O.any,r=O.optWhitespace,a=O.succeed,s=O.fail,o=i.map((function(t){return Q(t)})),l=e(/^[^${}\\_^]/).map((function(t){return L(t)})),u=e(/^\\not\\[a-z]+/).then((function(t){return g[t]&&g[t]().parser()||s("unknown compound command: "+t)})),h=e(/^[^\\a-eg-zA-Z]/).or(t("\\").then(e(/^[a-z]+/i).or(e(/^\s+/).result(" ")).or(n))).then((function(t){var e=f[t];return e?e(t).parser():s("unknown command: \\"+t)})),p=t("\\").then(e(/^(?!end\b)\w+/)).then((function(t){return f[t]?s("recognised command: \\"+t):qt(t).parser()})),d=u.or(h).or(o).or(l).or(p),m=t("{").then((function(){return y})).skip(t("}")),b=r.then(m.or(d.map((function commandToBlock(t){var e=N();return t.adopt(e,0,0),e})))),y=b.many().map(joinBlocks).skip(r),v=t("[").then(b.then((function(t){return"]"!==t.join("latex")?a(t):s()})).many().map(joinBlocks).skip(r)).skip(t("]")),w=y;return w.block=b,w.optBlock=v,w}();v.open((function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},x.maxDepth=function(t){return"number"==typeof t?t:void 0},t.writeLatex=function(t){var e=this.notify("edit").cursor,i=O.all,n=O.eof;this.setUnitalicizedTextCmds();var r=q.skip(n).or(i.result(!1)).parse(t);r&&!r.isEmpty()&&r.prepareInsertionAt(e)&&(r.children().adopt(e.parent,e[l],e[c]),r.jQize().insertBefore(e.jQ),e[l]=r.ends[c],r.finalizeInsert(e.options,e),r.ends[c][c].siblingCreated&&r.ends[c][c].siblingCreated(e.options,l),r.ends[l][l].siblingCreated&&r.ends[l][l].siblingCreated(e.options,c),e.parent.bubble("reflow"));return this},t.renderLatexMath=function(t){var e=this.root,i=this.cursor,n=e.jQ,r=O.all,a=O.eof,s=q.skip(a).or(r.result(!1)).parse(t);if(e.eachChild("postOrder","dispose"),e.ends[l]=e.ends[c]=0,s&&s.prepareInsertionAt(i)){s.children().adopt(e,0,0);var o=s.join("html");n.html(o),e.jQize(n.children()),e.finalizeInsert(i.options)}else n.empty();delete i.selection,i.insAtRightEnd(e)},t.renderLatexText=function(t){var e=this.root,i=this.cursor;e.jQ.children().slice(1).remove(),e.eachChild("postOrder","dispose"),e.ends[l]=e.ends[c]=0,delete i.selection,i.show().insAtRightEnd(e);var n=O.regex,r=O.string,a=O.eof,s=O.all,o=r("$").then(q).skip(r("$").or(a)).map((function(t){var e=B(i);e.createBlocks();var n=e.ends[l];return t.children().adopt(n,0,0),e})),u=r("\\$").result("$").or(n(/^[^$]/)).map(L),h=o.or(u).many().skip(a).or(s.result(!1)).parse(t);if(h){for(var p=0;p<h.length;p+=1)h[p].adopt(e,e.ends[c],0);e.jQize().appendTo(e.jQ),e.finalizeInsert(i.options)}}})),v.open((function(t){t.delegateMouseEvents=function(){var t=this.root.jQ;this.container.bind("mousedown.mathquill",(function(e){var n=u(e.target).closest(".mq-root-block"),r=p.byId[n.attr(i)||t.attr(i)].controller,a=r.cursor,s=(a.blink,r.textareaSpan),o=r.textarea;function mousemove(t){a.anticursor||a.startSelection(),r.seek(u(t.target),t.pageX,t.pageY).cursor.select(),t.target&&u(t.target.ownerDocument).unbind("mousemove",docmousemove)}function docmousemove(t){return delete t.target,mousemove(t)}if(0===s.parent().length)return!1;r.blurred&&(r.editable||n.prepend(s),document.body.focus(),o.focus()),e.preventDefault(),e.target.unselectable=!0,a.show(),r.seek(u(e.target),e.pageX,e.pageY).cursor.startSelection(),n.mousemove(mousemove),u(e.target.ownerDocument).mousemove(docmousemove).mouseup((function mouseup(t){a.selection||r.editable||s.detach(),n.unbind("mousemove",mousemove),u(t.target.ownerDocument).unbind("mousemove",docmousemove).unbind("mouseup",mouseup)}))}))}})),v.open((function(t){t.seek=function(t,n,r){var a=this.notify("select").cursor;if(t){var s=t.attr(i)||t.attr(e);if(!s){var o=t.parent();s=o.attr(i)||o.attr(e)}}var l=s?p.byId[s]:this.root;return pray("nodeId is the id of some Node that exists",l),a.clearSelection().show(),l.seek(n,a),this.scrollHoriz(),this}})),v.open((function(t){t.scrollHoriz=function(){var t=this.cursor,e=t.selection,i=this.root.jQ[0].getBoundingClientRect();if(e){var n=e.jQ[0].getBoundingClientRect(),r=n.left-(i.left+20),a=n.right-(i.right-20);if(e.ends[l]===t[c])if(r<0)o=r;else{if(!(a>0))return;if(n.left-a<i.left+20)o=r;else o=a}else if(a>0)o=a;else{if(!(r<0))return;if(n.right-r>i.right-20)o=a;else o=r}}else{var s=t.jQ[0].getBoundingClientRect().left;if(s>i.right-20)var o=s-(i.right-20);else{if(!(s<i.left+20))return;var o=s-(i.left+20)}}this.root.jQ.stop().animate({scrollLeft:"+="+o},100)}})),v.open((function(e){w.p.substituteTextarea=function(){return u("<textarea>")[0]},e.createTextarea=function(){var t=this.textareaSpan=u('<span class="mq-textarea"></span>'),e=this.API.__options.substituteTextarea();if(!e.nodeType)throw"substituteTextarea() must return a DOM element, got "+e;e=this.textarea=u(e).appendTo(t);var i=this;i.cursor.selectionChanged=function(){i.selectionChanged()},i.container.bind("copy",(function(){i.setTextareaSelection()}))},e.selectionChanged=function(){var t=this;ot(t.container[0]),void 0===t.textareaSelectionTimeout&&(t.textareaSelectionTimeout=setTimeout((function(){t.setTextareaSelection()})))},e.setTextareaSelection=function(){this.textareaSelectionTimeout=void 0;var t="";this.cursor.selection&&(t=this.cursor.selection.join("latex"),this.API.__options.statelessClipboard&&(t="$"+t+"$")),this.selectFn(t)},e.staticMathTextareaEvents=function(){var e=this,i=(e.root,e.cursor),n=e.textarea,r=e.textareaSpan;function detach(){r.detach(),e.blurred=!0}this.container.prepend(t('<span class="mq-selectable">').text("$"+e.exportLatex()+"$")),e.blurred=!0,n.bind("cut paste",!1).focus((function(){e.blurred=!1})).blur((function(){i.selection&&i.selection.clear(),setTimeout(detach)})),e.selectFn=function(t){n.val(t),t&&n.select()}},e.editablesTextareaEvents=function(){var t=this,e=(t.root,t.cursor),i=t.textarea,n=t.textareaSpan,r=S(i,this);this.selectFn=function(t){r.select(t)},this.container.prepend(n).on("cut",(function(i){e.selection&&setTimeout((function(){t.notify("edit"),e.parent.bubble("reflow")}))})),this.focusBlurEvents()},e.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},e.paste=function(t){this.API.__options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}}));var A=o(p,(function(t,e){t.finalizeInsert=function(t,e){this.postOrder("finalizeTree",t),this.postOrder("contactWeld",e),this.postOrder("blur"),this.postOrder("reflow"),this[c].siblingCreated&&this[c].siblingCreated(t,l),this[l].siblingCreated&&this[l].siblingCreated(t,c),this.bubble("reflow")},t.prepareInsertionAt=function(t){var e=t.options.maxDepth;if(void 0!==e){var i=t.depth();if(i>e)return!1;this.removeNodesDeeperThan(e-i)}return!0},t.removeNodesDeeperThan=function(t){for(var e,i=0,n=[[this,i]];n.length;)(e=n.shift())[0].children().each((function(r){var a=r instanceof N?1:0;(i=e[1]+a)<=t?n.push([r,i]):(a?r.children():r).remove()}))}})),R=o(A,(function(t,e){t.init=function(t,i,n){e.init.call(this),this.ctrlSeq||(this.ctrlSeq=t),i&&(this.htmlTemplate=i),n&&(this.textTemplate=n)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,(function(t,e){return t&&e.isEmpty()}))},t.parser=function(){var t=q.block,e=this;return t.times(e.numBlocks()).map((function(t){e.blocks=t;for(var i=0;i<t.length;i+=1)t[i].adopt(e,e.ends[c],0);return e}))},t.createLeftOf=function(t){var i=this.replacedFragment;this.createBlocks(),e.createLeftOf.call(this,t),i&&(i.adopt(this.ends[l],0,0),i.jQ.appendTo(this.ends[l].jQ),this.placeCursor(t),this.prepareInsertionAt(t)),this.finalizeInsert(t.options),this.placeCursor(t)},t.createBlocks=function(){for(var t=this.numBlocks(),e=this.blocks=Array(t),i=0;i<t;i+=1){(e[i]=N()).adopt(this,this.ends[c],0)}},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[l],(function(t,e){return t.isEmpty()?t:e})))},t.moveTowards=function(t,e,i){var n=i&&this[i+"Into"];e.insAtDirEnd(-t,n||this.ends[-t])},t.deleteTowards=function(t,e){e.startSelection(),this.selectTowards(t,e),e.select()},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return y(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function getBounds(t){var e={};return e[l]=t.jQ.offset().left,e[c]=e[l]+t.jQ.outerWidth(),e}var i=this,n=getBounds(i);if(t<n[l])return e.insLeftOf(i);if(t>n[c])return e.insRightOf(i);var r=n[l];i.eachChild((function(a){var s=getBounds(a);return t<s[l]?(t-r<s[l]-t?a[l]?e.insAtRightEnd(a[l]):e.insLeftOf(i):e.insAtLeftEnd(a),!1):t>s[c]?void(a[c]?r=s[c]:n[c]-t<t-s[c]?e.insRightOf(i):e.insAtRightEnd(a)):(a.seek(t,e),!1)}))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t=this.blocks,e=" mathquill-command-id="+this.id,i=this.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);pray("no unmatched angle brackets",i.join("")===this.htmlTemplate);for(var n=0,r=i[0];r;r=i[n+=1])if("/>"===r.slice(-2))i[n]=r.slice(0,-2)+e+"/>";else if("<"===r.charAt(0)){pray("not an unmatched top-level close tag","/"!==r.charAt(1)),i[n]=r.slice(0,-1)+e+">";var a=1;do{pray("no missing close tags",r=i[n+=1]),"</"===r.slice(0,2)?a-=1:"<"===r.charAt(0)&&"/>"!==r.slice(-2)&&(a+=1)}while(a>0)}return i.join("").replace(/>&(\d+)/g,(function(e,i){return" mathquill-block-id="+t[i].id+">"+t[i].join("html")}))},t.latex=function(){return this.foldChildren(this.ctrlSeq,(function(t,e){return t+"{"+(e.latex()||" ")+"}"}))},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],(function(i,n){e+=1;var r=n.text();return i&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?i+r.slice(1,-1)+t.textTemplate[e]:i+n.text()+(t.textTemplate[e]||"")}))}})),D=o(R,(function(t,e){t.init=function(t,i,n){n||(n=t&&t.length>1?t.slice(1):t),e.init.call(this,t,i,[n])},t.parser=function(){return O.succeed(this)},t.numBlocks=function(){return 0},t.replaces=function(t){t.remove()},t.createBlocks=noop,t.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},t.deleteTowards=function(t,e){e[t]=this.remove()[t]},t.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},t.latex=function(){return this.ctrlSeq},t.text=function(){return this.textTemplate},t.placeCursor=noop,t.isEmpty=function(){return!0}})),L=o(D,(function(t,e){t.init=function(t,i){e.init.call(this,t,"<span>"+(i||t)+"</span>")}})),I=o(D,(function(t,e){t.init=function(t,i,n){e.init.call(this,t,'<span class="mq-binary-operator">'+i+"</span>",n)}})),N=o(A,(function(t,e){t.join=function(t){return this.foldChildren("",(function(e,i){return e+i[t]()}))},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[l]===this.ends[c]&&0!==this.ends[l]?this.ends[l].text():this.join("text")},t.keystroke=function(t,i,n){return!n.API.__options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(i.preventDefault(),void n.escapeDir("Shift-Spacebar"===t?l:c,t,i))},t.moveOutOf=function(t,e,i){!(i&&this.parent[i+"Into"])&&this[t]?e.insAtDirEnd(-t,this[t]):e.insDirOf(t,this.parent)},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var i=this.ends[c];if(!i||i.jQ.offset().left+i.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[l].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<i.jQ.offset().left;)i=i[l];return i.seek(t,e)},t.chToCmd=function(t,e){var i;return t.match(/^[a-eg-zA-Z]$/)?Q(t):/^\d$/.test(t)?H(t):(i=m[t]||f[t])?i(t):L(t)},t.write=function(t,e){var i=this.chToCmd(e,t.options);t.selection&&i.replaces(t.replaceSelection()),t.isTooDeep()||i.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}})),M=o(N,RootBlockMixin);MathQuill.MathField=APIFnFor(o(k,(function(t,e){t.init=function(t,e){t.addClass("mq-editable-field mq-math-mode"),this.initRootAndEvents(M(),t,e)}}))),MathQuill.InertMath=APIFnFor(o(E,(function(t){t.init=function(t,e){this.initRoot(N(),t.addClass("mq-math-mode"),e),this.__controller.staticMathTextareaEvents()}}))),MathQuill.StaticMathWithEditables=APIFnFor(o(E,(function(e){e.init=function(t,e){this.initRoot(N(),t.addClass("mq-math-mode"),e),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents()},e.withActiveNode=function(t){var e=this.__controller.container.find(".mq-inner-editable .mq-root-block"),n=e.filter(".mq-last-focused"),r=n.length?n.eq(0):e.eq(0),a=p.byId[r.attr(i)];a&&(a.__controller=a.__controller||a.controller,t(a))},e.write=function(t){return this.withActiveNode((function(e){return k.prototype.write.call(e,t)})),this},e.cmd=function(t){return this.withActiveNode((function(e){return k.prototype.cmd.call(e,t)})),this},e.clear=function(){return this.withActiveNode((function(t){k.prototype.clear.call(t)})),this},e.keystroke=function(t){return this.withActiveNode((function(e){return k.prototype.keystroke.call(e,t)})),this},e.editables=function(){return this.__controller.container.find(".mq-inner-editable .mq-root-block").sort((function(t,e){return parseInt(u(t).attr("mathquill-block-id"))>parseInt(u(e).attr("mathquill-block-id"))?1:-1})).map((function(){var e=p.byId[t(this).attr(i)],n=t(this).hasClass("mq-focused");return{latex:e.latex(),active:n}})).get()},e.typedText=function(t){return this.withActiveNode((function(e){return k.prototype.typedText.call(e,t)})),this}})));var z=o(p,(function(t,e){function fuseChildren(t){t.jQ[0].normalize();var e=t.jQ.contents().filter((function(t,e){return 3===e.nodeType}))[0];e||(e={data:""});var i=j(e.data);return i.jQadd(e),t.children().disown(),i.adopt(t,0,0)}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof d?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[l]&&this.ends[l].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this[c].siblingCreated&&this[c].siblingCreated(t.options,l),this[l].siblingCreated&&this[l].siblingCreated(t.options,c),this.bubble("reflow"),t.insAtRightEnd(this),this.replacedText)for(var i=0;i<this.replacedText.length;i+=1)this.write(t,this.replacedText.charAt(i))},t.parser=function(){var t=this,e=O.string,i=O.regex;return O.optWhitespace.then(e("{")).then(i(/^[^}]*/)).skip(e("}")).map((function(e){if(e.length&&G.hasOwnProperty(e)){for(var i=N(),n=0;n<e.length;n+=1)Q(e.charAt(n)).adopt(i,i.ends[c],0);return i.children()}return j(e).adopt(t,0,0),t}))},t.textContents=function(){return this.foldChildren("",(function(t,e){return t+e.text}))},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){return"\\text{"+this.textContents()+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=R.prototype.selectTowards,t.deleteTowards=R.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,i){if(t.show().deleteSelection(),"$"!==i)t[l]?t[l].appendText(i):j(i).createLeftOf(t);else if(this.isEmpty())t.insRightOf(this),L("\\$","$").createLeftOf(t);else if(t[c])if(t[l]){var n=z(),r=this.ends[l];r.disown(),r.adopt(n,0,0),t.insLeftOf(this),e.createLeftOf.call(n,t)}else t.insLeftOf(this);else t.insRightOf(this)},t.seek=function(t,e){e.hide();var i=fuseChildren(this),n=this.jQ.width()/this.text.length,r=Math.round((t-this.jQ.offset().left)/n);r<=0?e.insAtLeftEnd(this):r>=i.text.length?e.insAtRightEnd(this):e.insLeftOf(i.splitRight(r));for(var a=t-e.show().offset().left,s=a&&a<0?l:c,o=s;e[s]&&a*o>0;)e[s].moveTowards(s,e),o=a,a=t-e.offset().left;if(s*a<-s*o&&e[-s].moveTowards(-s,e),e.anticursor){if(e.anticursor.parent===this){var u=e[l]&&e[l].text.length;if(this.anticursorPosition===u)e.anticursor=h.copy(e);else{if(this.anticursorPosition<u){var p=e[l].splitRight(this.anticursorPosition);e[l]=p}else p=e[c].splitRight(this.anticursorPosition-u);e.anticursor=h(this,p[l],p)}}}else this.anticursorPosition=e[l]&&e[l].text.length},t.blur=function(){N.prototype.blur.call(this),fuseChildren(this)},t.focus=N.prototype.focus})),j=o(p,(function(t,e){function endChar(t,e){return e.charAt(t===l?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=u(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){prayDirection(e),e===c?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=j(this.text.slice(t)).adopt(this.parent,this,this[c]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){prayDirection(t);var i=endChar(-t,this.text),n=this[-t];return n?n.insTextAtDirEnd(i,t):j(i).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?t===c?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){prayDirection(t);var i=e.anticursor,n=endChar(-t,this.text);if(i[t]===this){var r=j(n).createDir(t,e);i[t]=r,e.insDirOf(t,r)}else{var a=this[-t];if(a)a.insTextAtDirEnd(n,t);else(r=j(n).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ);1===this.text.length&&i[-t]===this&&(i[-t]=this[-t])}return this.deleteTowards(t,e)}}));function makeTextBlock(t,e,i){return o(z,{ctrlSeq:t,htmlTemplate:"<"+e+" "+i+">&0</"+e+">"})}f.text=f.textnormal=f.textrm=f.textup=f.textmd=z,f.em=f.italic=f.italics=f.emph=f.textit=f.textsl=makeTextBlock("\\textit","i",'class="mq-text-mode"'),f.strong=f.bold=f.textbf=makeTextBlock("\\textbf","b",'class="mq-text-mode"'),f.sf=f.textsf=makeTextBlock("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),f.tt=f.texttt=makeTextBlock("\\texttt","span",'class="mq-monospace mq-text-mode"'),f.textsc=makeTextBlock("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),f.uppercase=makeTextBlock("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),f.lowercase=makeTextBlock("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"'),f.ce=o(z,(function(t,e){function wrapDots(t){return t.replace(/(&middot;)/g,'<span class="mq-bond-dot">$1</span>')}t.bondHtml={"-":"-","=":"=","#":"&#8801;","...":wrapDots("&middot;&middot;&middot;"),"....":wrapDots("&middot;&middot;&middot;&middot;"),"->":"&#8594;","<-":"&#8592;"},t.bond=null,t.ctrlSeq="\\ce",t.regex=/^(\\bond{([^{}]+?)})/i,t.jQadd=function(t){e.jQadd.call(this,t),this.bond&&this.jQaddBond()},t.jQaddBond=function(){this.jQ.empty().removeClass("mq-text-mode").addClass("mq-ce mq-bond").html(this.bondHtml[this.bond])},t.parseBond=function(t){t.length&&(this.bond=this.regex.exec(t)&&t.replace(this.regex,"$2")),this.bondHtml[this.bond]||(this.bond=null)},t.latex=function(){return"\\ce{"+(this.bond?"\\bond{"+this.bond+"}":this.textContents())+"}"},t.text=function(){return this.bond||this.textContents()},t.isEmpty=function(){return!this.text()},t.moveOutOf=function(t,e){this.bond||this.parseEnteredText(t,e),e.insDirOf(t,this)},t.parseEnteredText=function(t,e){var i=e[-t];if(this.parseBond(this.textContents()),this.bond){for(;i instanceof j;)i=i.remove()[-t];e[-t]=this,this.jQaddBond()}},t.parser=function(){var t=this,e=O.string,i=O.regex;return O.optWhitespace.then(e("{")).then(i(this.regex)).skip(e("}")).map((function(e){return t.parseBond(e),t}))},t.moveTowards=D.prototype.moveTowards,t.deleteTowards=D.prototype.deleteTowards,t.seek=D.prototype.seek,t.blur=N.prototype.blur}));var B=o(R,(function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[l].cursor=this.cursor,this.ends[l].write=function(t,e){"$"!==e?N.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),L("\\$","$").createLeftOf(t.show())):t[c]?t[l]?N.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[l].latex()+"$"}})),V=o(M,(function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){var i;(t.show().deleteSelection(),"$"===e)?B(t).createLeftOf(t):("<"===e?i="&lt;":">"===e&&(i="&gt;"),L(e,i).createLeftOf(t))}}));MathQuill.TextField=APIFnFor(o(k,(function(t){t.init=function(t){t.addClass("mq-editable-field mq-text-mode"),this.initRootAndEvents(V(),t)},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}})));m["\\"]=o(R,(function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[l].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[l].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[l].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?L(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))},this.ends[l].keystroke=function(t,i,n){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(n.cursor),void i.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var i=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",(function(t){return u(t.target=i).trigger(t),!1})).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[l].latex()+" "},t.renderCommand=function(t){this.jQ=this.jQ.last(),this.remove(),this[c]?t.insLeftOf(this[c]):t.insAtRightEnd(this.parent);var e=this.ends[l].latex();e||(e=" ");var i=f[e]||Rt[e];i?(i=i(e),this._replacedFragment&&i.replaces(this._replacedFragment),i.createLeftOf(t)):((i=z()).replaces(e),i.createLeftOf(t),t.insRightOf(i),this._replacedFragment&&this._replacedFragment.remove())}}));f["∉"]=f.notin=bind(I,"\\notin ","&#8713;"),f["≅"]=f.cong=bind(I,"\\cong ","&#8773;"),f["≡"]=f.equiv=bind(I,"\\equiv ","&#8801;"),f["⊕"]=f.oplus=bind(I,"\\oplus ","&#8853;"),f["⊗"]=f.otimes=bind(I,"\\otimes ","&#8855;"),f["≠"]=f.ne=f.neq=bind(I,"\\ne ","&ne;"),f.ast=f.star=f.loast=f.lowast=bind(I,"\\ast ","&lowast;"),f.therefor=f.therefore=bind(I,"\\therefore ","&there4;"),f.cuz=f.because=bind(I,"\\because ","&#8757;"),f.prop=f.propto=bind(I,"\\propto ","&prop;"),f["≈"]=f.asymp=f.approx=bind(I,"\\approx ","&asymp;"),f.isin=f.in=bind(I,"\\in ","&isin;"),f.ni=f.contains=bind(I,"\\ni ","&ni;"),f.notni=f.niton=f.notcontains=f.doesnotcontain=g["\\not\\ni"]=bind(I,"\\not\\ni ","&#8716;"),f.sub=f.subset=bind(I,"\\subset ","&sub;"),f.sup=f.supset=f.superset=bind(I,"\\supset ","&sup;"),f.nsub=f.notsub=f.nsubset=f.notsubset=g["\\not\\subset"]=bind(I,"\\not\\subset ","&#8836;"),f.nsup=f.notsup=f.nsupset=f.notsupset=f.nsuperset=f.notsuperset=g["\\not\\supset"]=bind(I,"\\not\\supset ","&#8837;"),f.sube=f.subeq=f.subsete=f.subseteq=bind(I,"\\subseteq ","&sube;"),f.supe=f.supeq=f.supsete=f.supseteq=f.supersete=f.superseteq=bind(I,"\\supseteq ","&supe;"),f.nsube=f.nsubeq=f.notsube=f.notsubeq=f.nsubsete=f.nsubseteq=f.notsubsete=f.notsubseteq=g["\\not\\subseteq"]=bind(I,"\\not\\subseteq ","&#8840;"),f.nsupe=f.nsupeq=f.notsupe=f.notsupeq=f.nsupsete=f.nsupseteq=f.notsupsete=f.notsupseteq=f.nsupersete=f.nsuperseteq=f.notsupersete=f.notsuperseteq=g["\\not\\supseteq"]=bind(I,"\\not\\supseteq ","&#8841;"),f.N=f.naturals=f.Naturals=bind(L,"\\mathbb{N}","&#8469;"),f.P=f.primes=f.Primes=f.projective=f.Projective=f.probability=f.Probability=bind(L,"\\mathbb{P}","&#8473;"),f.Z=f.integers=f.Integers=bind(L,"\\mathbb{Z}","&#8484;"),f.Q=f.rationals=f.Rationals=bind(L,"\\mathbb{Q}","&#8474;"),f.R=f.reals=f.Reals=bind(L,"\\mathbb{R}","&#8477;"),f.C=f.complex=f.Complex=f.complexes=f.Complexes=f.complexplane=f.Complexplane=f.ComplexPlane=bind(L,"\\mathbb{C}","&#8450;"),f.H=f.Hamiltonian=f.quaternions=f.Quaternions=bind(L,"\\mathbb{H}","&#8461;"),f.quad=f.emsp=bind(L,"\\quad ","    "),f.qquad=bind(L,"\\qquad ","        ");var F=o(D,(function(t,e){t.init=function(t,i){e.init.call(this,t,'<span class="mq-longarrow">'+i+"</span>")}}));f.diamond=bind(L,"\\diamond ","&#9671;"),f.bigtriangleup=bind(L,"\\bigtriangleup ","&#9651;"),f.ominus=bind(L,"\\ominus ","&#8854;"),f.uplus=bind(L,"\\uplus ","&#8846;"),f.bigtriangledown=bind(L,"\\bigtriangledown ","&#9661;"),f.sqcap=bind(L,"\\sqcap ","&#8851;"),f.triangleleft=bind(L,"\\triangleleft ","&#8882;"),f.sqcup=bind(L,"\\sqcup ","&#8852;"),f.triangleright=bind(L,"\\triangleright ","&#8883;"),f.odot=bind(L,"\\odot ","&#8857;"),f.bigcirc=bind(L,"\\bigcirc ","&#9711;"),f.dagger=bind(L,"\\dagger ","&#0134;"),f.ddagger=bind(L,"\\ddagger ","&#135;"),f.wr=bind(L,"\\wr ","&#8768;"),f.amalg=bind(L,"\\amalg ","&#8720;"),f.models=bind(L,"\\models ","&#8872;"),f.prec=bind(L,"\\prec ","&#8826;"),f.succ=bind(L,"\\succ ","&#8827;"),f.preceq=bind(L,"\\preceq ","&#8828;"),f.succeq=bind(L,"\\succeq ","&#8829;"),f.simeq=bind(L,"\\simeq ","&#8771;"),f.mid=bind(L,"\\mid ","&#8739;"),f.ll=bind(L,"\\ll ","&#8810;"),f.gg=bind(L,"\\gg ","&#8811;"),f.parallel=bind(L,"\\parallel ","&#8741;"),f.nparallel=bind(L,"\\nparallel ","&#8742;"),f.bowtie=bind(L,"\\bowtie ","&#8904;"),f.sqsubset=bind(L,"\\sqsubset ","&#8847;"),f.sqsupset=bind(L,"\\sqsupset ","&#8848;"),f.smile=bind(L,"\\smile ","&#8995;"),f.sqsubseteq=bind(L,"\\sqsubseteq ","&#8849;"),f.sqsupseteq=bind(L,"\\sqsupseteq ","&#8850;"),f.doteq=bind(L,"\\doteq ","&#8784;"),f.frown=bind(L,"\\frown ","&#8994;"),f.vdash=bind(L,"\\vdash ","&#8870;"),f.dashv=bind(L,"\\dashv ","&#8867;"),f.longleftarrow=bind(F,"\\longleftarrow ",'&larr;<span class="mq-arrow-tail mq-tail-right">&larr;</span>'),f.longrightarrow=bind(F,"\\longrightarrow ",'<span class="mq-arrow-tail">&larr;</span>&rarr;'),f.Longleftarrow=bind(F,"\\Longleftarrow ",'&lArr;<span class="mq-arrow-tail mq-tail-right">&lArr;</span>'),f.Longrightarrow=bind(F,"\\Longrightarrow ",'<span class="mq-arrow-tail">&lArr;</span>&rArr;'),f.longleftrightarrow=bind(F,"\\longleftrightarrow ",'<span class="mq-arrow-mirror">&larr;&rarr;</span>'),f.Longleftrightarrow=bind(F,"\\Longleftrightarrow ",'<span class="mq-arrow-mirror">&lArr;&rArr;</span>'),f.updownarrow=bind(L,"\\updownarrow ","&#8597;"),f.Updownarrow=bind(L,"\\Updownarrow ","&#8661;"),f.mapsto=bind(L,"\\mapsto ","&#8614;"),f.nearrow=bind(L,"\\nearrow ","&#8599;"),f.hookleftarrow=bind(L,"\\hookleftarrow ","&#8617;"),f.hookrightarrow=bind(L,"\\hookrightarrow ","&#8618;"),f.searrow=bind(L,"\\searrow ","&#8600;"),f.leftharpoonup=bind(L,"\\leftharpoonup ","&#8636;"),f.rightharpoonup=bind(L,"\\rightharpoonup ","&#8640;"),f.swarrow=bind(L,"\\swarrow ","&#8601;"),f.leftharpoondown=bind(L,"\\leftharpoondown ","&#8637;"),f.rightharpoondown=bind(L,"\\rightharpoondown ","&#8641;"),f.rightleftharpoons=bind(L,"\\rightleftharpoons ","&#8651;"),f.leftrightharpoons=bind(L,"\\leftrightharpoons ","&#8652;"),f.nwarrow=bind(L,"\\nwarrow ","&#8598;"),f.ldots=bind(L,"\\ldots ","&#8230;"),f.cdots=bind(L,"\\cdots ","&#8943;"),f.vdots=bind(L,"\\vdots ","&#8942;"),f.ddots=bind(L,"\\ddots ","&#8945;"),f.surd=bind(L,"\\surd ","&#8730;"),f.triangle=bind(L,"\\triangle ","&#9651;"),f.ell=bind(L,"\\ell ","&#8467;"),f.top=bind(L,"\\top ","&#8868;"),f.flat=bind(L,"\\flat ","&#9837;"),f.natural=bind(L,"\\natural ","&#9838;"),f.sharp=bind(L,"\\sharp ","&#9839;"),f.wp=bind(L,"\\wp ","&#8472;"),f.bot=bind(L,"\\bot ","&#8869;"),f.clubsuit=bind(L,"\\clubsuit ","&#9827;"),f.diamondsuit=bind(L,"\\diamondsuit ","&#9826;"),f.heartsuit=bind(L,"\\heartsuit ","&#9825;"),f.spadesuit=bind(L,"\\spadesuit ","&#9824;"),f.circledot=bind(L,"\\circledot ","&#8857;"),f.middot=bind(L,"\\middot ","&middot;"),f.dottedsquare=bind(L,"\\dottedsquare ","&#11034;"),f.square=bind(L,"\\square ","&#11036;"),f.rectangle=bind(L,"\\rectangle ","&#9647;"),f.oint=bind(L,"\\oint ","&#8750;"),f.bigcap=bind(L,"\\bigcap ","&#8745;"),f.bigcup=bind(L,"\\bigcup ","&#8746;"),f.bigsqcup=bind(L,"\\bigsqcup ","&#8852;"),f.bigvee=bind(L,"\\bigvee ","&#8744;"),f.bigwedge=bind(L,"\\bigwedge ","&#8743;"),f.bigodot=bind(L,"\\bigodot ","&#8857;"),f.bigotimes=bind(L,"\\bigotimes ","&#8855;"),f.bigoplus=bind(L,"\\bigoplus ","&#8853;"),f.biguplus=bind(L,"\\biguplus ","&#8846;"),f.lfloor=bind(L,"\\lfloor ","&#8970;"),f.rfloor=bind(L,"\\rfloor ","&#8971;"),f.lceil=bind(L,"\\lceil ","&#8968;"),f.rceil=bind(L,"\\rceil ","&#8969;"),f.opencurlybrace=f.lbrace=bind(L,"\\lbrace ","{"),f.closecurlybrace=f.rbrace=bind(L,"\\rbrace ","}"),f.mug=bind(L,"\\mug ","&micro;g"),f.mus=bind(L,"\\mus ","&micro;s"),f.mum=bind(L,"\\mum ","&micro;m"),f.muL=bind(L,"\\muL ","&micro;L"),v.open((function(t){this.onNotify((function(t){"move"===t&&this[c]&&this[c].movingLeftOf&&this[c].movingLeftOf(this)}))}));var U=o(D,(function(t,e){t.moveTowards=function(t,i){t===c&&this[c]instanceof yt?i.insAtDirEnd(l,this[c].ends[l]):e.moveTowards.apply(this,arguments)}}));f["∫"]=f.int=f.integral=bind(U,"\\int ","<big>&int;</big>"),f.caret=bind(L,"\\text{^}","^"),f.underscore=bind(L,"\\_","_"),f.slash=bind(L,"/"),f.vert=bind(L,"|"),f.perp=f.perpendicular=bind(L,"\\perp ","&perp;"),f.nabla=f.del=bind(L,"\\nabla ","&nabla;"),f.hbar=bind(L,"\\hbar ","&#8463;"),f.AA=f.Angstrom=f.angstrom=bind(L,"\\text\\AA ","&#8491;"),f.ring=f.circ=f.circle=bind(L,"\\circ ","&#8728;"),f.bull=f.bullet=bind(L,"\\bullet ","&bull;"),f.setminus=f.smallsetminus=bind(L,"\\setminus ","&#8726;"),f.not=f["¬"]=f.neg=bind(L,"\\neg ","&not;"),f["…"]=f.dots=f.ellip=f.hellip=f.ellipsis=f.hellipsis=bind(L,"\\dots ","&hellip;"),f.converges=f.darr=f.dnarr=f.dnarrow=f.downarrow=bind(L,"\\downarrow ","&darr;"),f.dArr=f.dnArr=f.dnArrow=f.Downarrow=bind(L,"\\Downarrow ","&dArr;"),f.diverges=f.uarr=f.uparrow=bind(L,"\\uparrow ","&uarr;"),f.uArr=f.Uparrow=bind(L,"\\Uparrow ","&uArr;"),f.to=bind(I,"\\to ","&rarr;"),f.rarr=f.rightarrow=bind(L,"\\rightarrow ","&rarr;"),f.implies=bind(I,"\\Rightarrow ","&rArr;"),f.rArr=f.Rightarrow=bind(L,"\\Rightarrow ","&rArr;"),f.gets=bind(I,"\\gets ","&larr;"),f.larr=f.leftarrow=bind(L,"\\leftarrow ","&larr;"),f.impliedby=bind(I,"\\Leftarrow ","&lArr;"),f.lArr=f.Leftarrow=bind(L,"\\Leftarrow ","&lArr;"),f.harr=f.lrarr=f.leftrightarrow=bind(L,"\\leftrightarrow ","&harr;"),f.iff=bind(I,"\\Leftrightarrow ","&hArr;"),f.hArr=f.lrArr=f.Leftrightarrow=bind(L,"\\Leftrightarrow ","&hArr;"),f.Re=f.Real=f.real=bind(L,"\\Re ","&real;"),f.Im=f.imag=f.image=f.imagin=f.imaginary=f.Imaginary=bind(L,"\\Im ","&image;"),f.part=f.partial=bind(L,"\\partial ","&part;"),f.infty=f.infin=f.infinity=bind(L,"\\infty ","&infin;"),f.alef=f.alefsym=f.aleph=f.alephsym=bind(L,"\\aleph ","&alefsym;"),f.xist=f.xists=f.exist=f.exists=bind(L,"\\exists ","&exist;"),f.and=f.land=f.wedge=bind(L,"\\wedge ","&and;"),f.or=f.lor=f.vee=bind(L,"\\vee ","&or;"),f.o=f.O=f.empty=f.emptyset=f.oslash=f.Oslash=f.nothing=f.varnothing=bind(I,"\\varnothing ","&empty;"),f.cup=f.union=bind(I,"\\cup ","&cup;"),f.cap=f.intersect=f.intersection=bind(I,"\\cap ","&cap;"),f.deg=f.degree=bind(L,"\\degree ","&deg;"),f.ang=f.angle=bind(L,"\\angle ","&ang;"),f.measuredangle=bind(L,"\\measuredangle ","m&ang;");var H=o(L,(function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[l]instanceof W&&!1!==t[l].isItalic||t[l]instanceof yt&&t[l][l]instanceof W&&!1!==t[l][l].isItalic)?(f._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}})),W=o(D,(function(t,e){t.init=function(t,i){e.init.call(this,t,"<var>"+(i||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return!this[l]||this[l]instanceof W||this[l]instanceof I||(t="*"+t),!this[c]||this[c]instanceof I||"^"===this[c].ctrlSeq||(t+="*"),t}}));w.p.autoCommands={_maxLength:0},x.autoCommands=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),i={},n=0,a=0;a<e.length;a+=1){var s=e[a];if(s.length<2)throw'autocommand "'+s+'" not minimum length of 2';if(f[s]===Y)throw'"'+s+'" is a built-in operator name';i[s]=1,n=r(n,s.length)}return i._maxLength=n,i};var Q=o(W,(function(t,e){function nonOperatorSymbol(t){return t instanceof D&&!(t instanceof I)}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){var i=t.options.autoCommands,n=i._maxLength;if(n>0){for(var r=this.letter,a=t[l],s=1;a instanceof Q&&s<n;)r=a.letter+r,a=a[l],s+=1;for(;r.length;){if(i.hasOwnProperty(r)){if(a=t[l],r.length>1){for(s=2;s<r.length;s+=1,a=a[l]);d(a,t[l]).remove(),t[l]=a[l]}return f[r](r).createLeftOf(t)}r=r.slice(1)}}e.createLeftOf.apply(this,arguments)},t.italicize=function(t){return this.isItalic=t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==l&&this[c]instanceof Q||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e=t.autoOperatorNames;if(0!==e._maxLength){for(var i=this.letter,r=this[l];r instanceof Q;r=r[l])i=r.letter+i;for(var a=this[c];a instanceof Q;a=a[c])i+=a.letter;d(r[c]||this.parent.ends[l],a[l]||this.parent.ends[c]).each((function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last"),t.ctrlSeq=t.letter}));t:for(var s=0,o=r[c]||this.parent.ends[l];s<i.length;s+=1,o=o[c])for(var u=n(e._maxLength,i.length-s);u>0;u-=1){var h=i.slice(s,s+u);if(e.hasOwnProperty(h)){for(var p=0,f=o;p<u;p+=1,f=f[c]){f.italicize(!1);var m=f}var g=K.hasOwnProperty(h);o.ctrlSeq=(g?"\\":"\\operatorname{")+o.ctrlSeq,m.ctrlSeq+=g?" ":"}",$.hasOwnProperty(h)&&m[l][l][l].jQ.addClass("mq-last"),nonOperatorSymbol(o[l])&&o.jQ.addClass("mq-first"),nonOperatorSymbol(m[c])&&m.jQ.addClass("mq-last"),s+=u-1,o=m;continue t}if(G.hasOwnProperty(h)){for(p=0,f=o;p<u;p+=1,f=f[c]){f.italicize(!1);m=f}o.ctrlSeq="\\text{"+o.ctrlSeq,m.ctrlSeq+="}",$.hasOwnProperty(h)&&m[l][l][l].jQ.addClass("mq-last"),nonOperatorSymbol(o[l])&&o.jQ.addClass("mq-first"),nonOperatorSymbol(m[c])&&m.jQ.addClass("mq-last"),s+=u-1,o=m;continue t}}}}})),K={},G={},$={limsup:1,liminf:1,projlim:1,injlim:1};!function(){for(var t=w.p.autoOperatorNames={_maxLength:9},e="arg deg det dim exp gcd hom inf ker lg ln log max min sup limsup liminf injlim projlim Pr".split(" "),i=0;i<e.length;i+=1)K[e[i]]=t[e[i]]=1;var n="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");for(i=0;i<n.length;i+=1)K[n[i]]=1;var r="sin cos tan sec cosec csc cotan cot ctg".split(" ");for(i=0;i<r.length;i+=1)t[r[i]]=t["arc"+r[i]]=t[r[i]+"h"]=t["ar"+r[i]+"h"]=t["arc"+r[i]+"h"]=1}(),x.autoOperatorNames=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),i={},n=0,a=0;a<e.length;a+=1){var s=e[a];if(s.length<2)throw'"'+s+'" not minimum length of 2';i[s]=1,n=r(n,s.length)}return i._maxLength=n,i};var Y=o(D,(function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){for(var e=this.ctrlSeq,i=0;i<e.length;i+=1)Q(e.charAt(i)).createLeftOf(t)},t.parser=function(){for(var t=this.ctrlSeq,e=N(),i=0;i<t.length;i+=1)Q(t.charAt(i)).adopt(e,e.ends[c],0);return O.succeed(e.children())}}));for(var X in K)K.hasOwnProperty(X)&&(f[X]=Y);f.operatorname=o(R,(function(t){t.createLeftOf=noop,t.numBlocks=function(){return 1},t.parser=function(){return q.block.map((function(t){return t.children()}))}})),f.f=o(Q,(function(t,e){t.init=function(){D.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}})),f[" "]=f.space=bind(L,"\\ "," "),f["'"]=f.prime=bind(L,"'","&prime;"),f['"']=f.doublePrime=bind(L,'"',"&Prime;"),f.backslash=bind(L,"\\backslash ","\\"),m["\\"]||(m["\\"]=f.backslash),f.$=bind(L,"\\$","$");var Z=o(D,(function(t,e){t.init=function(t,i){e.init.call(this,t,'<span class="mq-nonSymbola">'+(i||t)+"</span>")}}));f["@"]=Z,f["&"]=bind(Z,"\\&","&amp;"),f["%"]=bind(Z,"\\%","%"),f.alpha=f.beta=f.gamma=f.delta=f.zeta=f.eta=f.theta=f.iota=f.kappa=f.mu=f.nu=f.xi=f.rho=f.sigma=f.tau=f.chi=f.psi=f.omega=o(W,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),f.phi=bind(W,"\\phi ","&#981;"),f.phiv=f.varphi=bind(W,"\\varphi ","&phi;"),f.epsilon=bind(W,"\\epsilon ","&#1013;"),f.epsiv=f.varepsilon=bind(W,"\\varepsilon ","&epsilon;"),f.piv=f.varpi=bind(W,"\\varpi ","&piv;"),f.sigmaf=f.sigmav=f.varsigma=bind(W,"\\varsigma ","&sigmaf;"),f.thetav=f.vartheta=f.thetasym=bind(W,"\\vartheta ","&thetasym;"),f.upsilon=f.upsi=bind(W,"\\upsilon ","&upsilon;"),f.gammad=f.Gammad=f.digamma=bind(W,"\\digamma ","&#989;"),f.kappav=f.varkappa=bind(W,"\\varkappa ","&#1008;"),f.rhov=f.varrho=bind(W,"\\varrho ","&#1009;"),f.pi=f["π"]=bind(Z,"\\pi ","&pi;"),f.lambda=bind(Z,"\\lambda ","&lambda;"),f.Upsilon=f.Upsi=f.upsih=f.Upsih=bind(D,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),f.Gamma=f.Delta=f.Theta=f.Lambda=f.Xi=f.Pi=f.Sigma=f.Phi=f.Psi=f.Omega=o(L,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),f.forall=f["∀"]=bind(L,"\\forall ","&#8704;");var J=o(R,(function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=q.parse(this.latex);e.children().adopt(t.parent,t[l],t[c]),t[l]=e.ends[c],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[c][c].siblingCreated&&e.ends[c][c].siblingCreated(t.options,l),e.ends[l][l].siblingCreated&&e.ends[l][l].siblingCreated(t.options,c),t.parent.bubble("reflow")},t.parser=function(){var t=q.parse(this.latex).children();return O.succeed(t)}}));f["¹"]=bind(J,"^1"),f["²"]=bind(J,"^2"),f["³"]=bind(J,"^3"),f["¼"]=bind(J,"\\frac14"),f["½"]=bind(J,"\\frac12"),f["¾"]=bind(J,"\\frac34");var tt=o(I,(function(t){t.init=L.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(e!==c)return this.jQ[0].className=!this[l]||this[l]instanceof I?"":"mq-binary-operator",this}}));f["+"]=bind(tt,"+","+"),f["–"]=f["-"]=bind(tt,"-","&minus;"),f["±"]=f.pm=f.plusmn=f.plusminus=bind(tt,"\\pm ","&plusmn;"),f.mp=f.mnplus=f.minusplus=bind(tt,"\\mp ","&#8723;"),m["*"]=f.sdot=f.cdot=f.cdotp=bind(I,"\\cdot ","&middot;");var et=o(I,(function(t,e){t.init=function(t,i){this.data=t,this.strict=i;var n=i?"Strict":"";e.init.call(this,t["ctrlSeq"+n],t["html"+n],t["text"+n])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,i){t!==l||this.strict?e.deleteTowards.apply(this,arguments):this.swap(!0)}})),it={ctrlSeq:"\\le ",html:"&le;",text:"≤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},nt={ctrlSeq:"\\ge ",html:"&ge;",text:"≥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"};f["<"]=f.lt=bind(et,it,!0),f[">"]=f.gt=bind(et,nt,!0),f["≤"]=f.le=f.leq=bind(et,it,!1),f["≥"]=f.ge=f.geq=bind(et,nt,!1);var rt=o(I,(function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){t[l]instanceof et&&t[l].strict?t[l].swap(!1):e.createLeftOf.apply(this,arguments)}}));f["="]=rt,f["×"]=f.times=bind(I,"\\times ","&times;","[x]"),f["÷"]=f.div=f.divide=f.divides=bind(I,"\\div ","&divide;","[/]"),m["~"]=f.sim=bind(I,"\\sim ","~","~"),f.complement=f["∁"]=bind(L,"\\complement ","&#8705;"),f.nexists=f["∄"]=bind(L,"\\nexists ","&#8708;"),f.sphericalangle=f["∢"]=bind(L,"\\sphericalangle ","&#8738;"),f.iint=f["∬"]=bind(L,"\\iint ","&#8748;"),f.iiint=f["∭"]=bind(L,"\\iiint ","&#8749;"),f.oiint=f["∯"]=bind(L,"\\oiint ","&#8751;"),f.oiiint=f["∰"]=bind(L,"\\oiiint ","&#8752;"),f.backsim=f["∽"]=bind(L,"\\backsim ","&#8765;"),f.backsimeq=f["⋍"]=bind(L,"\\backsimeq ","&#8909;"),f.eqsim=f["≂"]=bind(L,"\\eqsim ","&#8770;"),f.ncong=f["≇"]=bind(L,"\\ncong ","&#8775;"),f.approxeq=f["≊"]=bind(L,"\\approxeq ","&#8778;"),f.bumpeq=f["≏"]=bind(L,"\\bumpeq ","&#8783;"),f.Bumpeq=f["≎"]=bind(L,"\\Bumpeq ","&#8782;"),f.doteqdot=f["≑"]=bind(L,"\\doteqdot ","&#8785;"),f.fallingdotseq=f["≒"]=bind(L,"\\fallingdotseq ","&#8786;"),f.risingdotseq=f["≓"]=bind(L,"\\risingdotseq ","&#8787;"),f.eqcirc=f["≖"]=bind(L,"\\eqcirc ","&#8790;"),f.circeq=f["≗"]=bind(L,"\\circeq ","&#8791;"),f.triangleq=f["≜"]=bind(L,"\\triangleq ","&#8796;"),f.leqq=f["≦"]=bind(L,"\\leqq ","&#8806;"),f.geqq=f["≧"]=bind(L,"\\geqq ","&#8807;"),f.lneqq=f["≨"]=bind(L,"\\lneqq ","&#8808;"),f.gneqq=f["≩"]=bind(L,"\\gneqq ","&#8809;"),f.between=f["≬"]=bind(L,"\\between ","&#8812;"),f.nleq=f["≰"]=bind(L,"\\nleq ","&#8816;"),f.ngeq=f["≱"]=bind(L,"\\ngeq ","&#8817;"),f.lesssim=f["≲"]=bind(L,"\\lesssim ","&#8818;"),f.gtrsim=f["≳"]=bind(L,"\\gtrsim ","&#8819;"),f.lessgtr=f["≶"]=bind(L,"\\lessgtr ","&#8822;"),f.gtrless=f["≷"]=bind(L,"\\gtrless ","&#8823;"),f.preccurlyeq=f["≼"]=bind(L,"\\preccurlyeq ","&#8828;"),f.succcurlyeq=f["≽"]=bind(L,"\\succcurlyeq ","&#8829;"),f.precsim=f["≾"]=bind(L,"\\precsim ","&#8830;"),f.succsim=f["≿"]=bind(L,"\\succsim ","&#8831;"),f.nprec=f["⊀"]=bind(L,"\\nprec ","&#8832;"),f.nsucc=f["⊁"]=bind(L,"\\nsucc ","&#8833;"),f.subsetneq=f["⊊"]=bind(L,"\\subsetneq ","&#8842;"),f.supsetneq=f["⊋"]=bind(L,"\\supsetneq ","&#8843;"),f.vDash=f["⊨"]=bind(L,"\\vDash ","&#8872;"),f.Vdash=f["⊩"]=bind(L,"\\Vdash ","&#8873;"),f.Vvdash=f["⊪"]=bind(L,"\\Vvdash ","&#8874;"),f.VDash=f["⊫"]=bind(L,"\\VDash ","&#8875;"),f.nvdash=f["⊬"]=bind(L,"\\nvdash ","&#8876;"),f.nvDash=f["⊭"]=bind(L,"\\nvDash ","&#8877;"),f.nVdash=f["⊮"]=bind(L,"\\nVdash ","&#8878;"),f.nVDash=f["⊯"]=bind(L,"\\nVDash ","&#8879;"),f.vartriangleleft=f["⊲"]=bind(L,"\\vartriangleleft ","&#8882;"),f.vartriangleright=f["⊳"]=bind(L,"\\vartriangleright ","&#8883;"),f.trianglelefteq=f["⊴"]=bind(L,"\\trianglelefteq ","&#8884;"),f.trianglerighteq=f["⊵"]=bind(L,"\\trianglerighteq ","&#8885;"),f.multimap=f["⊸"]=bind(L,"\\multimap ","&#8888;"),f.Subset=f["⋐"]=bind(L,"\\Subset ","&#8912;"),f.Supset=f["⋑"]=bind(L,"\\Supset ","&#8913;"),f.Cap=f["⋒"]=bind(L,"\\Cap ","&#8914;"),f.Cup=f["⋓"]=bind(L,"\\Cup ","&#8915;"),f.pitchfork=f["⋔"]=bind(L,"\\pitchfork ","&#8916;"),f.lessdot=f["⋖"]=bind(L,"\\lessdot ","&#8918;"),f.gtrdot=f["⋗"]=bind(L,"\\gtrdot ","&#8919;"),f.lll=f["⋘"]=bind(L,"\\lll ","&#8920;"),f.ggg=f["⋙"]=bind(L,"\\ggg ","&#8921;"),f.lesseqgtr=f["⋚"]=bind(L,"\\lesseqgtr ","&#8922;"),f.gtreqless=f["⋛"]=bind(L,"\\gtreqless ","&#8923;"),f.curlyeqprec=f["⋞"]=bind(L,"\\curlyeqprec ","&#8926;"),f.curlyeqsucc=f["⋟"]=bind(L,"\\curlyeqsucc ","&#8927;"),f.nsim=f["≁"]=bind(L,"\\nsim ","&#8769;"),f.lnsim=f["⋦"]=bind(L,"\\lnsim ","&#8934;"),f.gnsim=f["⋧"]=bind(L,"\\gnsim ","&#8935;"),f.precnsim=f["⋨"]=bind(L,"\\precnsim ","&#8936;"),f.succnsim=f["⋩"]=bind(L,"\\succnsim ","&#8937;"),f.ntriangleleft=f["⋪"]=bind(L,"\\ntriangleleft ","&#8938;"),f.ntriangleright=f["⋫"]=bind(L,"\\ntriangleright ","&#8939;"),f.ntrianglelefteq=f["⋬"]=bind(L,"\\ntrianglelefteq ","&#8940;"),f.ntrianglerighteq=f["⋭"]=bind(L,"\\ntrianglerighteq ","&#8941;"),f.blacksquare=f["∎"]=bind(L,"\\blacksquare ","&#8718;"),f.colon=f["∶"]=bind(L,"\\colon ","&#8758;"),f.llcorner=f["∟"]=bind(L,"\\llcorner ","&#8735;"),f.dotplus=f["∔"]=bind(I,"\\dotplus ","&#8724;"),f.nmid=f["∤"]=bind(I,"\nmid ","&#8740;"),f.intercal=f["⊺"]=bind(I,"\\intercal ","&#8890;"),f.veebar=f["⊻"]=bind(I,"\\veebar ","&#8891;"),f.barwedge=f["⊼"]=bind(I,"\\barwedge ","&#8892;"),f.ltimes=f["⋉"]=bind(I,"\\ltimes ","&#8905;"),f.rtimes=f["⋊"]=bind(I,"\\rtimes ","&#8906;"),f.leftthreetimes=f["⋋"]=bind(I,"\\leftthreetimes ","&#8907;"),f.rightthreetimes=f["⋌"]=bind(I,"\\rightthreetimes ","&#8908;"),f.curlyvee=f["⋎"]=bind(I,"\\curlyvee ","&#8910;"),f.curlywedge=f["⋏"]=bind(I,"\\curlywedge ","&#8911;"),f.circledcirc=f["⊚"]=bind(I,"\\circledcirc ","&#8858;"),f.circledast=f["⊛"]=bind(I,"\\circledast ","&#8859;"),f.circleddash=f["⊝"]=bind(I,"\\circleddash ","&#8861;"),f.boxplus=f["⊞"]=bind(I,"\\boxplus ","&#8862;"),f.boxminus=f["⊟"]=bind(I,"\\boxminus ","&#8863;"),f.boxtimes=f["⊠"]=bind(I,"\\boxtimes ","&#8864;"),f.boxdot=f["⊡"]=bind(I,"\\boxdot ","&#8865;"),f["∂"]=f.partial,f["∃"]=f.exists,f["∅"]=f.varnothing,f["∆"]=f.triangle,f["∇"]=f.nabla,f["∈"]=f.in,f["∊"]=f.in,f["∋"]=f.ni,f["∌"]=f.notni,f["∍"]=f.ni,f["∐"]=f.amalg,f["−"]=f["-"],f["∓"]=f.mp,f["∖"]=f.setminus,f["∘"]=f.circ,f["∙"]=f.bullet,f["∝"]=f.propto,f["∞"]=f.infty,f["∠"]=f.angle,f["∡"]=f.measuredangle,f["∣"]=f.divides,f["∥"]=f.parallel,f["∦"]=f.nparallel,f["∧"]=f.wedge,f["∨"]=f.vee,f["∩"]=f.cap,f["∪"]=f.cup,f["∮"]=f.oint,f["∴"]=f.therefore,f["∵"]=f.because,f["∼"]=f.sim,f["≀"]=f.wr,f["≃"]=f.simeq,f["≍"]=f.asymp,f["≐"]=f.doteq,f["≪"]=f.ll,f["≫"]=f.gg,f["≺"]=f.prec,f["≻"]=f.succ,f["⊂"]=f.subset,f["⊃"]=f.supset,f["⊆"]=f.subseteq,f["⊇"]=f.supseteq,f["⊈"]=f.nsubseteq,f["⊉"]=f.nsupseteq,f["⊏"]=f.sqsubset,f["⊐"]=f.sqsupset,f["⊓"]=f.sqcap,f["⊔"]=f.sqcup,f["⊖"]=f.ominus,f["⊘"]=f.oslash,f["⊙"]=f.odot,f["⊢"]=f.vdash,f["⊣"]=f.dashv,f["⊤"]=f.top,f["⊥"]=f.bot,f["⊧"]=f.models,f["⋀"]=f.wedge,f["⋁"]=f.vee,f["⋂"]=f.cap,f["⋃"]=f.cup,f["⋄"]=f.diamond,f["⋅"]=f.cdot,f["⋆"]=f.star,f["⋈"]=f.bowtie,f["⋮"]=f.vdots,f["⋯"]=f.cdots,f["⋱"]=f.ddots;var at,st,ot=noop,lt=document.createElement("div").style;for(var ct in{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(ct in lt){st=ct;break}st?at=function(t,e,i){t.css(st,"scale("+e+","+i+")")}:"filter"in lt?(ot=function(t){t.className=t.className},at=function(t,e,i){e/=1+(i-1)/2,t.css("fontSize",i+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>');var n=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')");function calculateMarginRight(){t.css("marginRight",(n.width()-1)*(e-1)/e+"px")}calculateMarginRight();var r=setInterval(calculateMarginRight);u(window).load((function(){clearTimeout(r),calculateMarginRight()}))}):at=function(t,e,i){t.css("fontSize",i+"em")};var ut=o(R,(function(t,e){t.init=function(t,i,n){e.init.call(this,t,"<"+i+" "+n+">&0</"+i+">")}})),ht=o(R,(function(t,e){t.init=function(t,i,n){this.args=arguments,this.htmlTemplate="<"+i+" "+n+"><"+i+' class="mq-xarrow-over">&0</'+i+"><"+i+' class="mq-xarrow-under"></'+i+"></"+i+">",e.init.call(this,t),this.textTemplate=[t.replace("\\","")+"(",")"]},t.parser=function(){var t=this;return q.optBlock.then((function(e){return q.block.map((function(i){var n=pt.apply(null,t.args);return n.blocks=[e,i],e.adopt(n,0,0),i.adopt(n,e,0),n}))})).or(e.parser.call(this))}})),pt=o(ht,(function(t,e){t.init=function(t,e,i){this.htmlTemplate="<"+e+" "+i+"><"+e+' class="mq-xarrow-over">&1</'+e+"><"+e+' class="mq-xarrow-under">&0</'+e+"></"+e+">",R.prototype.init.call(this,t),this.textTemplate=[t.replace("\\","")+"[","](",")"]},t.latex=function(){return this.ctrlSeq+"["+this.ends[l].latex()+"]{"+this.ends[c].latex()+"}"},t.finalizeTree=function(){this.downInto=this.ends[l].upOutOf=this.ends[c],this.upInto=this.ends[c].downOutOf=this.ends[l]}})),OverLineStyleGenerator=function(t){var e='<span class="'+t+'-inner-right">g</span><span class="'+t+'-inner-left">h</span>';return o(R,(function(i,n){i.init=function(i,r,a){n.init.call(this,i,"<"+r+" "+a+"><"+r+' class="'+t+'-inner">'+e+'<span class="mq-empty-box">&0</span></'+r+"></"+r+">")}}))},dt=o(R,(function(t,e){t.init=function(t,i,n){e.init.call(this,t,"<"+i+" "+n+'><span class="mq-longdiv-curve-border">)</span><span class="mq-longdiv-inner"><span class="mq-empty">&0</span></'+i+"></span>")}})),ft=o(R,(function(t,e){t.init=function(t,i,n){e.init.call(this,t,'<span class="mq-matrix"><span class="mq-paren mq-scaled">[</span><span class="matrix-edit-content-row"><p>'+n+'</p><table class="mq-non-leaf mq-rows-3"><tbody><tr><td class="mq-empty"></td><td class="mq-empty"></td><td class="mq-empty"></td></tr></tbody></table></span><span class="mq-paren mq-scaled">]</span></span>')}})),mt=o(R,(function(t,e){t.init=function(t){e.init.call(this,t,'<span class="mq-non-leaf"><span class="mq-dot-recurring-inner"><span class="mq-dot-recurring">&#x2d9;</span><span class="mq-empty-box">&0</span></span></span>')}})),gt=o(R,(function(t,e){t.init=function(t,i,n){e.init.call(this,t,'<span class="mq-matrix"><span class="mq-paren mq-scaled">[</span><span class="matrix-edit-content-col"><p>'+n+'</p></span><span class="matrix-edit-content-col"><table class="mq-non-leaf mq-rows-3"><tbody><tr><td class="mq-empty"></td></tr><tr><td class="mq-empty"></td></tr><tr><td class="mq-empty"></td></tr></tbody></table></span><span class="mq-paren mq-scaled">]</span></span>')}})),BiggerSymbolStyle=function(t,e){return o(D,(function(i,n){i.init=function(i,r,a){n.init.call(this,i,"<"+r+" "+a+"><"+r+' class="'+t+'-inner">'+e+"</"+r+"></"+r+">")}}))},bt=o(W,(function(t,e){t.symbols={C:"&#8450;",H:"&#8461;",N:"&#8469;",P:"&#8473;",Q:"&#8474;",R:"&#8477;",Z:"&#8484;"},t.init=function(t){var i=t;this.symbols[t]&&(i='<span class="mq-original">'+t+"</span>"+this.symbols[t]),e.init.call(this,t,i)}}));f.mathrm=bind(ut,"\\mathrm","span",'class="mq-roman mq-font"'),f.mathit=bind(ut,"\\mathit","i",'class="mq-font"'),f.mathbf=bind(ut,"\\mathbf","b",'class="mq-font"'),f.mathsf=bind(ut,"\\mathsf","span",'class="mq-sans-serif mq-font"'),f.mathtt=bind(ut,"\\mathtt","span",'class="mq-monospace mq-font"'),f.mathbb=o(R,(function(t,e){t.init=function(){e.init.call(this,"\\mathbb",'<span class="mq-mathbb mq-font">&0</span>')},t.adopt=function(){return this.eachChild((function(t){if(!t.writeOverride){var e=t.write,i=t.deleteOutOf;t.write=t.writeOverride=function(i,n,r){var a;if(!bt.prototype.symbols[n])return e.apply(t,arguments);a=bt(n),r&&a.replaces(r),a.createLeftOf(i)},t.deleteOutOf=function(e,n){var r=[];return t.eachChild((function(e){var i=e.ctrlSeq;r.push(W(i).adopt(t,t.ends[c],0)),e.remove()})),r.length&&(n[c]=r[0]),t.jQize().appendTo(t.jQ),i.apply(t,arguments)}}})),e.adopt.apply(this,arguments)},t.finalizeTree=function(){this.eachChild((function(t){t.eachChild((function(e){var i=e.ctrlSeq,n=W;bt.prototype.symbols[i]&&(n=bt),n(i).adopt(t,t.ends[c],0),e.remove()})),t.jQize().appendTo(t.jQ)}))}})),f.underline=bind(ut,"\\underline","span",'class="mq-non-leaf mq-underline"'),f.overline=f.bar=bind(OverLineStyleGenerator("mq-overline"),"\\overline","span",'class="mq-non-leaf mq-overline"'),f.longdiv=bind(dt,"\\longdiv","span",'class="mq-non-leaf mq-longdiv"'),f.overleftrightarrow=bind(OverLineStyleGenerator("mq-overleftrightarrow"),"\\overleftrightarrow","span",'class="mq-non-leaf mq-overleftrightarrow"'),f.overrightarrow=bind(OverLineStyleGenerator("mq-overarrow"),"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),f.overleftarrow=bind(OverLineStyleGenerator("mq-overarrow"),"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),f.xleftarrow=bind(ht,"\\xleftarrow","span",'class="mq-non-leaf mq-xarrow mq-arrow-left"'),f.xrightarrow=bind(ht,"\\xrightarrow","span",'class="mq-non-leaf mq-xarrow mq-arrow-right"'),f.addmatrixrow=bind(ft,"\\addmatrixrow","span","+"),f.addmatrixcol=bind(gt,"\\addmatrixcol","span","+"),f.ngtr=f["≯"]=bind(BiggerSymbolStyle("mq-ngtr","&#8815;"),"\\ngtr ","span",'class="mq-non-leaf mq-ngtr"'),f.nless=f["≮"]=bind(BiggerSymbolStyle("mq-nless","&#8814;"),"\\nless ","span",'class="mq-non-leaf mq-nless"'),f.dot=bind(mt,"\\dot"),f.parallelogram=bind(BiggerSymbolStyle("mq-parallelogram","&#9649;"),"\\parallelogram ","span",'class="mq-non-leaf mq-parallelogram"');f.textcolor=o(R,(function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,i=O.optWhitespace,n=O.string,r=O.regex;return i.then(n("{")).then(r(/^[#\w\s.,()%-]*/)).skip(n("}")).then((function(i){return t.setColor(i),e.parser.call(t)}))}})),f.class=o(R,(function(t,e){t.parser=function(){var t=this,i=O.string,n=O.regex;return O.optWhitespace.then(i("{")).then(n(/^[-\w\s\\\xA0-\xFF]*/)).skip(i("}")).then((function(i){return t.htmlTemplate='<span class="mq-class '+i+'">&0</span>',e.parser.call(t)}))}}));var yt=o(R,(function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(t[l]||!t.options.supSubsRequireOperand)return e.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){for(var e=l;e;e=e===l&&c)if(this[e]instanceof yt){for(var i="sub";i;i="sub"===i&&"sup"){var n=this[i],r=this[e][i];if(n){if(r)if(n.isEmpty())s=h(r,0,r.ends[l]);else{n.jQ.children().insAtDirEnd(-e,r.jQ);var a=n.children().disown(),s=h(r,a.ends[c],r.ends[l]);e===l?a.adopt(r,r.ends[c],0):a.adopt(r,0,r.ends[l])}else this[e].addBlock(n.disown());this.placeCursor=function(t,i){return function(n){n.insAtDirEnd(-e,t||i)}}(r,n)}}this.remove(),t&&t[l]===this&&(e===c&&s?s[l]?t.insRightOf(s[l]):t.insAtLeftEnd(s.parent):t.insRightOf(this[e]));break}this.respace()},w.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[l].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var i=this.chToCmd(e);return i instanceof D?t.deleteSelection():t.clearSelection().insRightOf(this.parent),i.createLeftOf(t.show())}if(t[l]&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1)t.insRightOf(this.parent);else if(" "===e&&!t[c]&&this===this.parent.sub&&this.parent.sup){var n=this.parent;return n.polyatomic=this.latex().length>0,void n.polyatomicClass()}N.p.write.apply(this,arguments)},this.ends[l].keystroke=function(t,e,i){var n=this.parent;"Backspace"===t&&this===n.sub&&n.polyatomic&&!i.cursor[c]?(n.polyatomic=!1,n.polyatomicClass()):N.p.keystroke.apply(this,arguments)},this.polyatomicClass()},t.polyatomicClass=function(){this.jQ.toggleClass("mq-polyatomic",this.polyatomic)},t.moveTowards=function(t,i,n){i.options.autoSubscriptNumerals&&!this.sup?i.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.movingLeftOf=function(t){this[l]instanceof U&&t.insLeftOf(this[l])},t.deleteTowards=function(t,i){if(i.options.autoSubscriptNumerals&&this.sub){var n=this.sub.ends[-t];n instanceof D?n.remove():n&&n.deleteTowards(t,i.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&this.sub.deleteOutOf(-t,i.insAtLeftEnd(this.sub))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function latex(t,e){var i=e&&e.latex();return e?t+(1===i.length?i:"{"+(i||" ")+"}"):""}return latex("_",this.sub)+(this.polyatomic?"{}":"")+latex("^",this.sup)},t.respace=t.siblingCreated=t.siblingDeleted=function(t,e){e!==c&&(this.jQ.toggleClass("mq-limit","\\int "===this[l].ctrlSeq),this.sup&&this.sub||!this.polyatomic||(this.polyatomic=!1),this.polyatomicClass())},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=u('<span class="mq-sup"/>').append(t.jQ.children()).attr(i,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=u('<span class="mq-sub"></span>').append(t.jQ.children()).attr(i,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>')),this.sub&&this.sub.polyatomic&&(this.polyatomic=!0);for(var e=0;e<2;e+=1)!function(t,e,i,n){t[e].deleteOutOf=function(r,a){if(a.insDirOf(this[r]?-r:r,this.parent),!this.isEmpty()){var s=this.ends[r];this.children().disown().withDirAdopt(r,a.parent,a[r],a[-r]).jQ.insDirOf(-r,a.jQ),a[-r]=s}t.supsub=i,delete t[e],delete t[n+"Into"],t[i][n+"OutOf"]=insLeftOfMeUnlessAtEnd,delete t[i].deleteOutOf,"sub"===e&&u(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),t.polyatomic=!1,this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])}}));function insLeftOfMeUnlessAtEnd(t){var e=this.parent,i=t;do{if(i[c])return t.insLeftOf(e);i=i.parent.parent}while(i!==e);t.insRightOf(e)}f.subscript=f._=o(yt,(function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub"><span class="mq-empty-box">&0</span></span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[l],this.sub.upOutOf=insLeftOfMeUnlessAtEnd,e.finalizeTree.call(this)},t.parser=function(){var t=O.regex,i=O.optWhitespace,n=this;return i.then(t(/^([^{}]|{[^}{]*}){}/)).map((function(t){return n.blocks=[q.parse(t.replace(/{}$/,""))],n.blocks[0].adopt(n,n.ends[c],0),n.blocks[0].polyatomic=!0,n})).or(e.parser.call(this))}})),f.superscript=f.supscript=f["^"]=o(yt,(function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup"><span class="mq-empty-box">&0</span></span></span>',t.textTemplate=["**"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[c],this.sup.downOutOf=insLeftOfMeUnlessAtEnd,e.finalizeTree.call(this)}}));var _t=o(R,(function(t,e){t.parser=function(){for(var t=O.string,e=O.optWhitespace,i=O.succeed,n=q.block,r=this,a=r.blocks=[N(),N()],s=0;s<a.length;s+=1)a[s].adopt(r,r.ends[c],0);return e.then(t("_").or(t("^"))).then((function(t){var e=a["_"===t?0:1];return n.then((function(t){return t.children().adopt(e,e.ends[c],0),i(r)}))})).many().result(r)},t.finalizeTree=function(){this.downInto=this.ends[l],this.upInto=this.ends[c],this.ends[l].upOutOf=this.ends[c],this.ends[c].downOutOf=this.ends[l]}})),vt=o(_t,(function(t,e){t.init=function(t,e){var i='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>';D.prototype.init.call(this,t,i)},t.latex=function(){function simplify(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+simplify(this.ends[l].latex())+"^"+simplify(this.ends[c].latex())},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(Q("n").createLeftOf(t),rt().createLeftOf(t))}}));f["∑"]=f.sum=f.summation=bind(vt,"\\sum ","&sum;"),f["∏"]=f.prod=f.product=bind(vt,"\\prod ","&prod;"),f.coprod=f.coproduct=bind(vt,"\\coprod ","&#8720;"),f.lim=f.limit=o(_t,(function(t,e){t.init=function(){D.prototype.init.call(this,"\\lim ",'<span class="mq-lim mq-non-leaf"><span class="mq-un-italicized">lim</span><span class="mq-approaches"><span>&0</span></span></span>')},t.latex=function(){return this.ctrlSeq+"_"+function simplify(t){return 1===t.length?t:"{"+(t||" ")+"}"}(this.ends[l].latex())}}));var wt=f.frac=f.dfrac=f.cfrac=f.fraction=o(R,(function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator"><span class="mq-empty-box">&0</span></span><span class="mq-denominator"><span class="mq-empty-box">&1</span></span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(","/",")"],t.finalizeTree=function(){this.upInto=this.ends[c].upOutOf=this.ends[l],this.downInto=this.ends[l].downOutOf=this.ends[c]}})),xt=f.over=m["/"]=o(wt,(function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var i=t[l];i&&!(i instanceof I||i instanceof(f.text||noop)||i instanceof vt||"\\ "===i.ctrlSeq||/^[,;:]$/.test(i.ctrlSeq));)i=i[l];i instanceof vt&&i[c]instanceof yt&&(i=i[c])[c]instanceof yt&&i[c].ctrlSeq!=i.ctrlSeq&&(i=i[c]),i===t[l]||t.isTooDeep(1)||(this.replaces(d(i[c]||t.parent.ends[l],t[l])),t[l]=i)}e.createLeftOf.call(this,t)}}));f.underset=o(R,(function(t,e){t.ctrlSeq="\\underset",t.htmlTemplate='<span class="mq-underset mq-overunder mq-non-leaf"><span class="mq-over">&1</span><span class="mq-under">&0</span></span>',t.textTemplate=["[","|","]"],t.finalizeTree=function(){this.downInto=this.ends[l].upOutOf=this.ends[c],this.upInto=this.ends[c].downOutOf=this.ends[l]}})),f.overset=o(R,(function(t,e){t.ctrlSeq="\\overset",t.htmlTemplate='<span class="mq-overset mq-overunder mq-non-leaf"><span class="mq-over">&0</span><span class="mq-under">&1</span></span>',t.textTemplate=["[","|","]"],t.finalizeTree=function(){this.downInto=this.ends[c].upOutOf=this.ends[l],this.upInto=this.ends[l].downOutOf=this.ends[c]}}));var Et=o(R,(function(t,e){t.reflow=function(){var t=this.jQ.find(".mq-arc");at(t,this.jQ.innerWidth()/t.innerWidth(),1)}}));f.overarc=o(Et,(function(t,e){t.ctrlSeq="\\overarc",t.htmlTemplate='<span class="mq-overarc mq-overunder mq-non-leaf"><span class="mq-over"><span class="mq-arc mq-scaled">&frown;</span><span style="display:inline-block;width:0">&nbsp;</span></span><span class="mq-under">&0</span></span>'})),f.underarc=o(Et,(function(t,e){t.ctrlSeq="\\underarc",t.htmlTemplate='<span class="mq-underarc mq-overunder mq-non-leaf"><span class="mq-over">&0</span><span class="mq-under"><span class="mq-arc mq-scaled">&smile;</span><span style="display:inline-block;width:0">&nbsp;</span></span></span>'}));var kt=f.sqrt=f["√"]=o(R,(function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem"><span class="mq-empty-box">&0</span></span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return q.optBlock.then((function(t){return q.block.map((function(e){var i=Ct();return i.blocks=[t,e],t.adopt(i,0,0),e.adopt(i,t,0),i}))})).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[c].jQ.parent();at(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}})),Ct=(f.vec=o(R,(function(t,e){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-vector-prefix">&rarr;</span><span class="mq-vector-stem">&0</span></span>',t.textTemplate=["vec(",")"]})),f.nthroot=o(kt,(function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf"><span class="mq-empty-box">&0</span></sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf"><span class="mq-empty-box">&1</span></span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[l].latex()+"]{"+this.ends[c].latex()+"}"}})));f.lrncuberoot=o(kt,(function(t,e){t.ctrlSeq="\\lrncuberoot",t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf"><span class="mq-empty-box">3</span></sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf"><span class="mq-empty-box">&0</span></span></span>',t.textTemplate=["sqrt[3](",")"],t.latex=function(){return"\\sqrt[3]{"+this.ends[l].latex()+"}"}})),f.abs=o(R,(function(t,e){t.ctrlSeq="\\abs",t.htmlTemplate='<span class="mq-abs mq-non-leaf"><span class="mq-empty-box">&0</span></span>',t.textTemplate=["|","|"]})),f.lrnplaceholder=o(R,(function(t,e){t.ctrlSeq="\\lrnplaceholder",t.htmlTemplate='<span class="mq-lrnplaceholder mq-non-leaf"><span class="mq-empty-box">&0</span></span>',t.textTemplate=[""],t.latex=function(){return this.ends[l].latex()}})),f.lrnexponent=o(R,(function(t,e){t.ctrSeq="\\lrnexponent",t.htmlTemplate='<span class="mq-lrnexponent mq-non-leaf"><span class="mq-lrnplaceholder mq-non-leaf"><span class="mq-empty-box">&0</span></span><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup"><span class="mq-empty-box">&1</span></span></span></span>',t.textTemplate=["","**"],t.latex=function(){var t=this.ends[c].latex();return t.length>1?t="{"+t+"}":0===t.length&&(t="{ }"),this.ends[l].latex()+"^"+t}})),f.lrnsquaredexponent=o(R,(function(t,e){t.ctrSeq="\\lrnsquaredexponent",t.htmlTemplate='<span class="mq-lrnexponent mq-non-leaf"><span class="mq-lrnplaceholder mq-non-leaf"><span class="mq-empty-box">&0</span></span><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup"><span class="mq-empty-box">2</span></span></span></span>',t.textTemplate=["","**2"],t.latex=function(){return this.ends[l].latex()+"^2"}})),f.lrnsubscript=o(R,(function(t,e){t.ctrSeq="\\lrnsubscript",t.htmlTemplate='<span class="mq-lrnexponent mq-non-leaf"><span class="mq-lrnplaceholder mq-non-leaf"><span class="mq-empty-box">&0</span></span><span class="mq-supsub mq-non-leaf"><span class="mq-sub"><span class="mq-empty-box">&1</span></span><span style="display:inline-block;width:0">&nbsp;</span></span></span>',t.textTemplate=["","_"],t.latex=function(){return this.ends[l].latex()+"_"+this.ends[c].latex()}}));function DelimsMixin(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));at(this.delimjQs,n(1+.2*(t-1),1.2),1.2*t)}}var Tt=o(o(R,DelimsMixin),(function(t,e){t.init=function(t,i,n,r,a){e.init.call(this,"\\left"+r,void 0,[i,n]),this.side=t,this.sides={},this.sides[l]={ch:i,ctrlSeq:r},this.sides[c]={ch:n,ctrlSeq:a}},t.numBlocks=function(){return 1},t.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===c?" mq-ghost":"")+'">'+this.sides[l].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===l?" mq-ghost":"")+'">'+("."===this.sides[c].ch?" ":this.sides[c].ch)+"</span></span>",e.html.call(this)},t.latex=function(){return"\\left"+this.sides[l].ctrlSeq+this.ends[l].latex()+"\\right"+this.sides[c].ctrlSeq},t.oppBrack=function(t,e,i){return e instanceof Tt&&e.side&&e.side!==-i&&("|"===this.sides[this.side].ch||e.side===-this.side)&&(!t.restrictMismatchedBrackets||Ot[this.sides[this.side].ch]===e.sides[e.side].ch||{"(":"]","[":")"}[this.sides[l].ch]===e.sides[c].ch)&&e},t.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===l?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},t.createLeftOf=function(t){if(!this.replacedFragment)var i=t.options,n=this.oppBrack(i,t[l],l)||this.oppBrack(i,t[c],c)||this.oppBrack(i,t.parent.parent);if(n){var r=this.side=-n.side;this.closeOpposing(n),n===t.parent.parent&&t[r]&&(d(t[r],t.parent.ends[r],-r).disown().withDirAdopt(-r,n.parent,n,n[r]).jQ.insDirOf(r,n.jQ),n.bubble("reflow"))}else r=(n=this).side,n.replacedFragment?n.side=0:t[-r]&&(n.replaces(d(t[-r],t.parent.ends[-r],r)),t[-r]=0),e.createLeftOf.call(n,t);r===l?t.insAtLeftEnd(n.ends[l]):t.insRightOf(n)},t.placeCursor=noop,t.unwrap=function(){this.ends[l].children().disown().adopt(this.parent,this,this[c]).jQ.insertAfter(this.jQ),this.remove()},t.deleteSide=function(t,e,i){var n=this.parent,r=this[t],a=n.ends[t];if(t===this.side)return this.unwrap(),void(r?i.insDirOf(-t,r):i.insAtDirEnd(t,n));var s=i.options;if(this.side=-t,this.oppBrack(s,this.ends[l].ends[this.side],t)){this.closeOpposing(this.ends[l].ends[this.side]);var o=this.ends[l].ends[t];this.unwrap(),o.siblingCreated&&o.siblingCreated(i.options,t),r?i.insDirOf(-t,r):i.insAtDirEnd(t,n)}else if(this.oppBrack(s,this.parent.parent,t)?(this.parent.parent.closeOpposing(this),this.parent.parent.unwrap()):(this.sides[t]={ch:Ot[this.sides[this.side].ch],ctrlSeq:Ot[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===l?0:1).addClass("mq-ghost").html(this.sides[t].ch)),r){o=this.ends[l].ends[t];d(r,a,-t).disown().withDirAdopt(-t,this.ends[l],o,0).jQ.insAtDirEnd(t,this.ends[l].jQ.removeClass("mq-empty")),o.siblingCreated&&o.siblingCreated(i.options,t),i.insDirOf(-t,r)}else e?i.insDirOf(t,this):i.insAtDirEnd(t,this.ends[l])},t.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},t.finalizeTree=function(){this.ends[l].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===l?1:0).removeClass("mq-ghost"),this.side=0}},t.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}})),Ot={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|"};function bindCharBracketPair(t,e){e=e||t;var i=Ot[t],n=Ot[e];m[t]=bind(Tt,l,t,i,e,n),m[i]=bind(Tt,c,t,i,e,n)}bindCharBracketPair("("),bindCharBracketPair("["),bindCharBracketPair("{","\\{"),f.langle=bind(Tt,l,"&lang;","&rang;","\\langle ","\\rangle "),f.rangle=bind(Tt,c,"&lang;","&rang;","\\langle ","\\rangle "),m["|"]=bind(Tt,l,"|","|","|","|"),f.left=o(R,(function(t){t.parser=function(){var t=O.regex,e=O.string,i=(O.succeed,O.optWhitespace);return i.then(t(/^(?:[([|]|\\\{)/)).then((function(n){var r="\\"===n.charAt(0)?n.slice(1):n;return q.then((function(a){var s=t(/^(?:[\])|]|\\\})/);return a.ends[-1]===a.ends[1]&&a.ends[1]instanceof Rt.array&&(s=t(/^(?:[\])|\.]|\\\})/)),e("\\right").skip(i).then(s).map((function(t){var e="\\"===t.charAt(0)?t.slice(1):t,i=Tt(0,r,e,n,t);return i.blocks=[a],a.adopt(i,0,0),i}))}))}))}})),f.right=o(R,(function(t){t.parser=function(){return O.fail("unmatched \\right")}}));var St=f.binom=f.binomial=o(o(R,DelimsMixin),(function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]})),qt=(f.choose=o(St,(function(t){t.createLeftOf=xt.prototype.createLeftOf})),o(D,(function(t,e){t.init=function(t){t="\\"+t,e.init.call(this,t,'<span class="mq-unknown-cmd">'+t+"</span>")}}))),At=o(MathQuill.MathField,(function(t){t.init=function(t,e,i,n,r){RootBlockMixin(t),this.__options=n||w();var a=v(this,t,i);a.editable=r,t.ultimateRoot=e,t.select=k.prototype.select,a.createTextarea(),a.editablesTextareaEvents(),a.cursor.insAtRightEnd(t)}}));f.MathQuillMathField=o(R,(function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field mq-inner-editable"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,i=O.string,n=O.regex,r=O.succeed;return i("[").then(n(/^[a-z][a-z0-9]*/i)).skip(i("]")).map((function(e){t.name=e})).or(r()).then(e.parser.call(t))},t.finalizeTree=function(){var t=p.byId[this.jQ.closest(".mq-root-block").attr(i)],e=t&&t.controller&&t.controller.API.__options||{},n=this.ends[l].keystroke;function focusAdjacentEditable(t,e,i){var n,r;if(!i[t])for(;r=e[t]||e.parent&&e.parent[t];)if((n=(e=r).jQ.filter(".mq-editable-field").add(e.jQ.find(".mq-editable-field")).eq(0)).length)return n.find(".mq-textarea").children()[0].focus(),!0}At(this.ends[l],t,this.jQ,e,!0),this.ends[l].keystroke=function(t,e,i){var r=i.cursor,a=!1;switch(t){case"Left":a=focusAdjacentEditable(l,this.parent,r);break;case"Right":a=focusAdjacentEditable(c,this.parent,r);break;case"Up":a=focusAdjacentEditable("upOutOf",this.parent,r);break;case"Down":a=focusAdjacentEditable("downOutOf",this.parent,r)}a||"function"!=typeof n||n.apply(this,arguments)}},t.registerInnerField=function(t){t.push(t[this.name]=this.ends[l].controller.API)},t.latex=function(){return this.ends[l].latex()},t.text=function(){return this.ends[l].text()},t.seek=function(){return e.seek.apply(this,arguments)},t.focus=function(){return e.focus.apply(this,arguments)},t.blur=function(){return e.blur&&e.blur.apply(this,arguments)}})),f.MathQuillVarField=o(R,(function(t,e){t.ctrlSeq="\\MathQuillVarField",t.htmlTemplate='<span class="lrn-mq-var-container"><span class="mq-root-block">&0</span></span>',t.latex=function(){return"{{var:"+this.ends[l].latex()+"}}"},t.text=function(){return this.ends[l].text()},t.finalizeTree=function(){var t=p.byId[this.jQ.closest(".mq-root-block").attr(i)],e=t&&t.controller&&t.controller.API.__options||{};At(this.ends[l],t,this.jQ,e,!1),this.ends[l].keystroke=function(t,e,i){e.preventDefault()}}})),f.MathQuillResponseContainer=o(R,(function(t,e){t.ctrlSeq="\\MathQuillResponseContainer",t.htmlTemplate='<span class="lrn-mq-response-container"><marker class="lrn-qe-keyboard-i-response"></marker><content>Response</content></span>',t.latex=function(){return"\\MathQuillResponseContainer"},t.text=function(){return this.ends[l].text()}})),f.MathQuillResponseContainerIcon=o(R,(function(t,e){t.ctrlSeq="\\MathQuillResponseContainerIcon",t.htmlTemplate='<span class="lrn-mq-response-container-icon"><span class="lrn-qe-keyboard-i-response"></span></span>',t.latex=function(){return"\\MathQuillResponseContainerIcon"},t.text=function(){return this.ends[l].text()}}));var Rt={};f.begin=o(R,(function(t,e){t.parser=function(){var t=O.string,e=O.regex;return t("{").then(e(/^[a-z]+\*?/i)).skip(t("}")).then((function(t){return Rt[t]?Rt[t]().parser():O.fail("unknown environment type: "+t)}))}}));var Dt=f.matrix=Rt.matrix=o(R,(function(t,e){var r=o(N,(function(t,e){t.init=function(t,i){return this.column=t,this.row=i,e.init.call(this)},t.keystroke=function(t,i,n){switch(t){case"Shift-Spacebar":return i.preventDefault(),this.parent.insertColumn(this,n.cursor);case"Shift-Enter":return this.parent.insertRow(this,n.cursor)}return e.keystroke.apply(this,arguments)},t.deleteOutOf=function(t,i){var n=this,r=arguments;this.parent.backspace(this,t,i,(function(){return e.deleteOutOf.apply(n,r)}))}})),a="&",s="\\\\";t.parentheses={left:null,right:null},t.maximum={rows:10,columns:10},t.defaults={rows:2,columns:2},t.ctrlSeq="\\matrix",t.createBlocks=function(){var t,e,i=this,n=i.blocks=[],a=0;this.htmlTemplate.replace(/&\d+/g,(function(s,o){var l=i.htmlTemplate.substring(0,o).match(/<tr[^>]*>/gi).length-1;e=t===l?e+1:0,n[a]=r(e,l),n[a].adopt(i,i.ends[c],0),t=l,a++}))},t.reflow=function(){var t=this.jQ.children("table"),e=t.outerHeight()/+t.css("fontSize").slice(0,-2),i=this.jQ.children(".mq-paren");i.length&&at(i,n(1+.2*(e-1),1.2),1.05*e)},t.latex=function(){var t,e,i,n=this.getMatrixName(),r="\\begin{"+n+"}";for(i=0;i<this.blocks.length;i++)t=this.blocks[i].row,void 0!==e&&(r+=e!==t?s:a),e=t,r+=this.blocks[i].latex();return r+="\\end{"+n+"}"},t.createLeftOf=function(i){this.cursor=i;var n=Math.min(this.defaults.rows,this.maximum.rows),r=Math.min(this.defaults.columns,this.maximum.columns);this.defaultHtmlTemplate=this.defaultHtmlTemplate||this.generateHtmlTemplate(n,r),t.htmlTemplate=this.defaultHtmlTemplate,e.createLeftOf.call(this,i)},t.getMatrixName=function(){return this.ctrlSeq.replace("\\","")},t.generateHtmlTemplate=function(t,e){var i=this,n='<span class="mq-matrix mq-non-leaf">'+parenTemplate(this.parentheses.left);n+='<table class="mq-non-leaf">',t=Math.min(t,this.maximum.rows),e=Math.min(e,this.maximum.columns);for(var r=0,a=0;a<t;a++){n+="<tr>";for(var s=0;s<e;s++)n+="<td"+columnClass(s)+">&"+r+"</td>",r++;n+="</tr>"}return n+="</table>",n+=parenTemplate(this.parentheses.right)+"</span>";function parenTemplate(t){return t?'<span class="mq-paren mq-scaled">'+t+"</span>":""}function columnClass(t){var e=i.getColumnClass&&i.getColumnClass(t);return e?' class="'+e+'"':""}},t.htmlTemplate=t.generateHtmlTemplate(1,1),t.parser=function(){var t=O.regex,e=this,i=this.getMatrixName(),n=new RegExp("^(.*?)\\\\end{"+i+"}"),o=new RegExp("\\\\end{"+i+"}");return t(n).then((function(t){var i,n=[],l=t.replace(o,"").split(s),u=Math.min(l.length,e.maximum.rows),h=0;for(d=0;d<u;d++)i=l[d].split(a),h=Math.max(h,i.length);for(h=Math.min(h,e.maximum.columns),d=0;d<u;d++){i=l[d].split(a);for(t=0;t<h;t++){var p=r(t,d);q.parse(i[t]||" ").children().adopt(p,p.ends[c],0),n.push(p)}}e.htmlTemplate=e.generateHtmlTemplate(u,h),e.blocks=n;for(var d=0;d<n.length;d+=1)n[d].adopt(e,e.ends[c],0);return O.succeed(e)}))},t.finalizeTree=function(){var t=this.jQ.find("table");t.length&&(this.relink(),t.removeClass((function(t,e){var i=e.match(/mq-rows-\d+/g);return i&&i.join(" ")||""})),t.addClass("mq-rows-"+t.find("tr").length))},t.relink=function(){var t=this.jQ.find("td"),e=p.byId[t.first().attr(i)],n=p.byId[t.last().attr(i)],r=t.eq(0).closest("tr"),a=[];t.each((function(e){var n,s=p.byId[u(this).attr(i)],o=t.eq(e+1),h=u(this).closest("tr").next("tr"),d=u(this).closest("tr").index(),f=u(this).index();if(o.length){var m=p.byId[o.attr(i)];s[c]=m,m[l]=s}if((n=h.length?h.find("td").eq(f):r.find("td").eq(f+1)).length){var g=p.byId[n.attr(i)];s.downOutOf=g,g.upOutOf=s}s.column=f,s.row=d,a.push(s)})),this.ends[l]=e,this.ends[c]=n,e&&e[l]&&delete e[l],n&&n[c]&&delete n[c],this.blocks=a},t.deleteCell=function(t){var e,n=t.jQ.closest("tr"),r=t.jQ.index(),a=n.index(),s=n.find("td").not(t.jQ),o=this.jQ.find("tr").not(n).map((function(){return u(this).find("td")[r]})),l=1===this.jQ.find("td").length;function isEmpty(){return p.byId[u(this).attr(i)].isEmpty()}return s.filter(isEmpty).length===s.length&&o.length&&(s.remove(),t.jQ.remove(),n.remove(),this.finalizeTree()),o.filter(isEmpty).length===o.length&&s.length&&(o.remove(),t.jQ.remove(),this.finalizeTree()),l||(a=Math.min(a,this.jQ.find("tr").length-1),r=Math.min(r,this.jQ.find("tr").eq(a).find("td").length-1),e=p.byId[this.jQ.find("tr").eq(a).find("td").eq(r).attr(i)]),e},t.addRow=function(t){if(!(this.jQ.find("tr").length>=this.maximum.rows)){for(var e,n,a=t.find("td").length,s=u("<tr></tr>"),o=0;o<a;o++)(e=r()).parent=this,e.jQ=u('<td class="mq-empty">').attr(i,e.id),s.append(e.jQ),n=n||e;return s.insertAfter(t),n}},t.addColumn=function(t){if(!(t.closest("tr").find("td").length>=this.maximum.columns)){var e,n=t.index(),a=t.closest("tr").index(),s=this,o=[];return this.jQ.find("tr").each((function(){(e=r()).parent=s,e.jQ=u('<td class="mq-empty">').attr(i,e.id),e.jQ.insertAfter(u(this).find("td").eq(n)),o.push(e)})),o[a]}},t.insertColumn=function(t,e){newBlock=this.addColumn(t.jQ),newBlock&&(this.finalizeTree(),this.bubble("reflow"),e.insAtRightEnd(newBlock))},t.insertRow=function(t,e){newBlock=this.addRow(t.jQ.closest("tr")),newBlock&&(this.finalizeTree(),this.bubble("reflow"),e.insAtRightEnd(newBlock))},t.backspace=function(t,e,i,n){if(t.isEmpty()){var r=this.deleteCell(t);r?i.insAtRightEnd(r):(n(),this.finalizeTree()),this.bubble("edited")}}}));return Rt.array=o(Dt,(function(t,e){t.ctrlSeq="\\array",t.defaults={rows:2,columns:1},t.parser=function(){var t=O.regex,i=O.string,n=this;return i("{").then(t(/^[rcl]+/)).then((function(t){return n.alignments=t,i("}").then(e.parser.call(n))}))},t.getColumnClass=function(t){if(this.alignments&&this.alignments.length>t)return"mq-array-column-"+this.alignments.charAt(t)},t.latex=function(){var t=e.latex.call(this),i="\\begin{"+this.getMatrixName()+"}";return this.alignments?t.replace(i,i+"{"+this.alignments+"}"):t}})),f.pmatrix=Rt.pmatrix=o(Dt,(function(t,e){t.ctrlSeq="\\pmatrix",t.parentheses={left:"(",right:")"}})),f.bmatrix=Rt.bmatrix=o(Dt,(function(t,e){t.ctrlSeq="\\bmatrix",t.parentheses={left:"[",right:"]"}})),f.Bmatrix=Rt.Bmatrix=o(Dt,(function(t,e){t.ctrlSeq="\\Bmatrix",t.parentheses={left:"{",right:"}"}})),f.vmatrix=Rt.vmatrix=o(Dt,(function(t,e){t.ctrlSeq="\\vmatrix",t.parentheses={left:"|",right:"|"}})),f.Vmatrix=Rt.Vmatrix=o(Dt,(function(t,e){t.ctrlSeq="\\Vmatrix",t.parentheses={left:"&#8214;",right:"&#8214;"}})),MathQuill}.apply(e,n))||(t.exports=r)},66:function(t,e,i){"use strict";i.r(e);var n=i(272),r=i(269);e.default={Model:n.a,View:r.a}}}]);